<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <title>Spark MLContext Programming Guide - SystemML 1.1.0</title>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        
        <meta name="description" content="Spark MLContext Programming Guide">
        
        <meta name="viewport" content="width=device-width">
        <link rel="stylesheet" href="css/bootstrap.min.css">
        <link rel="stylesheet" href="css/main.css">
        <link rel="stylesheet" href="css/pygments-default.css">
        <link rel="shortcut icon" href="img/favicon.png">
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
        <![endif]-->

        <header class="navbar navbar-default navbar-fixed-top" id="topbar">
            <div class="container">
                <div class="navbar-header">
                    <div class="navbar-brand brand projectlogo">
                        <a href="http://systemml.apache.org/"><img class="logo" src="img/systemml-logo.png" alt="Apache SystemML" title="Apache SystemML"/></a>
                    </div>
                    <div class="navbar-brand brand projecttitle">
                        <a href="http://systemml.apache.org/">Apache SystemML<sup id="trademark">â„¢</sup></a><br/>
                        <span class="version">1.1.0</span>
                    </div>
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
                <nav class="navbar-collapse collapse">
                    <ul class="nav navbar-nav navbar-right">
                        <li><a href="index.html">Overview</a></li>
                        <li><a href="https://github.com/apache/systemml">GitHub</a></li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation<b class="caret"></b></a>
                            <ul class="dropdown-menu" role="menu">
                                <li><b>Running SystemML:</b></li>
                                <li><a href="https://github.com/apache/systemml">SystemML GitHub README</a></li>
                                <li><a href="spark-mlcontext-programming-guide.html">Spark MLContext</a></li>
                                <li><a href="spark-batch-mode.html">Spark Batch Mode</a>
                                <li><a href="hadoop-batch-mode.html">Hadoop Batch Mode</a>
                                <li><a href="standalone-guide.html">Standalone Guide</a></li>
                                <li><a href="jmlc.html">Java Machine Learning Connector (JMLC)</a>
                                <li class="divider"></li>
                                <li><b>Language Guides:</b></li>
                                <li><a href="dml-language-reference.html">DML Language Reference</a></li>
                                <li><a href="beginners-guide-to-dml-and-pydml.html">Beginner's Guide to DML and PyDML</a></li>
                                <li><a href="beginners-guide-python.html">Beginner's Guide for Python Users</a></li>
                                <li><a href="python-reference.html">Reference Guide for Python Users</a></li>
                                <li class="divider"></li>
                                <li><b>ML Algorithms:</b></li>
                                <li><a href="algorithms-reference.html">Algorithms Reference</a></li>
                                <li class="divider"></li>
                                <li><b>Tools:</b></li>
                                <li><a href="debugger-guide.html">Debugger Guide</a></li>
                                <li><a href="developer-tools-systemml.html">IDE Guide</a></li>
                                <li class="divider"></li>
                                <li><b>Other:</b></li>
                                <li><a href="contributing-to-systemml.html">Contributing to SystemML</a></li>
                                <li><a href="engine-dev-guide.html">Engine Developer Guide</a></li>
                                <li><a href="troubleshooting-guide.html">Troubleshooting Guide</a></li>
                                <li><a href="release-process.html">Release Process</a></li>
                            </ul>
                        </li>
                        
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">API Docs<b class="caret"></b></a>
                            <ul class="dropdown-menu" role="menu">
                                <li><a href="./api/java/index.html">Java</a></li>
                                <li><a href="./api/python/index.html">Python</a></li>
                            </ul>
                        </li>
                        
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Issues<b class="caret"></b></a>
                            <ul class="dropdown-menu" role="menu">
                                <li><b>JIRA:</b></li>
                                <li><a href="https://issues.apache.org/jira/browse/SYSTEMML">SystemML JIRA</a></li>
                                
                            </ul>
                        </li>
                    </ul>
                </nav>
            </div>
        </header>

        <div class="container" id="content">
          
            <h1 class="title">Spark MLContext Programming Guide</h1>
          

          <!--

-->

<ul id="markdown-toc">
  <li><a href="#overview" id="markdown-toc-overview">Overview</a></li>
  <li><a href="#spark-shell-example" id="markdown-toc-spark-shell-example">Spark Shell Example</a>    <ul>
      <li><a href="#start-spark-shell-with-systemml" id="markdown-toc-start-spark-shell-with-systemml">Start Spark Shell with SystemML</a></li>
      <li><a href="#create-mlcontext" id="markdown-toc-create-mlcontext">Create MLContext</a></li>
      <li><a href="#hello-world" id="markdown-toc-hello-world">Hello World</a></li>
      <li><a href="#lenet-on-mnist-example" id="markdown-toc-lenet-on-mnist-example">LeNet on MNIST Example</a></li>
      <li><a href="#dataframe-example" id="markdown-toc-dataframe-example">DataFrame Example</a></li>
      <li><a href="#rdd-example" id="markdown-toc-rdd-example">RDD Example</a></li>
      <li><a href="#matrix-output" id="markdown-toc-matrix-output">Matrix Output</a></li>
      <li><a href="#univariate-statistics-on-haberman-data" id="markdown-toc-univariate-statistics-on-haberman-data">Univariate Statistics on Haberman Data</a>        <ul>
          <li><a href="#input-variables-vs-input-parameters" id="markdown-toc-input-variables-vs-input-parameters">Input Variables vs Input Parameters</a></li>
        </ul>
      </li>
      <li><a href="#script-information" id="markdown-toc-script-information">Script Information</a></li>
      <li><a href="#clearing-scripts-and-mlcontext" id="markdown-toc-clearing-scripts-and-mlcontext">Clearing Scripts and MLContext</a></li>
      <li><a href="#statistics" id="markdown-toc-statistics">Statistics</a></li>
      <li><a href="#gpu" id="markdown-toc-gpu">GPU</a></li>
      <li><a href="#explain" id="markdown-toc-explain">Explain</a></li>
      <li><a href="#script-creation-and-scriptfactory" id="markdown-toc-script-creation-and-scriptfactory">Script Creation and ScriptFactory</a></li>
      <li><a href="#scriptexecutor" id="markdown-toc-scriptexecutor">ScriptExecutor</a></li>
      <li><a href="#matrixmetadata" id="markdown-toc-matrixmetadata">MatrixMetadata</a></li>
      <li><a href="#matrix-data-conversions-and-performance" id="markdown-toc-matrix-data-conversions-and-performance">Matrix Data Conversions and Performance</a></li>
      <li><a href="#project-information" id="markdown-toc-project-information">Project Information</a></li>
    </ul>
  </li>
  <li><a href="#jupyter-pyspark-notebook-example---poisson-nonnegative-matrix-factorization" id="markdown-toc-jupyter-pyspark-notebook-example---poisson-nonnegative-matrix-factorization">Jupyter (PySpark) Notebook Example - Poisson Nonnegative Matrix Factorization</a>    <ul>
      <li><a href="#set-up-the-notebook-and-download-the-data" id="markdown-toc-set-up-the-notebook-and-download-the-data">Set up the notebook and download the data</a></li>
      <li><a href="#use-pyspark-to-load-the-data-in-as-a-spark-dataframe" id="markdown-toc-use-pyspark-to-load-the-data-in-as-a-spark-dataframe">Use PySpark to load the data in as a Spark DataFrame</a></li>
      <li><a href="#create-a-systemml-mlcontext-object" id="markdown-toc-create-a-systemml-mlcontext-object">Create a SystemML MLContext object</a></li>
      <li><a href="#define-a-kernel-for-poisson-nonnegative-matrix-factorization-pnmf-in-dml" id="markdown-toc-define-a-kernel-for-poisson-nonnegative-matrix-factorization-pnmf-in-dml">Define a kernel for Poisson nonnegative matrix factorization (PNMF) in DML</a></li>
      <li><a href="#execute-the-algorithm" id="markdown-toc-execute-the-algorithm">Execute the algorithm</a></li>
      <li><a href="#retrieve-the-losses-during-training-and-plot-them" id="markdown-toc-retrieve-the-losses-during-training-and-plot-them">Retrieve the losses during training and plot them</a></li>
    </ul>
  </li>
  <li><a href="#recommended-spark-configuration-settings" id="markdown-toc-recommended-spark-configuration-settings">Recommended Spark Configuration Settings</a></li>
</ul>

<p><br /></p>

<h1 id="overview">Overview</h1>

<p>The Spark <code>MLContext</code> API offers a programmatic interface for interacting with SystemML from Spark using languages
such as Scala, Java, and Python. As a result, it offers a convenient way to interact with SystemML from the Spark
Shell and from Notebooks such as Jupyter and Zeppelin.</p>

<h1 id="spark-shell-example">Spark Shell Example</h1>

<h2 id="start-spark-shell-with-systemml">Start Spark Shell with SystemML</h2>

<p>To use SystemML with Spark Shell, the SystemML jar can be referenced using Spark Shell&#8217;s <code>--jars</code> option.</p>

<div class="codetabs">

<div data-lang="Spark Shell">

    <div class="highlight"><pre><code class="language-bash" data-lang="bash">spark-shell <span class="nt">--executor-memory</span> 4G <span class="nt">--driver-memory</span> 4G <span class="nt">--jars</span> SystemML.jar</code></pre></div>

  </div>

<div data-lang="PySpark Shell">

    <div class="highlight"><pre><code class="language-bash" data-lang="bash">pyspark <span class="nt">--executor-memory</span> 4G <span class="nt">--driver-memory</span> 4G <span class="nt">--jars</span> SystemML.jar <span class="nt">--driver-class-path</span> SystemML.jar</code></pre></div>

  </div>

</div>

<h2 id="create-mlcontext">Create MLContext</h2>

<p>All primary classes that a user interacts with are located in the <code>org.apache.sysml.api.mlcontext</code> package.
For convenience, we can additionally add a static import of <code>ScriptFactory</code> to shorten the syntax for creating <code>Script</code> objects.
An <code>MLContext</code> object can be created by passing its constructor a reference to the <code>SparkSession</code> (<code>spark</code>) or <code>SparkContext</code> (<code>sc</code>).
If successful, you should see a &#8220;<code>Welcome to Apache SystemML!</code>&#8221; message.</p>

<div class="codetabs">

<div data-lang="Scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">import</span> <span class="nn">org.apache.sysml.api.mlcontext._</span>
<span class="k">import</span> <span class="nn">org.apache.sysml.api.mlcontext.ScriptFactory._</span>
<span class="k">val</span> <span class="n">ml</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MLContext</span><span class="o">(</span><span class="n">spark</span><span class="o">)</span></code></pre></div>

  </div>

<div data-lang="Spark Shell">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">import</span> <span class="nn">org.apache.sysml.api.mlcontext._</span>
<span class="k">import</span> <span class="nn">org.apache.sysml.api.mlcontext._</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">import</span> <span class="nn">org.apache.sysml.api.mlcontext.ScriptFactory._</span>
<span class="k">import</span> <span class="nn">org.apache.sysml.api.mlcontext.ScriptFactory._</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">ml</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MLContext</span><span class="o">(</span><span class="n">spark</span><span class="o">)</span>

<span class="nc">Welcome</span> <span class="n">to</span> <span class="nc">Apache</span> <span class="nc">SystemML</span><span class="o">!</span>

<span class="n">ml</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.MLContext</span> <span class="o">=</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">sysml</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">mlcontext</span><span class="o">.</span><span class="nc">MLContext</span><span class="k">@</span><span class="mf">12139d</span><span class="n">b0</span></code></pre></div>

  </div>


<div data-lang="Python">

    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">systemml</span> <span class="kn">import</span> <span class="n">MLContext</span><span class="p">,</span> <span class="n">dml</span><span class="p">,</span> <span class="n">dmlFromResource</span><span class="p">,</span> <span class="n">dmlFromFile</span><span class="p">,</span> <span class="n">dmlFromUrl</span>
<span class="n">ml</span> <span class="o">=</span> <span class="n">MLContext</span><span class="p">(</span><span class="n">spark</span><span class="p">)</span></code></pre></div>

  </div>

<div data-lang="PySpark Shell">

    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">systemml</span> <span class="kn">import</span> <span class="n">MLContext</span><span class="p">,</span> <span class="n">dml</span><span class="p">,</span> <span class="n">dmlFromResource</span><span class="p">,</span> <span class="n">dmlFromFile</span><span class="p">,</span> <span class="n">dmlFromUrl</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ml</span> <span class="o">=</span> <span class="n">MLContext</span><span class="p">(</span><span class="n">spark</span><span class="p">)</span>

<span class="n">Welcome</span> <span class="n">to</span> <span class="n">Apache</span> <span class="n">SystemML</span><span class="err">!</span>
<span class="n">Version</span> <span class="mf">1.0</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">SNAPSHOT</span></code></pre></div>

  </div>

</div>

<h2 id="hello-world">Hello World</h2>

<p>The ScriptFactory class allows DML and PYDML scripts to be created from Strings, Files, URLs, and InputStreams.
Here, we&#8217;ll use the <code>dml</code> method to create a DML &#8220;hello world&#8221; script based on a String. Notice that the script
reports that it has no inputs or outputs.</p>

<p>We execute the script using MLContext&#8217;s <code>execute</code> method, which displays &#8220;<code>hello world</code>&#8221; to the console.
The <code>execute</code> method returns an MLResults object, which contains no results since the script has
no outputs.</p>

<div class="codetabs">

<div data-lang="Scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">helloScript</span> <span class="k">=</span> <span class="n">dml</span><span class="o">(</span><span class="s">"print('hello world')"</span><span class="o">)</span>
<span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">helloScript</span><span class="o">)</span></code></pre></div>

  </div>

<div data-lang="Spark Shell">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">helloScript</span> <span class="k">=</span> <span class="n">dml</span><span class="o">(</span><span class="s">"print('hello world')"</span><span class="o">)</span>
<span class="n">helloScript</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.Script</span> <span class="o">=</span>
<span class="nc">Inputs</span><span class="k">:</span>
<span class="kt">None</span>

<span class="nc">Outputs</span><span class="k">:</span>
<span class="kt">None</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">helloScript</span><span class="o">)</span>
<span class="n">hello</span> <span class="n">world</span>
<span class="n">res0</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.MLResults</span> <span class="o">=</span>
<span class="nc">None</span></code></pre></div>

  </div>

<div data-lang="Python">

    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">helloScript</span> <span class="o">=</span> <span class="n">dml</span><span class="p">(</span><span class="s">"print('hello world')"</span><span class="p">)</span>
<span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">helloScript</span><span class="p">)</span></code></pre></div>

  </div>

<div data-lang="PySpark Shell">

    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">helloScript</span> <span class="o">=</span> <span class="n">dml</span><span class="p">(</span><span class="s">"print('hello world')"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">helloScript</span><span class="p">)</span>
<span class="n">hello</span> <span class="n">world</span>
<span class="n">SystemML</span> <span class="n">Statistics</span><span class="p">:</span>
<span class="n">Total</span> <span class="n">execution</span> <span class="n">time</span><span class="p">:</span>           <span class="mf">0.001</span> <span class="n">sec</span><span class="o">.</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">executed</span> <span class="n">Spark</span> <span class="n">inst</span><span class="p">:</span>  <span class="mf">0.</span>

<span class="n">MLResults</span></code></pre></div>

  </div>


</div>

<h2 id="lenet-on-mnist-example">LeNet on MNIST Example</h2>

<p>SystemML features the DML-based <a href="https://github.com/apache/systemml/tree/master/scripts/nn"><code>nn</code> library for deep learning</a>.</p>

<p>At project build time, SystemML automatically generates wrapper classes for DML scripts
to enable convenient access to scripts and execution of functions.
In the example below, we obtain a reference (<code>clf</code>) to the LeNet on MNIST example.
We generate dummy data, train a convolutional net using the LeNet architecture,
compute the class probability predictions, and then evaluate the convolutional net.</p>

<p>Note that these automatic script wrappers are currently not available in Python but will be made available in the near future.</p>

<div class="codetabs">

<div data-lang="Scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">clf</span> <span class="k">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="nc">Mnist_lenet</span>
<span class="k">val</span> <span class="n">dummy</span> <span class="k">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">generate_dummy_data</span>
<span class="k">val</span> <span class="n">dummyVal</span> <span class="k">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">generate_dummy_data</span>
<span class="k">val</span> <span class="n">params</span> <span class="k">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">train</span><span class="o">(</span><span class="n">dummy</span><span class="o">.</span><span class="n">X</span><span class="o">,</span> <span class="n">dummy</span><span class="o">.</span><span class="n">Y</span><span class="o">,</span> <span class="n">dummyVal</span><span class="o">.</span><span class="n">X</span><span class="o">,</span> <span class="n">dummyVal</span><span class="o">.</span><span class="n">Y</span><span class="o">,</span> <span class="n">dummy</span><span class="o">.</span><span class="n">C</span><span class="o">,</span> <span class="n">dummy</span><span class="o">.</span><span class="nc">Hin</span><span class="o">,</span> <span class="n">dummy</span><span class="o">.</span><span class="nc">Win</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span>
<span class="k">val</span> <span class="n">probs</span> <span class="k">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="o">(</span><span class="n">dummy</span><span class="o">.</span><span class="n">X</span><span class="o">,</span> <span class="n">dummy</span><span class="o">.</span><span class="n">C</span><span class="o">,</span> <span class="n">dummy</span><span class="o">.</span><span class="nc">Hin</span><span class="o">,</span> <span class="n">dummy</span><span class="o">.</span><span class="nc">Win</span><span class="o">,</span> <span class="n">params</span><span class="o">.</span><span class="n">W1</span><span class="o">,</span> <span class="n">params</span><span class="o">.</span><span class="n">b1</span><span class="o">,</span> <span class="n">params</span><span class="o">.</span><span class="n">W2</span><span class="o">,</span> <span class="n">params</span><span class="o">.</span><span class="n">b2</span><span class="o">,</span> <span class="n">params</span><span class="o">.</span><span class="n">W3</span><span class="o">,</span> <span class="n">params</span><span class="o">.</span><span class="n">b3</span><span class="o">,</span> <span class="n">params</span><span class="o">.</span><span class="n">W4</span><span class="o">,</span> <span class="n">params</span><span class="o">.</span><span class="n">b4</span><span class="o">)</span>
<span class="k">val</span> <span class="n">perf</span> <span class="k">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">eval</span><span class="o">(</span><span class="n">probs</span><span class="o">,</span> <span class="n">dummy</span><span class="o">.</span><span class="n">Y</span><span class="o">)</span></code></pre></div>

  </div>

<div data-lang="Spark Shell">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">clf</span> <span class="k">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="nc">Mnist_lenet</span>
<span class="n">clf</span><span class="k">:</span> <span class="kt">org.apache.sysml.scripts.nn.examples.Mnist_lenet</span> <span class="o">=</span>
<span class="nc">Inputs</span><span class="k">:</span>
<span class="kt">None</span>

<span class="nc">Outputs</span><span class="k">:</span>
<span class="kt">None</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">dummy</span> <span class="k">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">generate_dummy_data</span>
<span class="nc">SystemML</span> <span class="nc">Statistics</span><span class="k">:</span>
<span class="kt">Total</span> <span class="kt">execution</span> <span class="kt">time:</span>		<span class="err">0</span><span class="kt">.</span><span class="err">144</span> <span class="kt">sec.</span>
<span class="kt">Number</span> <span class="kt">of</span> <span class="kt">executed</span> <span class="kt">Spark</span> <span class="kt">inst:</span>	<span class="err">0</span><span class="kt">.</span>

<span class="kt">dummy:</span> <span class="kt">org.apache.sysml.scripts.nn.examples.mnist_lenet.Generate_dummy_data_output</span> <span class="o">=</span>
<span class="n">X</span> <span class="o">(</span><span class="nc">Matrix</span><span class="o">)</span><span class="k">:</span> <span class="kt">MatrixObject:</span> <span class="kt">scratch_space</span><span class="c1">//_p64701_192.168.1.103//_t0/temp0_0, [1024 x 784, nnz=802816, blocks (1000 x 1000)], binaryblock, dirty
</span><span class="n">Y</span> <span class="o">(</span><span class="nc">Matrix</span><span class="o">)</span><span class="k">:</span> <span class="kt">MatrixObject:</span> <span class="kt">scratch_space</span><span class="c1">//_p64701_192.168.1.103//_t0/temp4_4, [1024 x 10, nnz=1024, blocks (1000 x 1000)], binaryblock, dirty
</span><span class="n">C</span> <span class="o">(</span><span class="n">long</span><span class="o">)</span><span class="k">:</span> <span class="err">1</span>
<span class="kt">Hin</span> <span class="o">(</span><span class="kt">long</span><span class="o">)</span><span class="kt">:</span> <span class="err">28</span>
<span class="kt">Win</span> <span class="o">(</span><span class="kt">long</span><span class="o">)</span><span class="kt">:</span> <span class="err">28</span>

<span class="kt">scala&gt;</span> <span class="kt">val</span> <span class="kt">dummyVal</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">generate_dummy_data</span>
<span class="nc">SystemML</span> <span class="nc">Statistics</span><span class="k">:</span>
<span class="kt">Total</span> <span class="kt">execution</span> <span class="kt">time:</span>		<span class="err">0</span><span class="kt">.</span><span class="err">147</span> <span class="kt">sec.</span>
<span class="kt">Number</span> <span class="kt">of</span> <span class="kt">executed</span> <span class="kt">Spark</span> <span class="kt">inst:</span>	<span class="err">0</span><span class="kt">.</span>

<span class="kt">dummyVal:</span> <span class="kt">org.apache.sysml.scripts.nn.examples.mnist_lenet.Generate_dummy_data_output</span> <span class="o">=</span>
<span class="n">X</span> <span class="o">(</span><span class="nc">Matrix</span><span class="o">)</span><span class="k">:</span> <span class="kt">MatrixObject:</span> <span class="kt">scratch_space</span><span class="c1">//_p64701_192.168.1.103//_t0/temp5_5, [1024 x 784, nnz=802816, blocks (1000 x 1000)], binaryblock, dirty
</span><span class="n">Y</span> <span class="o">(</span><span class="nc">Matrix</span><span class="o">)</span><span class="k">:</span> <span class="kt">MatrixObject:</span> <span class="kt">scratch_space</span><span class="c1">//_p64701_192.168.1.103//_t0/temp9_9, [1024 x 10, nnz=1024, blocks (1000 x 1000)], binaryblock, dirty
</span><span class="n">C</span> <span class="o">(</span><span class="n">long</span><span class="o">)</span><span class="k">:</span> <span class="err">1</span>
<span class="kt">Hin</span> <span class="o">(</span><span class="kt">long</span><span class="o">)</span><span class="kt">:</span> <span class="err">28</span>
<span class="kt">Win</span> <span class="o">(</span><span class="kt">long</span><span class="o">)</span><span class="kt">:</span> <span class="err">28</span>

<span class="kt">scala&gt;</span> <span class="kt">val</span> <span class="kt">params</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">train</span><span class="o">(</span><span class="n">dummy</span><span class="o">.</span><span class="n">X</span><span class="o">,</span> <span class="n">dummy</span><span class="o">.</span><span class="n">Y</span><span class="o">,</span> <span class="n">dummyVal</span><span class="o">.</span><span class="n">X</span><span class="o">,</span> <span class="n">dummyVal</span><span class="o">.</span><span class="n">Y</span><span class="o">,</span> <span class="n">dummy</span><span class="o">.</span><span class="n">C</span><span class="o">,</span> <span class="n">dummy</span><span class="o">.</span><span class="nc">Hin</span><span class="o">,</span> <span class="n">dummy</span><span class="o">.</span><span class="nc">Win</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span>
<span class="mi">17</span><span class="o">/</span><span class="mi">06</span><span class="o">/</span><span class="mi">05</span> <span class="mi">15</span><span class="k">:</span><span class="err">52</span><span class="kt">:</span><span class="err">09</span> <span class="kt">WARN</span> <span class="kt">SparkExecutionContext:</span> <span class="kt">Configuration</span> <span class="kt">parameter</span> <span class="kt">spark.driver.maxResultSize</span> <span class="kt">set</span> <span class="kt">to</span> <span class="err">1</span> <span class="kt">GB.</span> <span class="kt">You</span> <span class="kt">can</span> <span class="kt">set</span> <span class="kt">it</span> <span class="kt">through</span> <span class="kt">Spark</span> <span class="kt">default</span> <span class="kt">configuration</span> <span class="kt">setting</span> <span class="kt">either</span> <span class="kt">to</span> <span class="err">0</span> <span class="o">(</span><span class="kt">unlimited</span><span class="o">)</span> <span class="kt">or</span> <span class="kt">to</span> <span class="kt">available</span> <span class="kt">memory</span> <span class="kt">budget</span> <span class="kt">of</span> <span class="kt">size</span> <span class="err">2</span> <span class="kt">GB.</span>
<span class="kt">Starting</span> <span class="kt">optimization</span>
<span class="mi">17</span><span class="o">/</span><span class="mi">06</span><span class="o">/</span><span class="mi">05</span> <span class="mi">15</span><span class="k">:</span><span class="err">52</span><span class="kt">:</span><span class="err">10</span> <span class="kt">WARN</span> <span class="kt">TaskSetManager:</span> <span class="kt">Stage</span> <span class="err">0</span> <span class="kt">contains</span> <span class="kt">a</span> <span class="kt">task</span> <span class="kt">of</span> <span class="kt">very</span> <span class="kt">large</span> <span class="kt">size</span> <span class="o">(</span><span class="err">508</span> <span class="kt">KB</span><span class="o">)</span><span class="kt">.</span> <span class="kt">The</span> <span class="kt">maximum</span> <span class="kt">recommended</span> <span class="kt">task</span> <span class="kt">size</span> <span class="kt">is</span> <span class="err">100</span> <span class="kt">KB.</span>
<span class="err">17</span><span class="kt">/</span><span class="err">06</span><span class="kt">/</span><span class="err">05</span> <span class="err">15</span><span class="kt">:</span><span class="err">52</span><span class="kt">:</span><span class="err">11</span> <span class="kt">WARN</span> <span class="kt">TaskSetManager:</span> <span class="kt">Stage</span> <span class="err">1</span> <span class="kt">contains</span> <span class="kt">a</span> <span class="kt">task</span> <span class="kt">of</span> <span class="kt">very</span> <span class="kt">large</span> <span class="kt">size</span> <span class="o">(</span><span class="err">508</span> <span class="kt">KB</span><span class="o">)</span><span class="kt">.</span> <span class="kt">The</span> <span class="kt">maximum</span> <span class="kt">recommended</span> <span class="kt">task</span> <span class="kt">size</span> <span class="kt">is</span> <span class="err">100</span> <span class="kt">KB.</span>
<span class="err">17</span><span class="kt">/</span><span class="err">06</span><span class="kt">/</span><span class="err">05</span> <span class="err">15</span><span class="kt">:</span><span class="err">52</span><span class="kt">:</span><span class="err">11</span> <span class="kt">WARN</span> <span class="kt">TaskSetManager:</span> <span class="kt">Stage</span> <span class="err">2</span> <span class="kt">contains</span> <span class="kt">a</span> <span class="kt">task</span> <span class="kt">of</span> <span class="kt">very</span> <span class="kt">large</span> <span class="kt">size</span> <span class="o">(</span><span class="err">508</span> <span class="kt">KB</span><span class="o">)</span><span class="kt">.</span> <span class="kt">The</span> <span class="kt">maximum</span> <span class="kt">recommended</span> <span class="kt">task</span> <span class="kt">size</span> <span class="kt">is</span> <span class="err">100</span> <span class="kt">KB.</span>
<span class="err">17</span><span class="kt">/</span><span class="err">06</span><span class="kt">/</span><span class="err">05</span> <span class="err">15</span><span class="kt">:</span><span class="err">52</span><span class="kt">:</span><span class="err">11</span> <span class="kt">WARN</span> <span class="kt">TaskSetManager:</span> <span class="kt">Stage</span> <span class="err">3</span> <span class="kt">contains</span> <span class="kt">a</span> <span class="kt">task</span> <span class="kt">of</span> <span class="kt">very</span> <span class="kt">large</span> <span class="kt">size</span> <span class="o">(</span><span class="err">508</span> <span class="kt">KB</span><span class="o">)</span><span class="kt">.</span> <span class="kt">The</span> <span class="kt">maximum</span> <span class="kt">recommended</span> <span class="kt">task</span> <span class="kt">size</span> <span class="kt">is</span> <span class="err">100</span> <span class="kt">KB.</span>
<span class="err">17</span><span class="kt">/</span><span class="err">06</span><span class="kt">/</span><span class="err">05</span> <span class="err">15</span><span class="kt">:</span><span class="err">52</span><span class="kt">:</span><span class="err">13</span> <span class="kt">WARN</span> <span class="kt">TaskSetManager:</span> <span class="kt">Stage</span> <span class="err">4</span> <span class="kt">contains</span> <span class="kt">a</span> <span class="kt">task</span> <span class="kt">of</span> <span class="kt">very</span> <span class="kt">large</span> <span class="kt">size</span> <span class="o">(</span><span class="err">296</span> <span class="kt">KB</span><span class="o">)</span><span class="kt">.</span> <span class="kt">The</span> <span class="kt">maximum</span> <span class="kt">recommended</span> <span class="kt">task</span> <span class="kt">size</span> <span class="kt">is</span> <span class="err">100</span> <span class="kt">KB.</span>
<span class="err">17</span><span class="kt">/</span><span class="err">06</span><span class="kt">/</span><span class="err">05</span> <span class="err">15</span><span class="kt">:</span><span class="err">52</span><span class="kt">:</span><span class="err">13</span> <span class="kt">WARN</span> <span class="kt">TaskSetManager:</span> <span class="kt">Stage</span> <span class="err">5</span> <span class="kt">contains</span> <span class="kt">a</span> <span class="kt">task</span> <span class="kt">of</span> <span class="kt">very</span> <span class="kt">large</span> <span class="kt">size</span> <span class="o">(</span><span class="err">508</span> <span class="kt">KB</span><span class="o">)</span><span class="kt">.</span> <span class="kt">The</span> <span class="kt">maximum</span> <span class="kt">recommended</span> <span class="kt">task</span> <span class="kt">size</span> <span class="kt">is</span> <span class="err">100</span> <span class="kt">KB.</span>
<span class="err">17</span><span class="kt">/</span><span class="err">06</span><span class="kt">/</span><span class="err">05</span> <span class="err">15</span><span class="kt">:</span><span class="err">52</span><span class="kt">:</span><span class="err">14</span> <span class="kt">WARN</span> <span class="kt">TaskSetManager:</span> <span class="kt">Stage</span> <span class="err">6</span> <span class="kt">contains</span> <span class="kt">a</span> <span class="kt">task</span> <span class="kt">of</span> <span class="kt">very</span> <span class="kt">large</span> <span class="kt">size</span> <span class="o">(</span><span class="err">118</span> <span class="kt">KB</span><span class="o">)</span><span class="kt">.</span> <span class="kt">The</span> <span class="kt">maximum</span> <span class="kt">recommended</span> <span class="kt">task</span> <span class="kt">size</span> <span class="kt">is</span> <span class="err">100</span> <span class="kt">KB.</span>
<span class="err">17</span><span class="kt">/</span><span class="err">06</span><span class="kt">/</span><span class="err">05</span> <span class="err">15</span><span class="kt">:</span><span class="err">52</span><span class="kt">:</span><span class="err">14</span> <span class="kt">WARN</span> <span class="kt">TaskSetManager:</span> <span class="kt">Stage</span> <span class="err">7</span> <span class="kt">contains</span> <span class="kt">a</span> <span class="kt">task</span> <span class="kt">of</span> <span class="kt">very</span> <span class="kt">large</span> <span class="kt">size</span> <span class="o">(</span><span class="err">508</span> <span class="kt">KB</span><span class="o">)</span><span class="kt">.</span> <span class="kt">The</span> <span class="kt">maximum</span> <span class="kt">recommended</span> <span class="kt">task</span> <span class="kt">size</span> <span class="kt">is</span> <span class="err">100</span> <span class="kt">KB.</span>
<span class="err">17</span><span class="kt">/</span><span class="err">06</span><span class="kt">/</span><span class="err">05</span> <span class="err">15</span><span class="kt">:</span><span class="err">52</span><span class="kt">:</span><span class="err">14</span> <span class="kt">WARN</span> <span class="kt">TaskSetManager:</span> <span class="kt">Stage</span> <span class="err">8</span> <span class="kt">contains</span> <span class="kt">a</span> <span class="kt">task</span> <span class="kt">of</span> <span class="kt">very</span> <span class="kt">large</span> <span class="kt">size</span> <span class="o">(</span><span class="err">115</span> <span class="kt">KB</span><span class="o">)</span><span class="kt">.</span> <span class="kt">The</span> <span class="kt">maximum</span> <span class="kt">recommended</span> <span class="kt">task</span> <span class="kt">size</span> <span class="kt">is</span> <span class="err">100</span> <span class="kt">KB.</span>
<span class="err">17</span><span class="kt">/</span><span class="err">06</span><span class="kt">/</span><span class="err">05</span> <span class="err">15</span><span class="kt">:</span><span class="err">52</span><span class="kt">:</span><span class="err">14</span> <span class="kt">WARN</span> <span class="kt">TaskSetManager:</span> <span class="kt">Stage</span> <span class="err">9</span> <span class="kt">contains</span> <span class="kt">a</span> <span class="kt">task</span> <span class="kt">of</span> <span class="kt">very</span> <span class="kt">large</span> <span class="kt">size</span> <span class="o">(</span><span class="err">508</span> <span class="kt">KB</span><span class="o">)</span><span class="kt">.</span> <span class="kt">The</span> <span class="kt">maximum</span> <span class="kt">recommended</span> <span class="kt">task</span> <span class="kt">size</span> <span class="kt">is</span> <span class="err">100</span> <span class="kt">KB.</span>
<span class="err">17</span><span class="kt">/</span><span class="err">06</span><span class="kt">/</span><span class="err">05</span> <span class="err">15</span><span class="kt">:</span><span class="err">52</span><span class="kt">:</span><span class="err">15</span> <span class="kt">WARN</span> <span class="kt">TaskSetManager:</span> <span class="kt">Stage</span> <span class="err">11</span> <span class="kt">contains</span> <span class="kt">a</span> <span class="kt">task</span> <span class="kt">of</span> <span class="kt">very</span> <span class="kt">large</span> <span class="kt">size</span> <span class="o">(</span><span class="err">508</span> <span class="kt">KB</span><span class="o">)</span><span class="kt">.</span> <span class="kt">The</span> <span class="kt">maximum</span> <span class="kt">recommended</span> <span class="kt">task</span> <span class="kt">size</span> <span class="kt">is</span> <span class="err">100</span> <span class="kt">KB.</span>
<span class="err">17</span><span class="kt">/</span><span class="err">06</span><span class="kt">/</span><span class="err">05</span> <span class="err">15</span><span class="kt">:</span><span class="err">52</span><span class="kt">:</span><span class="err">15</span> <span class="kt">WARN</span> <span class="kt">TaskSetManager:</span> <span class="kt">Stage</span> <span class="err">13</span> <span class="kt">contains</span> <span class="kt">a</span> <span class="kt">task</span> <span class="kt">of</span> <span class="kt">very</span> <span class="kt">large</span> <span class="kt">size</span> <span class="o">(</span><span class="err">508</span> <span class="kt">KB</span><span class="o">)</span><span class="kt">.</span> <span class="kt">The</span> <span class="kt">maximum</span> <span class="kt">recommended</span> <span class="kt">task</span> <span class="kt">size</span> <span class="kt">is</span> <span class="err">100</span> <span class="kt">KB.</span>
<span class="err">17</span><span class="kt">/</span><span class="err">06</span><span class="kt">/</span><span class="err">05</span> <span class="err">15</span><span class="kt">:</span><span class="err">52</span><span class="kt">:</span><span class="err">16</span> <span class="kt">WARN</span> <span class="kt">TaskSetManager:</span> <span class="kt">Stage</span> <span class="err">15</span> <span class="kt">contains</span> <span class="kt">a</span> <span class="kt">task</span> <span class="kt">of</span> <span class="kt">very</span> <span class="kt">large</span> <span class="kt">size</span> <span class="o">(</span><span class="err">508</span> <span class="kt">KB</span><span class="o">)</span><span class="kt">.</span> <span class="kt">The</span> <span class="kt">maximum</span> <span class="kt">recommended</span> <span class="kt">task</span> <span class="kt">size</span> <span class="kt">is</span> <span class="err">100</span> <span class="kt">KB.</span>
<span class="err">17</span><span class="kt">/</span><span class="err">06</span><span class="kt">/</span><span class="err">05</span> <span class="err">15</span><span class="kt">:</span><span class="err">52</span><span class="kt">:</span><span class="err">16</span> <span class="kt">WARN</span> <span class="kt">TaskSetManager:</span> <span class="kt">Stage</span> <span class="err">17</span> <span class="kt">contains</span> <span class="kt">a</span> <span class="kt">task</span> <span class="kt">of</span> <span class="kt">very</span> <span class="kt">large</span> <span class="kt">size</span> <span class="o">(</span><span class="err">508</span> <span class="kt">KB</span><span class="o">)</span><span class="kt">.</span> <span class="kt">The</span> <span class="kt">maximum</span> <span class="kt">recommended</span> <span class="kt">task</span> <span class="kt">size</span> <span class="kt">is</span> <span class="err">100</span> <span class="kt">KB.</span>
<span class="err">17</span><span class="kt">/</span><span class="err">06</span><span class="kt">/</span><span class="err">05</span> <span class="err">15</span><span class="kt">:</span><span class="err">52</span><span class="kt">:</span><span class="err">17</span> <span class="kt">WARN</span> <span class="kt">TaskSetManager:</span> <span class="kt">Stage</span> <span class="err">19</span> <span class="kt">contains</span> <span class="kt">a</span> <span class="kt">task</span> <span class="kt">of</span> <span class="kt">very</span> <span class="kt">large</span> <span class="kt">size</span> <span class="o">(</span><span class="err">508</span> <span class="kt">KB</span><span class="o">)</span><span class="kt">.</span> <span class="kt">The</span> <span class="kt">maximum</span> <span class="kt">recommended</span> <span class="kt">task</span> <span class="kt">size</span> <span class="kt">is</span> <span class="err">100</span> <span class="kt">KB.</span>
<span class="err">17</span><span class="kt">/</span><span class="err">06</span><span class="kt">/</span><span class="err">05</span> <span class="err">15</span><span class="kt">:</span><span class="err">52</span><span class="kt">:</span><span class="err">17</span> <span class="kt">WARN</span> <span class="kt">TaskSetManager:</span> <span class="kt">Stage</span> <span class="err">21</span> <span class="kt">contains</span> <span class="kt">a</span> <span class="kt">task</span> <span class="kt">of</span> <span class="kt">very</span> <span class="kt">large</span> <span class="kt">size</span> <span class="o">(</span><span class="err">508</span> <span class="kt">KB</span><span class="o">)</span><span class="kt">.</span> <span class="kt">The</span> <span class="kt">maximum</span> <span class="kt">recommended</span> <span class="kt">task</span> <span class="kt">size</span> <span class="kt">is</span> <span class="err">100</span> <span class="kt">KB.</span>
<span class="err">17</span><span class="kt">/</span><span class="err">06</span><span class="kt">/</span><span class="err">05</span> <span class="err">15</span><span class="kt">:</span><span class="err">52</span><span class="kt">:</span><span class="err">18</span> <span class="kt">WARN</span> <span class="kt">TaskSetManager:</span> <span class="kt">Stage</span> <span class="err">23</span> <span class="kt">contains</span> <span class="kt">a</span> <span class="kt">task</span> <span class="kt">of</span> <span class="kt">very</span> <span class="kt">large</span> <span class="kt">size</span> <span class="o">(</span><span class="err">508</span> <span class="kt">KB</span><span class="o">)</span><span class="kt">.</span> <span class="kt">The</span> <span class="kt">maximum</span> <span class="kt">recommended</span> <span class="kt">task</span> <span class="kt">size</span> <span class="kt">is</span> <span class="err">100</span> <span class="kt">KB.</span>
<span class="err">17</span><span class="kt">/</span><span class="err">06</span><span class="kt">/</span><span class="err">05</span> <span class="err">15</span><span class="kt">:</span><span class="err">52</span><span class="kt">:</span><span class="err">18</span> <span class="kt">WARN</span> <span class="kt">TaskSetManager:</span> <span class="kt">Stage</span> <span class="err">25</span> <span class="kt">contains</span> <span class="kt">a</span> <span class="kt">task</span> <span class="kt">of</span> <span class="kt">very</span> <span class="kt">large</span> <span class="kt">size</span> <span class="o">(</span><span class="err">508</span> <span class="kt">KB</span><span class="o">)</span><span class="kt">.</span> <span class="kt">The</span> <span class="kt">maximum</span> <span class="kt">recommended</span> <span class="kt">task</span> <span class="kt">size</span> <span class="kt">is</span> <span class="err">100</span> <span class="kt">KB.</span>
<span class="err">17</span><span class="kt">/</span><span class="err">06</span><span class="kt">/</span><span class="err">05</span> <span class="err">15</span><span class="kt">:</span><span class="err">52</span><span class="kt">:</span><span class="err">19</span> <span class="kt">WARN</span> <span class="kt">TaskSetManager:</span> <span class="kt">Stage</span> <span class="err">27</span> <span class="kt">contains</span> <span class="kt">a</span> <span class="kt">task</span> <span class="kt">of</span> <span class="kt">very</span> <span class="kt">large</span> <span class="kt">size</span> <span class="o">(</span><span class="err">508</span> <span class="kt">KB</span><span class="o">)</span><span class="kt">.</span> <span class="kt">The</span> <span class="kt">maximum</span> <span class="kt">recommended</span> <span class="kt">task</span> <span class="kt">size</span> <span class="kt">is</span> <span class="err">100</span> <span class="kt">KB.</span>
<span class="err">17</span><span class="kt">/</span><span class="err">06</span><span class="kt">/</span><span class="err">05</span> <span class="err">15</span><span class="kt">:</span><span class="err">52</span><span class="kt">:</span><span class="err">19</span> <span class="kt">WARN</span> <span class="kt">TaskSetManager:</span> <span class="kt">Stage</span> <span class="err">29</span> <span class="kt">contains</span> <span class="kt">a</span> <span class="kt">task</span> <span class="kt">of</span> <span class="kt">very</span> <span class="kt">large</span> <span class="kt">size</span> <span class="o">(</span><span class="err">508</span> <span class="kt">KB</span><span class="o">)</span><span class="kt">.</span> <span class="kt">The</span> <span class="kt">maximum</span> <span class="kt">recommended</span> <span class="kt">task</span> <span class="kt">size</span> <span class="kt">is</span> <span class="err">100</span> <span class="kt">KB.</span>
<span class="err">17</span><span class="kt">/</span><span class="err">06</span><span class="kt">/</span><span class="err">05</span> <span class="err">15</span><span class="kt">:</span><span class="err">52</span><span class="kt">:</span><span class="err">20</span> <span class="kt">WARN</span> <span class="kt">TaskSetManager:</span> <span class="kt">Stage</span> <span class="err">31</span> <span class="kt">contains</span> <span class="kt">a</span> <span class="kt">task</span> <span class="kt">of</span> <span class="kt">very</span> <span class="kt">large</span> <span class="kt">size</span> <span class="o">(</span><span class="err">508</span> <span class="kt">KB</span><span class="o">)</span><span class="kt">.</span> <span class="kt">The</span> <span class="kt">maximum</span> <span class="kt">recommended</span> <span class="kt">task</span> <span class="kt">size</span> <span class="kt">is</span> <span class="err">100</span> <span class="kt">KB.</span>
<span class="kt">SystemML</span> <span class="kt">Statistics:</span>
<span class="kt">Total</span> <span class="kt">execution</span> <span class="kt">time:</span>		<span class="err">11</span><span class="kt">.</span><span class="err">261</span> <span class="kt">sec.</span>
<span class="kt">Number</span> <span class="kt">of</span> <span class="kt">executed</span> <span class="kt">Spark</span> <span class="kt">inst:</span>	<span class="err">32</span><span class="kt">.</span>

<span class="kt">params:</span> <span class="kt">org.apache.sysml.scripts.nn.examples.mnist_lenet.Train_output</span> <span class="o">=</span>
<span class="n">W1</span> <span class="o">(</span><span class="nc">Matrix</span><span class="o">)</span><span class="k">:</span> <span class="kt">MatrixObject:</span> <span class="kt">scratch_space</span><span class="c1">//_p64701_192.168.1.103//_t0/temp2203_1606, [32 x 25, nnz=800, blocks (1000 x 1000)], binaryblock, dirty
</span><span class="n">b1</span> <span class="o">(</span><span class="nc">Matrix</span><span class="o">)</span><span class="k">:</span> <span class="kt">MatrixObject:</span> <span class="kt">scratch_space</span><span class="c1">//_p64701_192.168.1.103//_t0/temp2205_1608, [32 x 1, nnz=32, blocks (1000 x 1000)], binaryblock, dirty
</span><span class="n">W2</span> <span class="o">(</span><span class="nc">Matrix</span><span class="o">)</span><span class="k">:</span> <span class="kt">MatrixObject:</span> <span class="kt">scratch_space</span><span class="c1">//_p64701_192.168.1.103//_t0/temp2196_1599, [64 x 800, nnz=51200, blocks (1000 x 1000)], binaryblock, dirty
</span><span class="n">b2</span> <span class="o">(</span><span class="nc">Matrix</span><span class="o">)</span><span class="k">:</span> <span class="kt">MatrixObject:</span> <span class="kt">scratch_space</span><span class="c1">//_p64701_192.168.1.103//_t0/temp2200_1603, [64 x 1, nnz=64, blocks (1000 x 1000)], binaryblock, dirty
</span><span class="n">W3</span> <span class="o">(</span><span class="nc">Matrix</span><span class="o">)</span><span class="k">:</span> <span class="kt">MatrixObject:</span> <span class="kt">scratch_space</span><span class="c1">//_p64701_192.168.1.103//_t0/temp2186_1589, [3136 x 512, nnz=1605632, blocks (1000 x 1000)], binaryblock, ...
</span><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">probs</span> <span class="k">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="o">(</span><span class="n">dummy</span><span class="o">.</span><span class="n">X</span><span class="o">,</span> <span class="n">dummy</span><span class="o">.</span><span class="n">C</span><span class="o">,</span> <span class="n">dummy</span><span class="o">.</span><span class="nc">Hin</span><span class="o">,</span> <span class="n">dummy</span><span class="o">.</span><span class="nc">Win</span><span class="o">,</span> <span class="n">params</span><span class="o">.</span><span class="n">W1</span><span class="o">,</span> <span class="n">params</span><span class="o">.</span><span class="n">b1</span><span class="o">,</span> <span class="n">params</span><span class="o">.</span><span class="n">W2</span><span class="o">,</span> <span class="n">params</span><span class="o">.</span><span class="n">b2</span><span class="o">,</span> <span class="n">params</span><span class="o">.</span><span class="n">W3</span><span class="o">,</span> <span class="n">params</span><span class="o">.</span><span class="n">b3</span><span class="o">,</span> <span class="n">params</span><span class="o">.</span><span class="n">W4</span><span class="o">,</span> <span class="n">params</span><span class="o">.</span><span class="n">b4</span><span class="o">)</span>
<span class="nc">SystemML</span> <span class="nc">Statistics</span><span class="k">:</span>
<span class="kt">Total</span> <span class="kt">execution</span> <span class="kt">time:</span>		<span class="err">2</span><span class="kt">.</span><span class="err">148</span> <span class="kt">sec.</span>
<span class="kt">Number</span> <span class="kt">of</span> <span class="kt">executed</span> <span class="kt">Spark</span> <span class="kt">inst:</span>	<span class="err">48</span><span class="kt">.</span>

<span class="kt">probs:</span> <span class="kt">org.apache.sysml.api.mlcontext.Matrix</span> <span class="o">=</span> <span class="nc">MatrixObject</span><span class="k">:</span> <span class="kt">scratch_space</span><span class="c1">//_p64701_192.168.1.103//_t0/temp2505_1865, [1024 x 10, nnz=10240, blocks (1000 x 1000)], binaryblock, dirty
</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">perf</span> <span class="k">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">eval</span><span class="o">(</span><span class="n">probs</span><span class="o">,</span> <span class="n">dummy</span><span class="o">.</span><span class="n">Y</span><span class="o">)</span>
<span class="nc">SystemML</span> <span class="nc">Statistics</span><span class="k">:</span>
<span class="kt">Total</span> <span class="kt">execution</span> <span class="kt">time:</span>		<span class="err">0</span><span class="kt">.</span><span class="err">007</span> <span class="kt">sec.</span>
<span class="kt">Number</span> <span class="kt">of</span> <span class="kt">executed</span> <span class="kt">Spark</span> <span class="kt">inst:</span>	<span class="err">48</span><span class="kt">.</span>

<span class="kt">perf:</span> <span class="kt">org.apache.sysml.scripts.nn.examples.mnist_lenet.Eval_output</span> <span class="o">=</span>
<span class="n">loss</span> <span class="o">(</span><span class="n">double</span><span class="o">)</span><span class="k">:</span> <span class="err">2</span><span class="kt">.</span><span class="err">2681513307168797</span>
<span class="kt">accuracy</span> <span class="o">(</span><span class="kt">double</span><span class="o">)</span><span class="kt">:</span> <span class="err">0</span><span class="kt">.</span><span class="err">1435546875</span></code></pre></div>

  </div>

</div>

<h2 id="dataframe-example">DataFrame Example</h2>

<p>For demonstration purposes, we&#8217;ll use Spark to create a <code>DataFrame</code> called <code>df</code> of random <code>double</code>s from 0 to 1 consisting of 10,000 rows and 100 columns.</p>

<div class="codetabs">

<div data-lang="Scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">import</span> <span class="nn">org.apache.spark.sql._</span>
<span class="k">import</span> <span class="nn">org.apache.spark.sql.types.</span><span class="o">{</span><span class="nc">StructType</span><span class="o">,</span><span class="nc">StructField</span><span class="o">,</span><span class="nc">DoubleType</span><span class="o">}</span>
<span class="k">import</span> <span class="nn">scala.util.Random</span>
<span class="k">val</span> <span class="n">numRows</span> <span class="k">=</span> <span class="mi">10000</span>
<span class="k">val</span> <span class="n">numCols</span> <span class="k">=</span> <span class="mi">100</span>
<span class="k">val</span> <span class="n">data</span> <span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="o">(</span><span class="mi">0</span> <span class="n">to</span> <span class="n">numRows</span><span class="o">-</span><span class="mi">1</span><span class="o">).</span><span class="n">map</span> <span class="o">{</span> <span class="k">_</span> <span class="k">=&gt;</span> <span class="nc">Row</span><span class="o">.</span><span class="n">fromSeq</span><span class="o">(</span><span class="nc">Seq</span><span class="o">.</span><span class="n">fill</span><span class="o">(</span><span class="n">numCols</span><span class="o">)(</span><span class="nc">Random</span><span class="o">.</span><span class="n">nextDouble</span><span class="o">))</span> <span class="o">}</span>
<span class="k">val</span> <span class="n">schema</span> <span class="k">=</span> <span class="nc">StructType</span><span class="o">((</span><span class="mi">0</span> <span class="n">to</span> <span class="n">numCols</span><span class="o">-</span><span class="mi">1</span><span class="o">).</span><span class="n">map</span> <span class="o">{</span> <span class="n">i</span> <span class="k">=&gt;</span> <span class="nc">StructField</span><span class="o">(</span><span class="s">"C"</span> <span class="o">+</span> <span class="n">i</span><span class="o">,</span> <span class="nc">DoubleType</span><span class="o">,</span> <span class="kc">true</span><span class="o">)</span> <span class="o">}</span> <span class="o">)</span>
<span class="k">val</span> <span class="n">df</span> <span class="k">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="o">(</span><span class="n">data</span><span class="o">,</span> <span class="n">schema</span><span class="o">)</span></code></pre></div>

  </div>

<div data-lang="Spark Shell">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">import</span> <span class="nn">org.apache.spark.sql._</span>
<span class="k">import</span> <span class="nn">org.apache.spark.sql._</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">import</span> <span class="nn">org.apache.spark.sql.types.</span><span class="o">{</span><span class="nc">StructType</span><span class="o">,</span><span class="nc">StructField</span><span class="o">,</span><span class="nc">DoubleType</span><span class="o">}</span>
<span class="k">import</span> <span class="nn">org.apache.spark.sql.types.</span><span class="o">{</span><span class="nc">StructType</span><span class="o">,</span> <span class="nc">StructField</span><span class="o">,</span> <span class="nc">DoubleType</span><span class="o">}</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">import</span> <span class="nn">scala.util.Random</span>
<span class="k">import</span> <span class="nn">scala.util.Random</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">numRows</span> <span class="k">=</span> <span class="mi">10000</span>
<span class="n">numRows</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">numCols</span> <span class="k">=</span> <span class="mi">100</span>
<span class="n">numCols</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">data</span> <span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="o">(</span><span class="mi">0</span> <span class="n">to</span> <span class="n">numRows</span><span class="o">-</span><span class="mi">1</span><span class="o">).</span><span class="n">map</span> <span class="o">{</span> <span class="k">_</span> <span class="k">=&gt;</span> <span class="nc">Row</span><span class="o">.</span><span class="n">fromSeq</span><span class="o">(</span><span class="nc">Seq</span><span class="o">.</span><span class="n">fill</span><span class="o">(</span><span class="n">numCols</span><span class="o">)(</span><span class="nc">Random</span><span class="o">.</span><span class="n">nextDouble</span><span class="o">))</span> <span class="o">}</span>
<span class="n">data</span><span class="k">:</span> <span class="kt">org.apache.spark.rdd.RDD</span><span class="o">[</span><span class="kt">org.apache.spark.sql.Row</span><span class="o">]</span> <span class="k">=</span> <span class="nc">MapPartitionsRDD</span><span class="o">[</span><span class="err">1</span><span class="o">]</span> <span class="n">at</span> <span class="n">map</span> <span class="n">at</span> <span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">42</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">schema</span> <span class="k">=</span> <span class="nc">StructType</span><span class="o">((</span><span class="mi">0</span> <span class="n">to</span> <span class="n">numCols</span><span class="o">-</span><span class="mi">1</span><span class="o">).</span><span class="n">map</span> <span class="o">{</span> <span class="n">i</span> <span class="k">=&gt;</span> <span class="nc">StructField</span><span class="o">(</span><span class="s">"C"</span> <span class="o">+</span> <span class="n">i</span><span class="o">,</span> <span class="nc">DoubleType</span><span class="o">,</span> <span class="kc">true</span><span class="o">)</span> <span class="o">}</span> <span class="o">)</span>
<span class="n">schema</span><span class="k">:</span> <span class="kt">org.apache.spark.sql.</span><span class="k">type</span><span class="kt">s.StructType</span> <span class="o">=</span> <span class="nc">StructType</span><span class="o">(</span><span class="nc">StructField</span><span class="o">(</span><span class="n">C0</span><span class="o">,</span><span class="nc">DoubleType</span><span class="o">,</span><span class="kc">true</span><span class="o">),</span> <span class="nc">StructField</span><span class="o">(</span><span class="n">C1</span><span class="o">,</span><span class="nc">DoubleType</span><span class="o">,</span><span class="kc">true</span><span class="o">),</span> <span class="nc">StructField</span><span class="o">(</span><span class="n">C2</span><span class="o">,</span><span class="nc">DoubleType</span><span class="o">,</span><span class="kc">true</span><span class="o">),</span> <span class="nc">StructField</span><span class="o">(</span><span class="n">C3</span><span class="o">,</span><span class="nc">DoubleType</span><span class="o">,</span><span class="kc">true</span><span class="o">),</span> <span class="nc">StructField</span><span class="o">(</span><span class="n">C4</span><span class="o">,</span><span class="nc">DoubleType</span><span class="o">,</span><span class="kc">true</span><span class="o">),</span> <span class="nc">StructField</span><span class="o">(</span><span class="n">C5</span><span class="o">,</span><span class="nc">DoubleType</span><span class="o">,</span><span class="kc">true</span><span class="o">),</span> <span class="nc">StructField</span><span class="o">(</span><span class="n">C6</span><span class="o">,</span><span class="nc">DoubleType</span><span class="o">,</span><span class="kc">true</span><span class="o">),</span> <span class="nc">StructField</span><span class="o">(</span><span class="n">C7</span><span class="o">,</span><span class="nc">DoubleType</span><span class="o">,</span><span class="kc">true</span><span class="o">),</span> <span class="nc">StructField</span><span class="o">(</span><span class="n">C8</span><span class="o">,</span><span class="nc">DoubleType</span><span class="o">,</span><span class="kc">true</span><span class="o">),</span> <span class="nc">StructField</span><span class="o">(</span><span class="n">C9</span><span class="o">,</span><span class="nc">DoubleType</span><span class="o">,</span><span class="kc">true</span><span class="o">),</span> <span class="nc">StructField</span><span class="o">(</span><span class="n">C10</span><span class="o">,</span><span class="nc">DoubleType</span><span class="o">,</span><span class="kc">true</span><span class="o">),</span> <span class="nc">StructField</span><span class="o">(</span><span class="n">C11</span><span class="o">,</span><span class="nc">DoubleType</span><span class="o">,</span><span class="kc">true</span><span class="o">),</span> <span class="nc">StructField</span><span class="o">(</span><span class="n">C12</span><span class="o">,</span><span class="nc">DoubleType</span><span class="o">,</span><span class="kc">true</span><span class="o">),</span> <span class="nc">StructField</span><span class="o">(</span><span class="n">C13</span><span class="o">,</span><span class="nc">DoubleType</span><span class="o">,</span><span class="kc">true</span><span class="o">),</span> <span class="nc">StructField</span><span class="o">(</span><span class="n">C14</span><span class="o">,</span><span class="nc">DoubleType</span><span class="o">,</span><span class="kc">true</span><span class="o">),</span> <span class="nc">StructField</span><span class="o">(</span><span class="n">C15</span><span class="o">,</span><span class="nc">DoubleType</span><span class="o">,</span><span class="kc">true</span><span class="o">),</span> <span class="nc">StructField</span><span class="o">(</span><span class="n">C16</span><span class="o">,</span><span class="nc">DoubleType</span><span class="o">,</span><span class="kc">true</span><span class="o">),</span> <span class="nc">StructField</span><span class="o">(</span><span class="n">C17</span><span class="o">,</span><span class="nc">DoubleType</span><span class="o">,</span><span class="kc">true</span><span class="o">),</span> <span class="nc">StructField</span><span class="o">(</span><span class="n">C18</span><span class="o">,</span><span class="nc">DoubleType</span><span class="o">,</span><span class="kc">true</span><span class="o">),</span> <span class="nc">StructField</span><span class="o">(</span><span class="n">C19</span><span class="o">,</span><span class="nc">DoubleType</span><span class="o">,</span><span class="kc">true</span><span class="o">),</span> <span class="nc">StructField</span><span class="o">(</span><span class="n">C20</span><span class="o">,</span><span class="nc">DoubleType</span><span class="o">,</span><span class="kc">true</span><span class="o">),</span> <span class="nc">StructField</span><span class="o">(</span><span class="n">C21</span><span class="o">,</span><span class="nc">DoubleType</span><span class="o">,</span><span class="kc">true</span><span class="o">),</span> <span class="o">...</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">df</span> <span class="k">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="o">(</span><span class="n">data</span><span class="o">,</span> <span class="n">schema</span><span class="o">)</span>
<span class="n">df</span><span class="k">:</span> <span class="kt">org.apache.spark.sql.DataFrame</span> <span class="o">=</span> <span class="o">[</span><span class="kt">C0:</span> <span class="kt">double</span>, <span class="kt">C1:</span> <span class="kt">double</span>, <span class="kt">C2:</span> <span class="kt">double</span>, <span class="kt">C3:</span> <span class="kt">double</span>, <span class="kt">C4:</span> <span class="kt">double</span>, <span class="kt">C5:</span> <span class="kt">double</span>, <span class="kt">C6:</span> <span class="kt">double</span>, <span class="kt">C7:</span> <span class="kt">double</span>, <span class="kt">C8:</span> <span class="kt">double</span>, <span class="kt">C9:</span> <span class="kt">double</span>, <span class="kt">C10:</span> <span class="kt">double</span>, <span class="kt">C11:</span> <span class="kt">double</span>, <span class="kt">C12:</span> <span class="kt">double</span>, <span class="kt">C13:</span> <span class="kt">double</span>, <span class="kt">C14:</span> <span class="kt">double</span>, <span class="kt">C15:</span> <span class="kt">double</span>, <span class="kt">C16:</span> <span class="kt">double</span>, <span class="kt">C17:</span> <span class="kt">double</span>, <span class="kt">C18:</span> <span class="kt">double</span>, <span class="kt">C19:</span> <span class="kt">double</span>, <span class="kt">C20:</span> <span class="kt">double</span>, <span class="kt">C21:</span> <span class="kt">double</span>, <span class="kt">C22:</span> <span class="kt">double</span>, <span class="kt">C23:</span> <span class="kt">double</span>, <span class="kt">C24:</span> <span class="kt">double</span>, <span class="kt">C25:</span> <span class="kt">double</span>, <span class="kt">C26:</span> <span class="kt">double</span>, <span class="kt">C27:</span> <span class="kt">double</span>, <span class="kt">C28:</span> <span class="kt">double</span>, <span class="kt">C29:</span> <span class="kt">double</span>, <span class="kt">C30:</span> <span class="kt">double</span>, <span class="kt">C31:</span> <span class="kt">double</span>, <span class="kt">C32:</span> <span class="kt">double</span>, <span class="kt">C33:</span> <span class="kt">double</span>, <span class="kt">C34:</span> <span class="kt">double</span>, <span class="kt">C35:</span> <span class="kt">double</span>, <span class="kt">C36:</span> <span class="kt">double</span>, <span class="kt">C37:</span> <span class="kt">double</span>, <span class="kt">C38:</span> <span class="kt">double</span>, <span class="kt">C39:</span> <span class="kt">double</span>, <span class="kt">C40:</span> <span class="kt">double</span>, <span class="kt">C41:</span> <span class="kt">double</span>, <span class="kt">C42:</span> <span class="kt">double</span>, <span class="kt">C43:</span> <span class="kt">double</span>, <span class="kt">C44:</span> <span class="kt">double</span>, <span class="kt">C45:</span> <span class="kt">double</span>, <span class="kt">C46:</span> <span class="kt">double</span>, <span class="kt">C47:</span> <span class="kt">double</span>, <span class="kt">C48:</span> <span class="kt">double</span>, <span class="kt">C49:</span> <span class="kt">double</span>, <span class="kt">C50:</span> <span class="kt">double</span>, <span class="kt">C51:</span> <span class="kt">double</span>, <span class="kt">C52:</span> <span class="kt">double</span>, <span class="kt">C53:</span> <span class="kt">double</span>, <span class="kt">C54:</span> <span class="kt">double</span>, <span class="kt">C55:</span> <span class="kt">double</span>, <span class="kt">C56:</span> <span class="kt">double</span>, <span class="kt">C57:</span> <span class="kt">double</span>, <span class="kt">C58:</span> <span class="kt">double</span>, <span class="kt">C5...</span></code></pre></div>

  </div>

<div data-lang="Python">

    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">numRows</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">numCols</span> <span class="o">=</span> <span class="mi">100</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">random</span>
<span class="kn">from</span> <span class="nn">pyspark.sql.types</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">numRows</span><span class="p">))</span><span class="o">.</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="p">[</span> <span class="n">random</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numCols</span><span class="p">)</span> <span class="p">])</span>
<span class="n">schema</span> <span class="o">=</span> <span class="n">StructType</span><span class="p">([</span> <span class="n">StructField</span><span class="p">(</span><span class="s">"C"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">DoubleType</span><span class="p">(),</span> <span class="bp">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numCols</span><span class="p">)</span> <span class="p">])</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">schema</span><span class="p">)</span></code></pre></div>

  </div>

<div data-lang="PySpark Shell">

    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">numRows</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">numCols</span> <span class="o">=</span> <span class="mi">100</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">random</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pyspark.sql.types</span> <span class="kn">import</span> <span class="o">*</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">numRows</span><span class="p">))</span><span class="o">.</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="p">[</span> <span class="n">random</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numCols</span><span class="p">)</span> <span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">schema</span> <span class="o">=</span> <span class="n">StructType</span><span class="p">([</span> <span class="n">StructField</span><span class="p">(</span><span class="s">"C"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">DoubleType</span><span class="p">(),</span> <span class="bp">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numCols</span><span class="p">)</span> <span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">schema</span><span class="p">)</span></code></pre></div>

  </div>

</div>

<p>We&#8217;ll create a DML script to find the minimum, maximum, and mean values in a matrix. This
script has one input variable, matrix <code>Xin</code>, and three output variables, <code>minOut</code>, <code>maxOut</code>, and <code>meanOut</code>.</p>

<p>For performance, we&#8217;ll specify metadata indicating that the matrix has 10,000 rows and 100 columns.</p>

<p>We&#8217;ll create a DML script using the ScriptFactory <code>dml</code> method with the <code>minMaxMean</code> script String. The
input variable is specified to be our <code>DataFrame</code> <code>df</code> with <code>MatrixMetadata</code> <code>mm</code>. The output
variables are specified to be <code>minOut</code>, <code>maxOut</code>, and <code>meanOut</code>. Notice that inputs are supplied by the
<code>in</code> method, and outputs are supplied by the <code>out</code> method.</p>

<p>We execute the script and obtain the results as a Tuple by calling <code>getTuple</code> on the results, specifying
the types and names of the output variables.</p>

<div class="codetabs">

<div data-lang="Scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">minMaxMean</span> <span class="k">=</span>
<span class="s">"""
minOut = min(Xin)
maxOut = max(Xin)
meanOut = mean(Xin)
"""</span>
<span class="k">val</span> <span class="n">mm</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MatrixMetadata</span><span class="o">(</span><span class="n">numRows</span><span class="o">,</span> <span class="n">numCols</span><span class="o">)</span>
<span class="k">val</span> <span class="n">minMaxMeanScript</span> <span class="k">=</span> <span class="n">dml</span><span class="o">(</span><span class="n">minMaxMean</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"Xin"</span><span class="o">,</span> <span class="n">df</span><span class="o">,</span> <span class="n">mm</span><span class="o">).</span><span class="n">out</span><span class="o">(</span><span class="s">"minOut"</span><span class="o">,</span> <span class="s">"maxOut"</span><span class="o">,</span> <span class="s">"meanOut"</span><span class="o">)</span>
<span class="k">val</span> <span class="o">(</span><span class="n">min</span><span class="o">,</span> <span class="n">max</span><span class="o">,</span> <span class="n">mean</span><span class="o">)</span> <span class="k">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">minMaxMeanScript</span><span class="o">).</span><span class="n">getTuple</span><span class="o">[</span><span class="kt">Double</span>, <span class="kt">Double</span>, <span class="kt">Double</span><span class="o">](</span><span class="s">"minOut"</span><span class="o">,</span> <span class="s">"maxOut"</span><span class="o">,</span> <span class="s">"meanOut"</span><span class="o">)</span></code></pre></div>

  </div>

<div data-lang="Spark Shell">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">minMaxMean</span> <span class="k">=</span>
     <span class="o">|</span> <span class="s">"""
     | minOut = min(Xin)
     | maxOut = max(Xin)
     | meanOut = mean(Xin)
     | """</span>
<span class="n">minMaxMean</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span>
<span class="s">"
minOut = min(Xin)
maxOut = max(Xin)
meanOut = mean(Xin)
"</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">mm</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MatrixMetadata</span><span class="o">(</span><span class="n">numRows</span><span class="o">,</span> <span class="n">numCols</span><span class="o">)</span>
<span class="n">mm</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.MatrixMetadata</span> <span class="o">=</span> <span class="n">rows</span><span class="k">:</span> <span class="err">10000</span><span class="o">,</span> <span class="n">columns</span><span class="k">:</span> <span class="err">100</span><span class="o">,</span> <span class="n">non</span><span class="o">-</span><span class="n">zeros</span><span class="k">:</span> <span class="kt">None</span><span class="o">,</span> <span class="n">rows</span> <span class="n">per</span> <span class="n">block</span><span class="k">:</span> <span class="kt">None</span><span class="o">,</span> <span class="n">columns</span> <span class="n">per</span> <span class="n">block</span><span class="k">:</span> <span class="kt">None</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">minMaxMeanScript</span> <span class="k">=</span> <span class="n">dml</span><span class="o">(</span><span class="n">minMaxMean</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"Xin"</span><span class="o">,</span> <span class="n">df</span><span class="o">,</span> <span class="n">mm</span><span class="o">).</span><span class="n">out</span><span class="o">(</span><span class="s">"minOut"</span><span class="o">,</span> <span class="s">"maxOut"</span><span class="o">,</span> <span class="s">"meanOut"</span><span class="o">)</span>
<span class="n">minMaxMeanScript</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.Script</span> <span class="o">=</span>
<span class="nc">Inputs</span><span class="k">:</span>
  <span class="err">[1]</span> <span class="o">(</span><span class="kt">DataFrame</span><span class="o">)</span> <span class="kt">Xin:</span> <span class="err">[</span><span class="kt">C0:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C1</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C2</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C3</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C4</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C5</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C6</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C7</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="o">...</span>

<span class="nc">Outputs</span><span class="k">:</span>
  <span class="err">[1]</span> <span class="kt">minOut</span>
  <span class="o">[</span><span class="err">2</span><span class="o">]</span> <span class="n">maxOut</span>
  <span class="o">[</span><span class="err">3</span><span class="o">]</span> <span class="n">meanOut</span>


<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="o">(</span><span class="n">min</span><span class="o">,</span> <span class="n">max</span><span class="o">,</span> <span class="n">mean</span><span class="o">)</span> <span class="k">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">minMaxMeanScript</span><span class="o">).</span><span class="n">getTuple</span><span class="o">[</span><span class="kt">Double</span>, <span class="kt">Double</span>, <span class="kt">Double</span><span class="o">](</span><span class="s">"minOut"</span><span class="o">,</span> <span class="s">"maxOut"</span><span class="o">,</span> <span class="s">"meanOut"</span><span class="o">)</span>
<span class="n">min</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="mf">2.6257349849956313E-8</span>
<span class="n">max</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="mf">0.9999999686609718</span>
<span class="n">mean</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="mf">0.49996223966662934</span></code></pre></div>

  </div>

<div data-lang="Python">

    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">minMaxMean</span> <span class="o">=</span> <span class="s">"""
minOut = min(Xin)
maxOut = max(Xin)
meanOut = mean(Xin)
"""</span>
<span class="n">minMaxMeanScript</span> <span class="o">=</span> <span class="n">dml</span><span class="p">(</span><span class="n">minMaxMean</span><span class="p">)</span><span class="o">.</span><span class="nb">input</span><span class="p">(</span><span class="s">"Xin"</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="s">"minOut"</span><span class="p">,</span> <span class="s">"maxOut"</span><span class="p">,</span> <span class="s">"meanOut"</span><span class="p">)</span>
<span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">,</span> <span class="n">mean</span> <span class="o">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">minMaxMeanScript</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"minOut"</span><span class="p">,</span> <span class="s">"maxOut"</span><span class="p">,</span> <span class="s">"meanOut"</span><span class="p">)</span></code></pre></div>

  </div>

<div data-lang="PySpark Shell">

    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">minMaxMean</span> <span class="o">=</span> <span class="s">"""
... minOut = min(Xin)
... maxOut = max(Xin)
... meanOut = mean(Xin)
... """</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">minMaxMeanScript</span> <span class="o">=</span> <span class="n">dml</span><span class="p">(</span><span class="n">minMaxMean</span><span class="p">)</span><span class="o">.</span><span class="nb">input</span><span class="p">(</span><span class="s">"Xin"</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="s">"minOut"</span><span class="p">,</span> <span class="s">"maxOut"</span><span class="p">,</span> <span class="s">"meanOut"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">,</span> <span class="n">mean</span> <span class="o">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">minMaxMeanScript</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"minOut"</span><span class="p">,</span> <span class="s">"maxOut"</span><span class="p">,</span> <span class="s">"meanOut"</span><span class="p">)</span>
<span class="n">SystemML</span> <span class="n">Statistics</span><span class="p">:</span>
<span class="n">Total</span> <span class="n">execution</span> <span class="n">time</span><span class="p">:</span>           <span class="mf">0.570</span> <span class="n">sec</span><span class="o">.</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">executed</span> <span class="n">Spark</span> <span class="n">inst</span><span class="p">:</span>  <span class="mf">0.</span></code></pre></div>

  </div>

</div>

<p>Many different types of input and output variables are automatically allowed. These types include
<code>Boolean</code>, <code>Long</code>, <code>Double</code>, <code>String</code>, <code>Array[Array[Double]]</code>, <code>RDD&lt;String&gt;</code> and <code>JavaRDD&lt;String&gt;</code>
in <code>CSV</code> (dense) and <code>IJV</code> (sparse) formats, <code>DataFrame</code>, <code>Matrix</code>, and
<code>Frame</code>. RDDs and JavaRDDs are assumed to be CSV format unless MatrixMetadata is supplied indicating
IJV format.</p>

<h2 id="rdd-example">RDD Example</h2>

<p>Let&#8217;s take a look at an example of input matrices as RDDs in CSV format. We&#8217;ll create two 2x2
matrices and input these into a DML script. This script will sum each matrix and create a message
based on which sum is greater. We will output the sums and the message.</p>

<p>For fun, we&#8217;ll write the script String to a file and then use ScriptFactory&#8217;s <code>dmlFromFile</code> method
(in Python, this method is under the <code>systemml</code> package)
to create the script object based on the file. We&#8217;ll also specify the inputs using a Map, although
we could have also chained together two <code>in</code> methods to specify the same inputs.</p>

<div class="codetabs">

<div data-lang="Scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">rdd1</span> <span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="o">(</span><span class="nc">Array</span><span class="o">(</span><span class="s">"1.0,2.0"</span><span class="o">,</span> <span class="s">"3.0,4.0"</span><span class="o">))</span>
<span class="k">val</span> <span class="n">rdd2</span> <span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="o">(</span><span class="nc">Array</span><span class="o">(</span><span class="s">"5.0,6.0"</span><span class="o">,</span> <span class="s">"7.0,8.0"</span><span class="o">))</span>
<span class="k">val</span> <span class="n">sums</span> <span class="k">=</span> <span class="s">"""
s1 = sum(m1);
s2 = sum(m2);
if (s1 &gt; s2) {
  message = "s1 is greater"
} else if (s2 &gt; s1) {
  message = "s2 is greater"
} else {
  message = "s1 and s2 are equal"
}
"""</span>
<span class="n">scala</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">nsc</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="nc">File</span><span class="o">(</span><span class="s">"sums.dml"</span><span class="o">).</span><span class="n">writeAll</span><span class="o">(</span><span class="n">sums</span><span class="o">)</span>
<span class="k">val</span> <span class="n">sumScript</span> <span class="k">=</span> <span class="n">dmlFromFile</span><span class="o">(</span><span class="s">"sums.dml"</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="nc">Map</span><span class="o">(</span><span class="s">"m1"</span><span class="o">-&gt;</span> <span class="n">rdd1</span><span class="o">,</span> <span class="s">"m2"</span><span class="o">-&gt;</span> <span class="n">rdd2</span><span class="o">)).</span><span class="n">out</span><span class="o">(</span><span class="s">"s1"</span><span class="o">,</span> <span class="s">"s2"</span><span class="o">,</span> <span class="s">"message"</span><span class="o">)</span>
<span class="k">val</span> <span class="n">sumResults</span> <span class="k">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">sumScript</span><span class="o">)</span>
<span class="k">val</span> <span class="n">s1</span> <span class="k">=</span> <span class="n">sumResults</span><span class="o">.</span><span class="n">getDouble</span><span class="o">(</span><span class="s">"s1"</span><span class="o">)</span>
<span class="k">val</span> <span class="n">s2</span> <span class="k">=</span> <span class="n">sumResults</span><span class="o">.</span><span class="n">getDouble</span><span class="o">(</span><span class="s">"s2"</span><span class="o">)</span>
<span class="k">val</span> <span class="n">message</span> <span class="k">=</span> <span class="n">sumResults</span><span class="o">.</span><span class="n">getString</span><span class="o">(</span><span class="s">"message"</span><span class="o">)</span></code></pre></div>

  </div>

<div data-lang="Spark Shell">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">rdd1</span> <span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="o">(</span><span class="nc">Array</span><span class="o">(</span><span class="s">"1.0,2.0"</span><span class="o">,</span> <span class="s">"3.0,4.0"</span><span class="o">))</span>
<span class="n">rdd1</span><span class="k">:</span> <span class="kt">org.apache.spark.rdd.RDD</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">ParallelCollectionRDD</span><span class="o">[</span><span class="err">42</span><span class="o">]</span> <span class="n">at</span> <span class="n">parallelize</span> <span class="n">at</span> <span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">38</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">rdd2</span> <span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="o">(</span><span class="nc">Array</span><span class="o">(</span><span class="s">"5.0,6.0"</span><span class="o">,</span> <span class="s">"7.0,8.0"</span><span class="o">))</span>
<span class="n">rdd2</span><span class="k">:</span> <span class="kt">org.apache.spark.rdd.RDD</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">ParallelCollectionRDD</span><span class="o">[</span><span class="err">43</span><span class="o">]</span> <span class="n">at</span> <span class="n">parallelize</span> <span class="n">at</span> <span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">38</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">sums</span> <span class="k">=</span> <span class="s">"""
     | s1 = sum(m1);
     | s2 = sum(m2);
     | if (s1 &gt; s2) {
     |   message = "s1 is greater"
     | } else if (s2 &gt; s1) {
     |   message = "s2 is greater"
     | } else {
     |   message = "s1 and s2 are equal"
     | }
     | """</span>
<span class="n">sums</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span>
<span class="s">"
s1 = sum(m1);
s2 = sum(m2);
if (s1 &gt; s2) {
  message = "</span><span class="n">s1</span> <span class="n">is</span> <span class="n">greater</span><span class="s">"
} else if (s2 &gt; s1) {
  message = "</span><span class="n">s2</span> <span class="n">is</span> <span class="n">greater</span><span class="s">"
} else {
  message = "</span><span class="n">s1</span> <span class="n">and</span> <span class="n">s2</span> <span class="n">are</span> <span class="n">equal</span><span class="s">"
}
"</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">scala</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">nsc</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="nc">File</span><span class="o">(</span><span class="s">"sums.dml"</span><span class="o">).</span><span class="n">writeAll</span><span class="o">(</span><span class="n">sums</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">sumScript</span> <span class="k">=</span> <span class="n">dmlFromFile</span><span class="o">(</span><span class="s">"sums.dml"</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="nc">Map</span><span class="o">(</span><span class="s">"m1"</span><span class="o">-&gt;</span> <span class="n">rdd1</span><span class="o">,</span> <span class="s">"m2"</span><span class="o">-&gt;</span> <span class="n">rdd2</span><span class="o">)).</span><span class="n">out</span><span class="o">(</span><span class="s">"s1"</span><span class="o">,</span> <span class="s">"s2"</span><span class="o">,</span> <span class="s">"message"</span><span class="o">)</span>
<span class="n">sumScript</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.Script</span> <span class="o">=</span>
<span class="nc">Inputs</span><span class="k">:</span>
  <span class="err">[1]</span> <span class="o">(</span><span class="kt">RDD</span><span class="o">)</span> <span class="kt">m1:</span> <span class="kt">ParallelCollectionRDD</span><span class="o">[</span><span class="err">42</span><span class="o">]</span> <span class="n">at</span> <span class="n">parallelize</span> <span class="n">at</span> <span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">38</span>
  <span class="o">[</span><span class="err">2</span><span class="o">]</span> <span class="o">(</span><span class="nc">RDD</span><span class="o">)</span> <span class="n">m2</span><span class="k">:</span> <span class="kt">ParallelCollectionRDD</span><span class="o">[</span><span class="err">43</span><span class="o">]</span> <span class="n">at</span> <span class="n">parallelize</span> <span class="n">at</span> <span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">38</span>

<span class="nc">Outputs</span><span class="k">:</span>
  <span class="err">[1]</span> <span class="kt">s1</span>
  <span class="o">[</span><span class="err">2</span><span class="o">]</span> <span class="n">s2</span>
  <span class="o">[</span><span class="err">3</span><span class="o">]</span> <span class="n">message</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">sumResults</span> <span class="k">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">sumScript</span><span class="o">)</span>
<span class="n">sumResults</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.MLResults</span> <span class="o">=</span>
  <span class="o">[</span><span class="err">1</span><span class="o">]</span> <span class="o">(</span><span class="nc">Double</span><span class="o">)</span> <span class="n">s1</span><span class="k">:</span> <span class="err">10</span><span class="kt">.</span><span class="err">0</span>
  <span class="err">[2]</span> <span class="o">(</span><span class="kt">Double</span><span class="o">)</span> <span class="kt">s2:</span> <span class="err">26</span><span class="kt">.</span><span class="err">0</span>
  <span class="err">[3]</span> <span class="o">(</span><span class="kt">String</span><span class="o">)</span> <span class="kt">message:</span> <span class="kt">s2</span> <span class="kt">is</span> <span class="kt">greater</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">s1</span> <span class="k">=</span> <span class="n">sumResults</span><span class="o">.</span><span class="n">getDouble</span><span class="o">(</span><span class="s">"s1"</span><span class="o">)</span>
<span class="n">s1</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="mf">10.0</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">s2</span> <span class="k">=</span> <span class="n">sumResults</span><span class="o">.</span><span class="n">getDouble</span><span class="o">(</span><span class="s">"s2"</span><span class="o">)</span>
<span class="n">s2</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="mf">26.0</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">message</span> <span class="k">=</span> <span class="n">sumResults</span><span class="o">.</span><span class="n">getString</span><span class="o">(</span><span class="s">"message"</span><span class="o">)</span>
<span class="n">message</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">s2</span> <span class="n">is</span> <span class="n">greater</span></code></pre></div>

  </div>

<div data-lang="Python">

    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">rdd1</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="s">"1.0,2.0"</span><span class="p">,</span> <span class="s">"3.0,4.0"</span><span class="p">])</span>
<span class="n">rdd2</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="s">"5.0,6.0"</span><span class="p">,</span> <span class="s">"7.0,8.0"</span><span class="p">])</span>
<span class="n">sums</span> <span class="o">=</span> <span class="s">"""
s1 = sum(m1);
s2 = sum(m2);
if (s1 &gt; s2) {
  message = "s1 is greater"
} else if (s2 &gt; s1) {
  message = "s2 is greater"
} else {
  message = "s1 and s2 are equal"
}
"""</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"sums.dml"</span><span class="p">,</span> <span class="s">"w"</span><span class="p">)</span> <span class="k">as</span> <span class="n">text_file</span><span class="p">:</span>
    <span class="n">text_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">sums</span><span class="p">)</span>

<span class="n">sumScript</span> <span class="o">=</span> <span class="n">dmlFromFile</span><span class="p">(</span><span class="s">"sums.dml"</span><span class="p">)</span><span class="o">.</span><span class="nb">input</span><span class="p">(</span><span class="n">m1</span><span class="o">=</span><span class="n">rdd1</span><span class="p">,</span> <span class="n">m2</span><span class="o">=</span> <span class="n">rdd2</span><span class="p">)</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="s">"s1"</span><span class="p">,</span> <span class="s">"s2"</span><span class="p">,</span> <span class="s">"message"</span><span class="p">)</span>
<span class="n">sumResults</span> <span class="o">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sumScript</span><span class="p">)</span>
<span class="n">s1</span> <span class="o">=</span> <span class="n">sumResults</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"s1"</span><span class="p">)</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">sumResults</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"s2"</span><span class="p">)</span>
<span class="n">message</span> <span class="o">=</span> <span class="n">sumResults</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"message"</span><span class="p">)</span></code></pre></div>

  </div>

<div data-lang="PySpark Shell">

    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">rdd1</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="s">"1.0,2.0"</span><span class="p">,</span> <span class="s">"3.0,4.0"</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">rdd2</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="s">"5.0,6.0"</span><span class="p">,</span> <span class="s">"7.0,8.0"</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sums</span> <span class="o">=</span> <span class="s">"""
... s1 = sum(m1);
... s2 = sum(m2);
... if (s1 &gt; s2) {
...   message = "s1 is greater"
... } else if (s2 &gt; s1) {
...   message = "s2 is greater"
... } else {
...   message = "s1 and s2 are equal"
... }
... """</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"sums.dml"</span><span class="p">,</span> <span class="s">"w"</span><span class="p">)</span> <span class="k">as</span> <span class="n">text_file</span><span class="p">:</span>
<span class="o">...</span>     <span class="n">text_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">sums</span><span class="p">)</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sumScript</span> <span class="o">=</span> <span class="n">dmlFromFile</span><span class="p">(</span><span class="s">"sums.dml"</span><span class="p">)</span><span class="o">.</span><span class="nb">input</span><span class="p">(</span><span class="n">m1</span><span class="o">=</span><span class="n">rdd1</span><span class="p">,</span> <span class="n">m2</span><span class="o">=</span> <span class="n">rdd2</span><span class="p">)</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="s">"s1"</span><span class="p">,</span> <span class="s">"s2"</span><span class="p">,</span> <span class="s">"message"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sumResults</span> <span class="o">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sumScript</span><span class="p">)</span>
<span class="n">s1</span> <span class="o">=</span> <span class="n">sumResults</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"s1"</span><span class="p">)</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">sumResults</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"s2"</span><span class="p">)</span>
<span class="n">message</span> <span class="o">=</span> <span class="n">sumResults</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"message"</span><span class="p">)</span>
<span class="n">SystemML</span> <span class="n">Statistics</span><span class="p">:</span>
<span class="n">Total</span> <span class="n">execution</span> <span class="n">time</span><span class="p">:</span>           <span class="mf">0.933</span> <span class="n">sec</span><span class="o">.</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">executed</span> <span class="n">Spark</span> <span class="n">inst</span><span class="p">:</span>  <span class="mf">4.</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">s1</span> <span class="o">=</span> <span class="n">sumResults</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"s1"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s2</span> <span class="o">=</span> <span class="n">sumResults</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"s2"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">message</span> <span class="o">=</span> <span class="n">sumResults</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"message"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s1</span>
<span class="mf">10.0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s2</span>
<span class="mf">26.0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">message</span>
<span class="s">u's2 is greater'</span></code></pre></div>

  </div>

</div>

<p>If you have metadata that you would like to supply along with the input matrices, this can be
accomplished using a Scala Seq, List, or Array. This feature is currently not available in Python.</p>

<div class="codetabs">

<div data-lang="Scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">rdd1Metadata</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MatrixMetadata</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">2</span><span class="o">)</span>
<span class="k">val</span> <span class="n">rdd2Metadata</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MatrixMetadata</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">2</span><span class="o">)</span>
<span class="k">val</span> <span class="n">sumScript</span> <span class="k">=</span> <span class="n">dmlFromFile</span><span class="o">(</span><span class="s">"sums.dml"</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="nc">Seq</span><span class="o">((</span><span class="s">"m1"</span><span class="o">,</span> <span class="n">rdd1</span><span class="o">,</span> <span class="n">rdd1Metadata</span><span class="o">),</span> <span class="o">(</span><span class="s">"m2"</span><span class="o">,</span> <span class="n">rdd2</span><span class="o">,</span> <span class="n">rdd2Metadata</span><span class="o">))).</span><span class="n">out</span><span class="o">(</span><span class="s">"s1"</span><span class="o">,</span> <span class="s">"s2"</span><span class="o">,</span> <span class="s">"message"</span><span class="o">)</span>
<span class="k">val</span> <span class="o">(</span><span class="n">firstSum</span><span class="o">,</span> <span class="n">secondSum</span><span class="o">,</span> <span class="n">sumMessage</span><span class="o">)</span> <span class="k">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">sumScript</span><span class="o">).</span><span class="n">getTuple</span><span class="o">[</span><span class="kt">Double</span>, <span class="kt">Double</span>, <span class="kt">String</span><span class="o">](</span><span class="s">"s1"</span><span class="o">,</span> <span class="s">"s2"</span><span class="o">,</span> <span class="s">"message"</span><span class="o">)</span></code></pre></div>

  </div>

<div data-lang="Spark Shell">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">rdd1Metadata</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MatrixMetadata</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">2</span><span class="o">)</span>
<span class="n">rdd1Metadata</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.MatrixMetadata</span> <span class="o">=</span> <span class="n">rows</span><span class="k">:</span> <span class="err">2</span><span class="o">,</span> <span class="n">columns</span><span class="k">:</span> <span class="err">2</span><span class="o">,</span> <span class="n">non</span><span class="o">-</span><span class="n">zeros</span><span class="k">:</span> <span class="kt">None</span><span class="o">,</span> <span class="n">rows</span> <span class="n">per</span> <span class="n">block</span><span class="k">:</span> <span class="kt">None</span><span class="o">,</span> <span class="n">columns</span> <span class="n">per</span> <span class="n">block</span><span class="k">:</span> <span class="kt">None</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">rdd2Metadata</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MatrixMetadata</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">2</span><span class="o">)</span>
<span class="n">rdd2Metadata</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.MatrixMetadata</span> <span class="o">=</span> <span class="n">rows</span><span class="k">:</span> <span class="err">2</span><span class="o">,</span> <span class="n">columns</span><span class="k">:</span> <span class="err">2</span><span class="o">,</span> <span class="n">non</span><span class="o">-</span><span class="n">zeros</span><span class="k">:</span> <span class="kt">None</span><span class="o">,</span> <span class="n">rows</span> <span class="n">per</span> <span class="n">block</span><span class="k">:</span> <span class="kt">None</span><span class="o">,</span> <span class="n">columns</span> <span class="n">per</span> <span class="n">block</span><span class="k">:</span> <span class="kt">None</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">sumScript</span> <span class="k">=</span> <span class="n">dmlFromFile</span><span class="o">(</span><span class="s">"sums.dml"</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="nc">Seq</span><span class="o">((</span><span class="s">"m1"</span><span class="o">,</span> <span class="n">rdd1</span><span class="o">,</span> <span class="n">rdd1Metadata</span><span class="o">),</span> <span class="o">(</span><span class="s">"m2"</span><span class="o">,</span> <span class="n">rdd2</span><span class="o">,</span> <span class="n">rdd2Metadata</span><span class="o">))).</span><span class="n">out</span><span class="o">(</span><span class="s">"s1"</span><span class="o">,</span> <span class="s">"s2"</span><span class="o">,</span> <span class="s">"message"</span><span class="o">)</span>
<span class="n">sumScript</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.Script</span> <span class="o">=</span>
<span class="nc">Inputs</span><span class="k">:</span>
  <span class="err">[1]</span> <span class="o">(</span><span class="kt">RDD</span><span class="o">)</span> <span class="kt">m1:</span> <span class="kt">ParallelCollectionRDD</span><span class="o">[</span><span class="err">42</span><span class="o">]</span> <span class="n">at</span> <span class="n">parallelize</span> <span class="n">at</span> <span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">38</span>
  <span class="o">[</span><span class="err">2</span><span class="o">]</span> <span class="o">(</span><span class="nc">RDD</span><span class="o">)</span> <span class="n">m2</span><span class="k">:</span> <span class="kt">ParallelCollectionRDD</span><span class="o">[</span><span class="err">43</span><span class="o">]</span> <span class="n">at</span> <span class="n">parallelize</span> <span class="n">at</span> <span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">38</span>

<span class="nc">Outputs</span><span class="k">:</span>
  <span class="err">[1]</span> <span class="kt">s1</span>
  <span class="o">[</span><span class="err">2</span><span class="o">]</span> <span class="n">s2</span>
  <span class="o">[</span><span class="err">3</span><span class="o">]</span> <span class="n">message</span>


<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="o">(</span><span class="n">firstSum</span><span class="o">,</span> <span class="n">secondSum</span><span class="o">,</span> <span class="n">sumMessage</span><span class="o">)</span> <span class="k">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">sumScript</span><span class="o">).</span><span class="n">getTuple</span><span class="o">[</span><span class="kt">Double</span>, <span class="kt">Double</span>, <span class="kt">String</span><span class="o">](</span><span class="s">"s1"</span><span class="o">,</span> <span class="s">"s2"</span><span class="o">,</span> <span class="s">"message"</span><span class="o">)</span>
<span class="n">firstSum</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">secondSum</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="mf">26.0</span>
<span class="n">sumMessage</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">s2</span> <span class="n">is</span> <span class="n">greater</span></code></pre></div>

  </div>

</div>

<p>The same inputs with metadata can be supplied by chaining <code>in</code> methods, as in the example below, which shows that <code>out</code> methods can also be
chained.</p>

<div class="codetabs">

<div data-lang="Scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">sumScript</span> <span class="k">=</span> <span class="n">dmlFromFile</span><span class="o">(</span><span class="s">"sums.dml"</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"m1"</span><span class="o">,</span> <span class="n">rdd1</span><span class="o">,</span> <span class="n">rdd1Metadata</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"m2"</span><span class="o">,</span> <span class="n">rdd2</span><span class="o">,</span> <span class="n">rdd2Metadata</span><span class="o">).</span><span class="n">out</span><span class="o">(</span><span class="s">"s1"</span><span class="o">).</span><span class="n">out</span><span class="o">(</span><span class="s">"s2"</span><span class="o">).</span><span class="n">out</span><span class="o">(</span><span class="s">"message"</span><span class="o">)</span>
<span class="k">val</span> <span class="o">(</span><span class="n">firstSum</span><span class="o">,</span> <span class="n">secondSum</span><span class="o">,</span> <span class="n">sumMessage</span><span class="o">)</span> <span class="k">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">sumScript</span><span class="o">).</span><span class="n">getTuple</span><span class="o">[</span><span class="kt">Double</span>, <span class="kt">Double</span>, <span class="kt">String</span><span class="o">](</span><span class="s">"s1"</span><span class="o">,</span> <span class="s">"s2"</span><span class="o">,</span> <span class="s">"message"</span><span class="o">)</span></code></pre></div>

  </div>

<div data-lang="Spark Shell">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">sumScript</span> <span class="k">=</span> <span class="n">dmlFromFile</span><span class="o">(</span><span class="s">"sums.dml"</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"m1"</span><span class="o">,</span> <span class="n">rdd1</span><span class="o">,</span> <span class="n">rdd1Metadata</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"m2"</span><span class="o">,</span> <span class="n">rdd2</span><span class="o">,</span> <span class="n">rdd2Metadata</span><span class="o">).</span><span class="n">out</span><span class="o">(</span><span class="s">"s1"</span><span class="o">).</span><span class="n">out</span><span class="o">(</span><span class="s">"s2"</span><span class="o">).</span><span class="n">out</span><span class="o">(</span><span class="s">"message"</span><span class="o">)</span>
<span class="n">sumScript</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.Script</span> <span class="o">=</span>
<span class="nc">Inputs</span><span class="k">:</span>
  <span class="err">[1]</span> <span class="o">(</span><span class="kt">RDD</span><span class="o">)</span> <span class="kt">m1:</span> <span class="kt">ParallelCollectionRDD</span><span class="o">[</span><span class="err">42</span><span class="o">]</span> <span class="n">at</span> <span class="n">parallelize</span> <span class="n">at</span> <span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">38</span>
  <span class="o">[</span><span class="err">2</span><span class="o">]</span> <span class="o">(</span><span class="nc">RDD</span><span class="o">)</span> <span class="n">m2</span><span class="k">:</span> <span class="kt">ParallelCollectionRDD</span><span class="o">[</span><span class="err">43</span><span class="o">]</span> <span class="n">at</span> <span class="n">parallelize</span> <span class="n">at</span> <span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">38</span>

<span class="nc">Outputs</span><span class="k">:</span>
  <span class="err">[1]</span> <span class="kt">s1</span>
  <span class="o">[</span><span class="err">2</span><span class="o">]</span> <span class="n">s2</span>
  <span class="o">[</span><span class="err">3</span><span class="o">]</span> <span class="n">message</span>


<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="o">(</span><span class="n">firstSum</span><span class="o">,</span> <span class="n">secondSum</span><span class="o">,</span> <span class="n">sumMessage</span><span class="o">)</span> <span class="k">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">sumScript</span><span class="o">).</span><span class="n">getTuple</span><span class="o">[</span><span class="kt">Double</span>, <span class="kt">Double</span>, <span class="kt">String</span><span class="o">](</span><span class="s">"s1"</span><span class="o">,</span> <span class="s">"s2"</span><span class="o">,</span> <span class="s">"message"</span><span class="o">)</span>
<span class="n">firstSum</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">secondSum</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="mf">26.0</span>
<span class="n">sumMessage</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">s2</span> <span class="n">is</span> <span class="n">greater</span></code></pre></div>

  </div>



<div data-lang="Python">

    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">sumScript</span> <span class="o">=</span> <span class="n">dmlFromFile</span><span class="p">(</span><span class="s">"sums.dml"</span><span class="p">)</span><span class="o">.</span><span class="nb">input</span><span class="p">(</span><span class="n">m1</span><span class="o">=</span><span class="n">rdd1</span><span class="p">)</span><span class="o">.</span><span class="nb">input</span><span class="p">(</span><span class="n">m2</span><span class="o">=</span> <span class="n">rdd2</span><span class="p">)</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="s">"s1"</span><span class="p">)</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="s">"s2"</span><span class="p">)</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="s">"message"</span><span class="p">)</span>
<span class="n">sumResults</span> <span class="o">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sumScript</span><span class="p">)</span>
<span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">message</span> <span class="o">=</span> <span class="n">sumResults</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"s1"</span><span class="p">,</span> <span class="s">"s2"</span><span class="p">,</span> <span class="s">"message"</span><span class="p">)</span></code></pre></div>

  </div>

<div data-lang="PySpark Shell">

    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">sumScript</span> <span class="o">=</span> <span class="n">dmlFromFile</span><span class="p">(</span><span class="s">"sums.dml"</span><span class="p">)</span><span class="o">.</span><span class="nb">input</span><span class="p">(</span><span class="n">m1</span><span class="o">=</span><span class="n">rdd1</span><span class="p">)</span><span class="o">.</span><span class="nb">input</span><span class="p">(</span><span class="n">m2</span><span class="o">=</span> <span class="n">rdd2</span><span class="p">)</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="s">"s1"</span><span class="p">)</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="s">"s2"</span><span class="p">)</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="s">"message"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sumResults</span> <span class="o">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sumScript</span><span class="p">)</span>
<span class="n">SystemML</span> <span class="n">Statistics</span><span class="p">:</span>
<span class="n">Total</span> <span class="n">execution</span> <span class="n">time</span><span class="p">:</span>           <span class="mf">1.057</span> <span class="n">sec</span><span class="o">.</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">executed</span> <span class="n">Spark</span> <span class="n">inst</span><span class="p">:</span>  <span class="mf">4.</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">message</span> <span class="o">=</span> <span class="n">sumResults</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"s1"</span><span class="p">,</span> <span class="s">"s2"</span><span class="p">,</span> <span class="s">"message"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s1</span>
<span class="mf">10.0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s2</span>
<span class="mf">26.0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">message</span>
<span class="s">u's2 is greater'</span></code></pre></div>

  </div>

</div>

<h2 id="matrix-output">Matrix Output</h2>

<p>Let&#8217;s look at an example of reading a matrix out of SystemML. We&#8217;ll create a DML script
in which we create a 2x2 matrix <code>m</code>. We&#8217;ll set the variable <code>n</code> to be the sum of the cells in the matrix.</p>

<p>We create a script object using String <code>s</code>, and we set <code>m</code> and <code>n</code> as the outputs. We execute the script, and in
the results we see we have Matrix <code>m</code> and Double <code>n</code>. The <code>n</code> output variable has a value of <code>110.0</code>.</p>

<p>We get Matrix <code>m</code> and Double <code>n</code> as a Tuple of values <code>x</code> and <code>y</code>.</p>

<p>In Scala, we then convert Matrix <code>m</code> to an RDD of IJV values, an RDD of CSV values, a DataFrame, and a two-dimensional Double Array, and we display
the values in each of these data structures.</p>

<p>In Python, we use the methods <code>toDF()</code> and <code>toNumPy()</code> to get the matrix as PySpark DataFrame or NumPy array respectively.</p>

<div class="codetabs">

<div data-lang="Scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">s</span> <span class="k">=</span>
<span class="s">"""
m = matrix("11 22 33 44", rows=2, cols=2)
n = sum(m)
"""</span>
<span class="k">val</span> <span class="n">scr</span> <span class="k">=</span> <span class="n">dml</span><span class="o">(</span><span class="n">s</span><span class="o">).</span><span class="n">out</span><span class="o">(</span><span class="s">"m"</span><span class="o">,</span> <span class="s">"n"</span><span class="o">);</span>
<span class="k">val</span> <span class="n">res</span> <span class="k">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">scr</span><span class="o">)</span>
<span class="k">val</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">)</span> <span class="k">=</span> <span class="n">res</span><span class="o">.</span><span class="n">getTuple</span><span class="o">[</span><span class="kt">Matrix</span>, <span class="kt">Double</span><span class="o">](</span><span class="s">"m"</span><span class="o">,</span> <span class="s">"n"</span><span class="o">)</span>
<span class="n">x</span><span class="o">.</span><span class="n">toRDDStringIJV</span><span class="o">.</span><span class="n">collect</span><span class="o">.</span><span class="n">foreach</span><span class="o">(</span><span class="n">println</span><span class="o">)</span>
<span class="n">x</span><span class="o">.</span><span class="n">toRDDStringCSV</span><span class="o">.</span><span class="n">collect</span><span class="o">.</span><span class="n">foreach</span><span class="o">(</span><span class="n">println</span><span class="o">)</span>
<span class="n">x</span><span class="o">.</span><span class="n">toDF</span><span class="o">.</span><span class="n">collect</span><span class="o">.</span><span class="n">foreach</span><span class="o">(</span><span class="n">println</span><span class="o">)</span>
<span class="n">x</span><span class="o">.</span><span class="n">to2DDoubleArray</span></code></pre></div>

  </div>

<div data-lang="Spark Shell">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">s</span> <span class="k">=</span>
     <span class="o">|</span> <span class="s">"""
     | m = matrix("11 22 33 44", rows=2, cols=2)
     | n = sum(m)
     | """</span>
<span class="n">s</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span>
<span class="s">"
m = matrix("</span><span class="mi">11</span> <span class="mi">22</span> <span class="mi">33</span> <span class="mi">44</span><span class="s">", rows=2, cols=2)
n = sum(m)
"</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">scr</span> <span class="k">=</span> <span class="n">dml</span><span class="o">(</span><span class="n">s</span><span class="o">).</span><span class="n">out</span><span class="o">(</span><span class="s">"m"</span><span class="o">,</span> <span class="s">"n"</span><span class="o">);</span>
<span class="n">scr</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.Script</span> <span class="o">=</span>
<span class="nc">Inputs</span><span class="k">:</span>
<span class="kt">None</span>

<span class="nc">Outputs</span><span class="k">:</span>
  <span class="err">[1]</span> <span class="kt">m</span>
  <span class="o">[</span><span class="err">2</span><span class="o">]</span> <span class="n">n</span>


<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">res</span> <span class="k">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">scr</span><span class="o">)</span>
<span class="n">res</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.MLResults</span> <span class="o">=</span>
  <span class="o">[</span><span class="err">1</span><span class="o">]</span> <span class="o">(</span><span class="nc">Matrix</span><span class="o">)</span> <span class="n">m</span><span class="k">:</span> <span class="kt">Matrix:</span> <span class="kt">scratch_space</span><span class="c1">//_p12059_9.31.117.12//_t0/temp26_14, [2 x 2, nnz=4, blocks (1000 x 1000)], binaryblock, dirty
</span>  <span class="o">[</span><span class="err">2</span><span class="o">]</span> <span class="o">(</span><span class="nc">Double</span><span class="o">)</span> <span class="n">n</span><span class="k">:</span> <span class="err">110</span><span class="kt">.</span><span class="err">0</span>


<span class="kt">scala&gt;</span> <span class="kt">val</span> <span class="o">(</span><span class="kt">x</span><span class="o">,</span> <span class="kt">y</span><span class="o">)</span> <span class="k">=</span> <span class="n">res</span><span class="o">.</span><span class="n">getTuple</span><span class="o">[</span><span class="kt">Matrix</span>, <span class="kt">Double</span><span class="o">](</span><span class="s">"m"</span><span class="o">,</span> <span class="s">"n"</span><span class="o">)</span>
<span class="n">x</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.Matrix</span> <span class="o">=</span> <span class="nc">Matrix</span><span class="k">:</span> <span class="kt">scratch_space</span><span class="c1">//_p12059_9.31.117.12//_t0/temp26_14, [2 x 2, nnz=4, blocks (1000 x 1000)], binaryblock, dirty
</span><span class="n">y</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="mf">110.0</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">x</span><span class="o">.</span><span class="n">toRDDStringIJV</span><span class="o">.</span><span class="n">collect</span><span class="o">.</span><span class="n">foreach</span><span class="o">(</span><span class="n">println</span><span class="o">)</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mf">11.0</span>
<span class="mi">1</span> <span class="mi">2</span> <span class="mf">22.0</span>
<span class="mi">2</span> <span class="mi">1</span> <span class="mf">33.0</span>
<span class="mi">2</span> <span class="mi">2</span> <span class="mf">44.0</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">x</span><span class="o">.</span><span class="n">toRDDStringCSV</span><span class="o">.</span><span class="n">collect</span><span class="o">.</span><span class="n">foreach</span><span class="o">(</span><span class="n">println</span><span class="o">)</span>
<span class="mf">11.0</span><span class="o">,</span><span class="mf">22.0</span>
<span class="mf">33.0</span><span class="o">,</span><span class="mf">44.0</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">x</span><span class="o">.</span><span class="n">toDF</span><span class="o">.</span><span class="n">collect</span><span class="o">.</span><span class="n">foreach</span><span class="o">(</span><span class="n">println</span><span class="o">)</span>
<span class="o">[</span><span class="err">0</span><span class="kt">.</span><span class="err">0</span>,<span class="err">11</span><span class="kt">.</span><span class="err">0</span>,<span class="err">22</span><span class="kt">.</span><span class="err">0</span><span class="o">]</span>
<span class="o">[</span><span class="err">1</span><span class="kt">.</span><span class="err">0</span>,<span class="err">33</span><span class="kt">.</span><span class="err">0</span>,<span class="err">44</span><span class="kt">.</span><span class="err">0</span><span class="o">]</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">x</span><span class="o">.</span><span class="n">to2DDoubleArray</span>
<span class="n">res10</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">Array</span><span class="o">[</span><span class="kt">Double</span><span class="o">]]</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="nc">Array</span><span class="o">(</span><span class="mf">11.0</span><span class="o">,</span> <span class="mf">22.0</span><span class="o">),</span> <span class="nc">Array</span><span class="o">(</span><span class="mf">33.0</span><span class="o">,</span> <span class="mf">44.0</span><span class="o">))</span></code></pre></div>

  </div>

<div data-lang="Python">

    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">s</span> <span class="o">=</span> <span class="s">"""
m = matrix("11 22 33 44", rows=2, cols=2)
n = sum(m)
"""</span>
<span class="n">scr</span> <span class="o">=</span> <span class="n">dml</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="s">"m"</span><span class="p">,</span> <span class="s">"n"</span><span class="p">);</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">scr</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"m"</span><span class="p">,</span> <span class="s">"n"</span><span class="p">)</span>
<span class="n">x</span><span class="o">.</span><span class="n">toDF</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">x</span><span class="o">.</span><span class="n">toNumPy</span><span class="p">()</span></code></pre></div>

  </div>

<div data-lang="PySpark Shell">

    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">s</span> <span class="o">=</span> <span class="s">"""
... m = matrix("11 22 33 44", rows=2, cols=2)
... n = sum(m)
... """</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">scr</span> <span class="o">=</span> <span class="n">dml</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="s">"m"</span><span class="p">,</span> <span class="s">"n"</span><span class="p">);</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">res</span> <span class="o">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">scr</span><span class="p">)</span>
<span class="n">SystemML</span> <span class="n">Statistics</span><span class="p">:</span>
<span class="n">Total</span> <span class="n">execution</span> <span class="n">time</span><span class="p">:</span>           <span class="mf">0.000</span> <span class="n">sec</span><span class="o">.</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">executed</span> <span class="n">Spark</span> <span class="n">inst</span><span class="p">:</span>  <span class="mf">0.</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"m"</span><span class="p">,</span> <span class="s">"n"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span>
<span class="n">Matrix</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y</span>
<span class="mf">110.0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span><span class="o">.</span><span class="n">toDF</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-------+----+----+</span>
<span class="o">|</span><span class="n">__INDEX</span><span class="o">|</span>  <span class="n">C1</span><span class="o">|</span>  <span class="n">C2</span><span class="o">|</span>
<span class="o">+-------+----+----+</span>
<span class="o">|</span>    <span class="mf">1.0</span><span class="o">|</span><span class="mf">11.0</span><span class="o">|</span><span class="mf">22.0</span><span class="o">|</span>
<span class="o">|</span>    <span class="mf">2.0</span><span class="o">|</span><span class="mf">33.0</span><span class="o">|</span><span class="mf">44.0</span><span class="o">|</span>
<span class="o">+-------+----+----+</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span><span class="o">.</span><span class="n">toNumPy</span><span class="p">()</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">11.</span><span class="p">,</span>  <span class="mf">22.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">33.</span><span class="p">,</span>  <span class="mf">44.</span><span class="p">]])</span></code></pre></div>

  </div>

</div>

<h2 id="univariate-statistics-on-haberman-data">Univariate Statistics on Haberman Data</h2>

<p>Our next example will involve Haberman&#8217;s Survival Data Set in CSV format from the Center for Machine Learning
and Intelligent Systems. We will run the SystemML Univariate Statistics (&#8220;Univar-Stats.dml&#8221;) script on this
data.</p>

<p>We&#8217;ll pull the data from a URL and convert it to an RDD, <code>habermanRDD</code>. Next, we&#8217;ll create metadata, <code>habermanMetadata</code>,
stating that the matrix consists of 306 rows and 4 columns.</p>

<p>As we can see from the comments in the script
<a href="https://raw.githubusercontent.com/apache/systemml/master/scripts/algorithms/Univar-Stats.dml">here</a>, the
script requires a &#8216;TYPES&#8217; input matrix that lists the types of the features (1 for scale, 2 for nominal, 3 for
ordinal), so we create a <code>typesRDD</code> matrix consisting of 1 row and 4 columns, with corresponding metadata, <code>typesMetadata</code>.</p>

<p>Next, we create the DML script object called <code>uni</code> using ScriptFactory&#8217;s <code>dmlFromUrl</code> method, specifying the GitHub URL where the
DML script is located. We bind the <code>habermanRDD</code> matrix to the <code>A</code> variable in <code>Univar-Stats.dml</code>, and we bind
the <code>typesRDD</code> matrix to the <code>K</code> variable. In addition, we supply a <code>$CONSOLE_OUTPUT</code> parameter with a Boolean value
of <code>true</code>, which indicates that we&#8217;d like to output labeled results to the console. We&#8217;ll explain why we bind to the <code>A</code> and <code>K</code>
variables in the <a href="spark-mlcontext-programming-guide.html#input-variables-vs-input-parameters">Input Variables vs Input Parameters</a>
section below.</p>

<div class="codetabs">

<div data-lang="Scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">habermanUrl</span> <span class="k">=</span> <span class="s">"http://archive.ics.uci.edu/ml/machine-learning-databases/haberman/haberman.data"</span>
<span class="k">val</span> <span class="n">habermanList</span> <span class="k">=</span> <span class="n">scala</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="nc">Source</span><span class="o">.</span><span class="n">fromURL</span><span class="o">(</span><span class="n">habermanUrl</span><span class="o">).</span><span class="n">mkString</span><span class="o">.</span><span class="n">split</span><span class="o">(</span><span class="s">"\n"</span><span class="o">)</span>
<span class="k">val</span> <span class="n">habermanRDD</span> <span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="o">(</span><span class="n">habermanList</span><span class="o">)</span>
<span class="k">val</span> <span class="n">habermanMetadata</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MatrixMetadata</span><span class="o">(</span><span class="mi">306</span><span class="o">,</span> <span class="mi">4</span><span class="o">)</span>
<span class="k">val</span> <span class="n">typesRDD</span> <span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="o">(</span><span class="nc">Array</span><span class="o">(</span><span class="s">"1.0,1.0,1.0,2.0"</span><span class="o">))</span>
<span class="k">val</span> <span class="n">typesMetadata</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MatrixMetadata</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">4</span><span class="o">)</span>
<span class="k">val</span> <span class="n">scriptUrl</span> <span class="k">=</span> <span class="s">"https://raw.githubusercontent.com/apache/systemml/master/scripts/algorithms/Univar-Stats.dml"</span>
<span class="k">val</span> <span class="n">uni</span> <span class="k">=</span> <span class="n">dmlFromUrl</span><span class="o">(</span><span class="n">scriptUrl</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"A"</span><span class="o">,</span> <span class="n">habermanRDD</span><span class="o">,</span> <span class="n">habermanMetadata</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"K"</span><span class="o">,</span> <span class="n">typesRDD</span><span class="o">,</span> <span class="n">typesMetadata</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"$CONSOLE_OUTPUT"</span><span class="o">,</span> <span class="kc">true</span><span class="o">)</span>
<span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">uni</span><span class="o">)</span></code></pre></div>

  </div>

<div data-lang="Spark Shell">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">habermanUrl</span> <span class="k">=</span> <span class="s">"http://archive.ics.uci.edu/ml/machine-learning-databases/haberman/haberman.data"</span>
<span class="n">habermanUrl</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">http</span><span class="o">://</span><span class="n">archive</span><span class="o">.</span><span class="n">ics</span><span class="o">.</span><span class="n">uci</span><span class="o">.</span><span class="n">edu</span><span class="o">/</span><span class="n">ml</span><span class="o">/</span><span class="n">machine</span><span class="o">-</span><span class="n">learning</span><span class="o">-</span><span class="n">databases</span><span class="o">/</span><span class="n">haberman</span><span class="o">/</span><span class="n">haberman</span><span class="o">.</span><span class="n">data</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">habermanList</span> <span class="k">=</span> <span class="n">scala</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="nc">Source</span><span class="o">.</span><span class="n">fromURL</span><span class="o">(</span><span class="n">habermanUrl</span><span class="o">).</span><span class="n">mkString</span><span class="o">.</span><span class="n">split</span><span class="o">(</span><span class="s">"\n"</span><span class="o">)</span>
<span class="n">habermanList</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="mi">30</span><span class="o">,</span><span class="mi">64</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">30</span><span class="o">,</span><span class="mi">62</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">30</span><span class="o">,</span><span class="mi">65</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">31</span><span class="o">,</span><span class="mi">59</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">31</span><span class="o">,</span><span class="mi">65</span><span class="o">,</span><span class="mi">4</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">33</span><span class="o">,</span><span class="mi">58</span><span class="o">,</span><span class="mi">10</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">33</span><span class="o">,</span><span class="mi">60</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">34</span><span class="o">,</span><span class="mi">59</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span> <span class="mi">34</span><span class="o">,</span><span class="mi">66</span><span class="o">,</span><span class="mi">9</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span> <span class="mi">34</span><span class="o">,</span><span class="mi">58</span><span class="o">,</span><span class="mi">30</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">34</span><span class="o">,</span><span class="mi">60</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">34</span><span class="o">,</span><span class="mi">61</span><span class="o">,</span><span class="mi">10</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">34</span><span class="o">,</span><span class="mi">67</span><span class="o">,</span><span class="mi">7</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">34</span><span class="o">,</span><span class="mi">60</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">35</span><span class="o">,</span><span class="mi">64</span><span class="o">,</span><span class="mi">13</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">35</span><span class="o">,</span><span class="mi">63</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">36</span><span class="o">,</span><span class="mi">60</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">36</span><span class="o">,</span><span class="mi">69</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">37</span><span class="o">,</span><span class="mi">60</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">37</span><span class="o">,</span><span class="mi">63</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">37</span><span class="o">,</span><span class="mi">58</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">37</span><span class="o">,</span><span class="mi">59</span><span class="o">,</span><span class="mi">6</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">37</span><span class="o">,</span><span class="mi">60</span><span class="o">,</span><span class="mi">15</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">37</span><span class="o">,</span><span class="mi">63</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">38</span><span class="o">,</span><span class="mi">69</span><span class="o">,</span><span class="mi">21</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span> <span class="mi">38</span><span class="o">,</span><span class="mi">59</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">38</span><span class="o">,</span><span class="mi">60</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">38</span><span class="o">,</span><span class="mi">60</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">38</span><span class="o">,</span><span class="mi">62</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">38</span><span class="o">,</span><span class="mi">64</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">38</span><span class="o">,</span><span class="mi">66</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">38</span><span class="o">,</span><span class="mi">66</span><span class="o">,</span><span class="mi">11</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">38</span><span class="o">,</span><span class="mi">60</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">38</span><span class="o">,</span><span class="mi">67</span><span class="o">,</span><span class="mi">5</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">39</span><span class="o">,</span><span class="mi">66</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span> <span class="mi">39</span><span class="o">,</span><span class="mi">63</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">39</span><span class="o">,</span><span class="mi">67</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">39</span><span class="o">,</span><span class="mi">58</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">39</span><span class="o">,</span><span class="mi">59</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">39</span><span class="o">,</span><span class="mi">63</span><span class="o">,</span><span class="mi">4</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">40</span><span class="o">,</span><span class="mi">58</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">40</span><span class="o">,</span><span class="mi">58</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">40</span><span class="o">,</span><span class="mi">65</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">41</span><span class="o">,</span><span class="mi">60</span><span class="o">,</span><span class="mi">23</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span> <span class="mi">41</span><span class="o">,</span><span class="mi">64</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span> <span class="mi">41</span><span class="o">,</span><span class="mi">67</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span> <span class="mi">41</span><span class="o">,</span><span class="mi">58</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">41</span><span class="o">,</span><span class="mi">59</span><span class="o">,</span><span class="mi">8</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">41</span><span class="o">,</span><span class="mi">59</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">41</span><span class="o">,</span><span class="mi">64</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">41</span><span class="o">,</span><span class="mi">69</span><span class="o">,</span><span class="mi">8</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">41</span><span class="o">,</span><span class="mi">65</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">41</span><span class="o">,</span><span class="mi">65</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">42</span><span class="o">,</span><span class="mi">69</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span> <span class="mi">42</span><span class="o">,</span><span class="mi">59</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span> <span class="mi">42</span><span class="o">,</span><span class="mi">58</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">42</span><span class="o">,</span><span class="mi">60</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">42</span><span class="o">,</span><span class="mi">59</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">42</span><span class="o">,</span><span class="mi">61</span><span class="o">,</span><span class="mi">4</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">42</span><span class="o">,</span><span class="mi">62</span><span class="o">,</span><span class="mi">20</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">42</span><span class="o">,</span><span class="mi">65</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">42</span><span class="o">,</span><span class="mi">63</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">43</span><span class="o">,</span><span class="mi">58</span><span class="o">,</span><span class="mi">52</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span> <span class="mi">43</span><span class="o">,</span><span class="mi">59</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span> <span class="mi">43</span><span class="o">,</span><span class="mi">64</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span> <span class="mi">43</span><span class="o">,</span><span class="mi">64</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span> <span class="mi">43</span><span class="o">,</span><span class="mi">63</span><span class="o">,</span><span class="mi">14</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mi">43</span><span class="o">,</span><span class="mi">64</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span> <span class="mf">43.</span><span class="o">..</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">habermanRDD</span> <span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="o">(</span><span class="n">habermanList</span><span class="o">)</span>
<span class="n">habermanRDD</span><span class="k">:</span> <span class="kt">org.apache.spark.rdd.RDD</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">ParallelCollectionRDD</span><span class="o">[</span><span class="err">159</span><span class="o">]</span> <span class="n">at</span> <span class="n">parallelize</span> <span class="n">at</span> <span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">43</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">habermanMetadata</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MatrixMetadata</span><span class="o">(</span><span class="mi">306</span><span class="o">,</span> <span class="mi">4</span><span class="o">)</span>
<span class="n">habermanMetadata</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.MatrixMetadata</span> <span class="o">=</span> <span class="n">rows</span><span class="k">:</span> <span class="err">306</span><span class="o">,</span> <span class="n">columns</span><span class="k">:</span> <span class="err">4</span><span class="o">,</span> <span class="n">non</span><span class="o">-</span><span class="n">zeros</span><span class="k">:</span> <span class="kt">None</span><span class="o">,</span> <span class="n">rows</span> <span class="n">per</span> <span class="n">block</span><span class="k">:</span> <span class="kt">None</span><span class="o">,</span> <span class="n">columns</span> <span class="n">per</span> <span class="n">block</span><span class="k">:</span> <span class="kt">None</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">typesRDD</span> <span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="o">(</span><span class="nc">Array</span><span class="o">(</span><span class="s">"1.0,1.0,1.0,2.0"</span><span class="o">))</span>
<span class="n">typesRDD</span><span class="k">:</span> <span class="kt">org.apache.spark.rdd.RDD</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">ParallelCollectionRDD</span><span class="o">[</span><span class="err">160</span><span class="o">]</span> <span class="n">at</span> <span class="n">parallelize</span> <span class="n">at</span> <span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">39</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">typesMetadata</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MatrixMetadata</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">4</span><span class="o">)</span>
<span class="n">typesMetadata</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.MatrixMetadata</span> <span class="o">=</span> <span class="n">rows</span><span class="k">:</span> <span class="err">1</span><span class="o">,</span> <span class="n">columns</span><span class="k">:</span> <span class="err">4</span><span class="o">,</span> <span class="n">non</span><span class="o">-</span><span class="n">zeros</span><span class="k">:</span> <span class="kt">None</span><span class="o">,</span> <span class="n">rows</span> <span class="n">per</span> <span class="n">block</span><span class="k">:</span> <span class="kt">None</span><span class="o">,</span> <span class="n">columns</span> <span class="n">per</span> <span class="n">block</span><span class="k">:</span> <span class="kt">None</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">scriptUrl</span> <span class="k">=</span> <span class="s">"https://raw.githubusercontent.com/apache/systemml/master/scripts/algorithms/Univar-Stats.dml"</span>
<span class="n">scriptUrl</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">https</span><span class="o">://</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">apache</span><span class="o">/</span><span class="n">systemml</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">algorithms</span><span class="o">/</span><span class="nc">Univar</span><span class="o">-</span><span class="nc">Stats</span><span class="o">.</span><span class="n">dml</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">uni</span> <span class="k">=</span> <span class="n">dmlFromUrl</span><span class="o">(</span><span class="n">scriptUrl</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"A"</span><span class="o">,</span> <span class="n">habermanRDD</span><span class="o">,</span> <span class="n">habermanMetadata</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"K"</span><span class="o">,</span> <span class="n">typesRDD</span><span class="o">,</span> <span class="n">typesMetadata</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"$CONSOLE_OUTPUT"</span><span class="o">,</span> <span class="kc">true</span><span class="o">)</span>
<span class="n">uni</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.Script</span> <span class="o">=</span>
<span class="nc">Inputs</span><span class="k">:</span>
  <span class="err">[1]</span> <span class="o">(</span><span class="kt">RDD</span><span class="o">)</span> <span class="kt">A:</span> <span class="kt">ParallelCollectionRDD</span><span class="o">[</span><span class="err">159</span><span class="o">]</span> <span class="n">at</span> <span class="n">parallelize</span> <span class="n">at</span> <span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">43</span>
  <span class="o">[</span><span class="err">2</span><span class="o">]</span> <span class="o">(</span><span class="nc">RDD</span><span class="o">)</span> <span class="n">K</span><span class="k">:</span> <span class="kt">ParallelCollectionRDD</span><span class="o">[</span><span class="err">160</span><span class="o">]</span> <span class="n">at</span> <span class="n">parallelize</span> <span class="n">at</span> <span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">39</span>
  <span class="o">[</span><span class="err">3</span><span class="o">]</span> <span class="o">(</span><span class="nc">Boolean</span><span class="o">)</span> <span class="nc">$CONSOLE_OUTPUT</span><span class="k">:</span> <span class="kt">true</span>

<span class="nc">Outputs</span><span class="k">:</span>
<span class="kt">None</span>


<span class="n">scala</span><span class="o">&gt;</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">uni</span><span class="o">)</span>
<span class="o">...</span>
<span class="o">-------------------------------------------------</span>
<span class="nc">Feature</span> <span class="o">[</span><span class="err">1</span><span class="o">]</span><span class="k">:</span> <span class="kt">Scale</span>
 <span class="o">(</span><span class="mi">01</span><span class="o">)</span> <span class="nc">Minimum</span>             <span class="o">|</span> <span class="mf">30.0</span>
 <span class="o">(</span><span class="mi">02</span><span class="o">)</span> <span class="nc">Maximum</span>             <span class="o">|</span> <span class="mf">83.0</span>
 <span class="o">(</span><span class="mi">03</span><span class="o">)</span> <span class="nc">Range</span>               <span class="o">|</span> <span class="mf">53.0</span>
 <span class="o">(</span><span class="mi">04</span><span class="o">)</span> <span class="nc">Mean</span>                <span class="o">|</span> <span class="mf">52.45751633986928</span>
 <span class="o">(</span><span class="mi">05</span><span class="o">)</span> <span class="nc">Variance</span>            <span class="o">|</span> <span class="mf">116.71458266366658</span>
 <span class="o">(</span><span class="mi">06</span><span class="o">)</span> <span class="nc">Std</span> <span class="n">deviation</span>       <span class="o">|</span> <span class="mf">10.803452349303281</span>
 <span class="o">(</span><span class="mi">07</span><span class="o">)</span> <span class="nc">Std</span> <span class="n">err</span> <span class="n">of</span> <span class="n">mean</span>     <span class="o">|</span> <span class="mf">0.6175922641866753</span>
 <span class="o">(</span><span class="mi">08</span><span class="o">)</span> <span class="nc">Coeff</span> <span class="n">of</span> <span class="n">variation</span>  <span class="o">|</span> <span class="mf">0.20594669940735139</span>
 <span class="o">(</span><span class="mi">09</span><span class="o">)</span> <span class="nc">Skewness</span>            <span class="o">|</span> <span class="mf">0.1450718616532357</span>
 <span class="o">(</span><span class="mi">10</span><span class="o">)</span> <span class="nc">Kurtosis</span>            <span class="o">|</span> <span class="o">-</span><span class="mf">0.6150152487211726</span>
 <span class="o">(</span><span class="mi">11</span><span class="o">)</span> <span class="nc">Std</span> <span class="n">err</span> <span class="n">of</span> <span class="n">skewness</span> <span class="o">|</span> <span class="mf">0.13934809593495995</span>
 <span class="o">(</span><span class="mi">12</span><span class="o">)</span> <span class="nc">Std</span> <span class="n">err</span> <span class="n">of</span> <span class="n">kurtosis</span> <span class="o">|</span> <span class="mf">0.277810485320835</span>
 <span class="o">(</span><span class="mi">13</span><span class="o">)</span> <span class="nc">Median</span>              <span class="o">|</span> <span class="mf">52.0</span>
 <span class="o">(</span><span class="mi">14</span><span class="o">)</span> <span class="nc">Interquartile</span> <span class="n">mean</span>  <span class="o">|</span> <span class="mf">52.16013071895425</span>
<span class="o">-------------------------------------------------</span>
<span class="nc">Feature</span> <span class="o">[</span><span class="err">2</span><span class="o">]</span><span class="k">:</span> <span class="kt">Scale</span>
 <span class="o">(</span><span class="mi">01</span><span class="o">)</span> <span class="nc">Minimum</span>             <span class="o">|</span> <span class="mf">58.0</span>
 <span class="o">(</span><span class="mi">02</span><span class="o">)</span> <span class="nc">Maximum</span>             <span class="o">|</span> <span class="mf">69.0</span>
 <span class="o">(</span><span class="mi">03</span><span class="o">)</span> <span class="nc">Range</span>               <span class="o">|</span> <span class="mf">11.0</span>
 <span class="o">(</span><span class="mi">04</span><span class="o">)</span> <span class="nc">Mean</span>                <span class="o">|</span> <span class="mf">62.85294117647059</span>
 <span class="o">(</span><span class="mi">05</span><span class="o">)</span> <span class="nc">Variance</span>            <span class="o">|</span> <span class="mf">10.558630665380907</span>
 <span class="o">(</span><span class="mi">06</span><span class="o">)</span> <span class="nc">Std</span> <span class="n">deviation</span>       <span class="o">|</span> <span class="mf">3.2494046632238507</span>
 <span class="o">(</span><span class="mi">07</span><span class="o">)</span> <span class="nc">Std</span> <span class="n">err</span> <span class="n">of</span> <span class="n">mean</span>     <span class="o">|</span> <span class="mf">0.18575610076612029</span>
 <span class="o">(</span><span class="mi">08</span><span class="o">)</span> <span class="nc">Coeff</span> <span class="n">of</span> <span class="n">variation</span>  <span class="o">|</span> <span class="mf">0.051698529971741194</span>
 <span class="o">(</span><span class="mi">09</span><span class="o">)</span> <span class="nc">Skewness</span>            <span class="o">|</span> <span class="mf">0.07798443581479181</span>
 <span class="o">(</span><span class="mi">10</span><span class="o">)</span> <span class="nc">Kurtosis</span>            <span class="o">|</span> <span class="o">-</span><span class="mf">1.1324380182967442</span>
 <span class="o">(</span><span class="mi">11</span><span class="o">)</span> <span class="nc">Std</span> <span class="n">err</span> <span class="n">of</span> <span class="n">skewness</span> <span class="o">|</span> <span class="mf">0.13934809593495995</span>
 <span class="o">(</span><span class="mi">12</span><span class="o">)</span> <span class="nc">Std</span> <span class="n">err</span> <span class="n">of</span> <span class="n">kurtosis</span> <span class="o">|</span> <span class="mf">0.277810485320835</span>
 <span class="o">(</span><span class="mi">13</span><span class="o">)</span> <span class="nc">Median</span>              <span class="o">|</span> <span class="mf">63.0</span>
 <span class="o">(</span><span class="mi">14</span><span class="o">)</span> <span class="nc">Interquartile</span> <span class="n">mean</span>  <span class="o">|</span> <span class="mf">62.80392156862745</span>
<span class="o">-------------------------------------------------</span>
<span class="nc">Feature</span> <span class="o">[</span><span class="err">3</span><span class="o">]</span><span class="k">:</span> <span class="kt">Scale</span>
 <span class="o">(</span><span class="mi">01</span><span class="o">)</span> <span class="nc">Minimum</span>             <span class="o">|</span> <span class="mf">0.0</span>
 <span class="o">(</span><span class="mi">02</span><span class="o">)</span> <span class="nc">Maximum</span>             <span class="o">|</span> <span class="mf">52.0</span>
 <span class="o">(</span><span class="mi">03</span><span class="o">)</span> <span class="nc">Range</span>               <span class="o">|</span> <span class="mf">52.0</span>
 <span class="o">(</span><span class="mi">04</span><span class="o">)</span> <span class="nc">Mean</span>                <span class="o">|</span> <span class="mf">4.026143790849673</span>
 <span class="o">(</span><span class="mi">05</span><span class="o">)</span> <span class="nc">Variance</span>            <span class="o">|</span> <span class="mf">51.691117539912135</span>
 <span class="o">(</span><span class="mi">06</span><span class="o">)</span> <span class="nc">Std</span> <span class="n">deviation</span>       <span class="o">|</span> <span class="mf">7.189653506248555</span>
 <span class="o">(</span><span class="mi">07</span><span class="o">)</span> <span class="nc">Std</span> <span class="n">err</span> <span class="n">of</span> <span class="n">mean</span>     <span class="o">|</span> <span class="mf">0.41100513466216837</span>
 <span class="o">(</span><span class="mi">08</span><span class="o">)</span> <span class="nc">Coeff</span> <span class="n">of</span> <span class="n">variation</span>  <span class="o">|</span> <span class="mf">1.7857418611299172</span>
 <span class="o">(</span><span class="mi">09</span><span class="o">)</span> <span class="nc">Skewness</span>            <span class="o">|</span> <span class="mf">2.954633471088322</span>
 <span class="o">(</span><span class="mi">10</span><span class="o">)</span> <span class="nc">Kurtosis</span>            <span class="o">|</span> <span class="mf">11.425776549251449</span>
 <span class="o">(</span><span class="mi">11</span><span class="o">)</span> <span class="nc">Std</span> <span class="n">err</span> <span class="n">of</span> <span class="n">skewness</span> <span class="o">|</span> <span class="mf">0.13934809593495995</span>
 <span class="o">(</span><span class="mi">12</span><span class="o">)</span> <span class="nc">Std</span> <span class="n">err</span> <span class="n">of</span> <span class="n">kurtosis</span> <span class="o">|</span> <span class="mf">0.277810485320835</span>
 <span class="o">(</span><span class="mi">13</span><span class="o">)</span> <span class="nc">Median</span>              <span class="o">|</span> <span class="mf">1.0</span>
 <span class="o">(</span><span class="mi">14</span><span class="o">)</span> <span class="nc">Interquartile</span> <span class="n">mean</span>  <span class="o">|</span> <span class="mf">1.2483660130718954</span>
<span class="o">-------------------------------------------------</span>
<span class="nc">Feature</span> <span class="o">[</span><span class="err">4</span><span class="o">]</span><span class="k">:</span> <span class="kt">Categorical</span> <span class="o">(</span><span class="kt">Nominal</span><span class="o">)</span>
 <span class="o">(</span><span class="err">15</span><span class="o">)</span> <span class="kt">Num</span> <span class="kt">of</span> <span class="kt">categories</span>   <span class="kt">|</span> <span class="err">2</span>
 <span class="o">(</span><span class="err">16</span><span class="o">)</span> <span class="kt">Mode</span>                <span class="kt">|</span> <span class="err">1</span>
 <span class="o">(</span><span class="err">17</span><span class="o">)</span> <span class="kt">Num</span> <span class="kt">of</span> <span class="kt">modes</span>        <span class="kt">|</span> <span class="err">1</span>
<span class="kt">res23:</span> <span class="kt">org.apache.sysml.api.mlcontext.MLResults</span> <span class="o">=</span>
<span class="nc">None</span></code></pre></div>

  </div>

<div data-lang="Python">

    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">habermanUrl</span> <span class="o">=</span> <span class="s">"http://archive.ics.uci.edu/ml/machine-learning-databases/haberman/haberman.data"</span>
<span class="kn">import</span> <span class="nn">urllib</span>
<span class="n">urllib</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">habermanUrl</span><span class="p">,</span> <span class="s">"haberman.data"</span><span class="p">)</span>
<span class="n">habermanList</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="s">"haberman.data"</span><span class="p">)]</span>
<span class="n">habermanRDD</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="n">habermanList</span><span class="p">)</span>
<span class="n">typesRDD</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="s">"1.0,1.0,1.0,2.0"</span><span class="p">])</span>
<span class="n">scriptUrl</span> <span class="o">=</span> <span class="s">"https://raw.githubusercontent.com/apache/systemml/master/scripts/algorithms/Univar-Stats.dml"</span>
<span class="n">uni</span> <span class="o">=</span> <span class="n">dmlFromUrl</span><span class="p">(</span><span class="n">scriptUrl</span><span class="p">)</span><span class="o">.</span><span class="nb">input</span><span class="p">(</span><span class="n">A</span><span class="o">=</span><span class="n">habermanRDD</span><span class="p">,</span> <span class="n">K</span><span class="o">=</span><span class="n">typesRDD</span><span class="p">)</span><span class="o">.</span><span class="nb">input</span><span class="p">(</span><span class="s">"$CONSOLE_OUTPUT"</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">uni</span><span class="p">)</span></code></pre></div>

  </div>

<div data-lang="PySpark Shell">

    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">habermanUrl</span> <span class="o">=</span> <span class="s">"http://archive.ics.uci.edu/ml/machine-learning-databases/haberman/haberman.data"</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">urllib</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">urllib</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">habermanUrl</span><span class="p">,</span> <span class="s">"haberman.data"</span><span class="p">)</span>
<span class="n">habermanList</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="s">"haberman.data"</span><span class="p">)]</span>
<span class="n">habermanRDD</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="n">habermanList</span><span class="p">)</span>
<span class="n">typesRDD</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="s">"1.0,1.0,1.0,2.0"</span><span class="p">])</span>
<span class="n">scriptUrl</span> <span class="o">=</span> <span class="s">"https://raw.githubusercontent.com/apache/systemml/master/scripts/algorithms/Univar-Stats.dml"</span>
<span class="n">uni</span> <span class="o">=</span> <span class="n">dmlFromUrl</span><span class="p">(</span><span class="n">scriptUrl</span><span class="p">)</span><span class="o">.</span><span class="nb">input</span><span class="p">(</span><span class="n">A</span><span class="o">=</span><span class="n">habermanRDD</span><span class="p">,</span> <span class="n">K</span><span class="o">=</span><span class="n">typesRDD</span><span class="p">)</span><span class="o">.</span><span class="nb">input</span><span class="p">(</span><span class="s">"$CONSOLE_OUTPUT"</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">uni</span><span class="p">)(</span><span class="s">'haberman.data'</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">httplib</span><span class="o">.</span><span class="n">HTTPMessage</span> <span class="n">instance</span> <span class="n">at</span> <span class="mh">0x7f601ef2e3b0</span><span class="o">&gt;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">habermanList</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="s">"haberman.data"</span><span class="p">)]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">habermanRDD</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="n">habermanList</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">typesRDD</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">([</span><span class="s">"1.0,1.0,1.0,2.0"</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">scriptUrl</span> <span class="o">=</span> <span class="s">"https://raw.githubusercontent.com/apache/systemml/master/scripts/algorithms/Univar-Stats.dml"</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">uni</span> <span class="o">=</span> <span class="n">dmlFromUrl</span><span class="p">(</span><span class="n">scriptUrl</span><span class="p">)</span><span class="o">.</span><span class="nb">input</span><span class="p">(</span><span class="n">A</span><span class="o">=</span><span class="n">habermanRDD</span><span class="p">,</span> <span class="n">K</span><span class="o">=</span><span class="n">typesRDD</span><span class="p">)</span><span class="o">.</span><span class="nb">input</span><span class="p">(</span><span class="s">"$CONSOLE_OUTPUT"</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">uni</span><span class="p">)</span>
<span class="mi">17</span><span class="o">/</span><span class="mo">07</span><span class="o">/</span><span class="mi">22</span> <span class="mi">13</span><span class="p">:</span><span class="mi">42</span><span class="p">:</span><span class="mi">57</span> <span class="n">WARN</span> <span class="n">RewriteRemovePersistentReadWrite</span><span class="p">:</span> <span class="n">Non</span><span class="o">-</span><span class="n">registered</span> <span class="n">persistent</span> <span class="n">write</span> <span class="n">of</span> <span class="n">variable</span> <span class="s">'baseStats'</span> <span class="p">(</span><span class="n">line</span> <span class="mi">186</span><span class="p">)</span><span class="o">.</span>
<span class="o">-------------------------------------------------</span>
 <span class="p">(</span><span class="mo">01</span><span class="p">)</span> <span class="n">Minimum</span>             <span class="o">|</span> <span class="mf">30.0</span>
 <span class="p">(</span><span class="mo">02</span><span class="p">)</span> <span class="n">Maximum</span>             <span class="o">|</span> <span class="mf">83.0</span>
 <span class="p">(</span><span class="mo">03</span><span class="p">)</span> <span class="n">Range</span>               <span class="o">|</span> <span class="mf">53.0</span>
 <span class="p">(</span><span class="mo">04</span><span class="p">)</span> <span class="n">Mean</span>                <span class="o">|</span> <span class="mf">52.45751633986928</span>
 <span class="p">(</span><span class="mo">05</span><span class="p">)</span> <span class="n">Variance</span>            <span class="o">|</span> <span class="mf">116.71458266366658</span>
 <span class="p">(</span><span class="mo">06</span><span class="p">)</span> <span class="n">Std</span> <span class="n">deviation</span>       <span class="o">|</span> <span class="mf">10.803452349303281</span>
 <span class="p">(</span><span class="mo">07</span><span class="p">)</span> <span class="n">Std</span> <span class="n">err</span> <span class="n">of</span> <span class="n">mean</span>     <span class="o">|</span> <span class="mf">0.6175922641866753</span>
 <span class="p">(</span><span class="mi">08</span><span class="p">)</span> <span class="n">Coeff</span> <span class="n">of</span> <span class="n">variation</span>  <span class="o">|</span> <span class="mf">0.20594669940735139</span>
 <span class="p">(</span><span class="mi">09</span><span class="p">)</span> <span class="n">Skewness</span>            <span class="o">|</span> <span class="mf">0.1450718616532357</span>
 <span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="n">Kurtosis</span>            <span class="o">|</span> <span class="o">-</span><span class="mf">0.6150152487211726</span>
 <span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="n">Std</span> <span class="n">err</span> <span class="n">of</span> <span class="n">skewness</span> <span class="o">|</span> <span class="mf">0.13934809593495995</span>
 <span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="n">Std</span> <span class="n">err</span> <span class="n">of</span> <span class="n">kurtosis</span> <span class="o">|</span> <span class="mf">0.277810485320835</span>
 <span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="n">Median</span>              <span class="o">|</span> <span class="mf">52.0</span>
 <span class="p">(</span><span class="mi">14</span><span class="p">)</span> <span class="n">Interquartile</span> <span class="n">mean</span>  <span class="o">|</span> <span class="mf">52.16013071895425</span>
<span class="n">Feature</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">Scale</span>
<span class="o">-------------------------------------------------</span>
 <span class="p">(</span><span class="mo">01</span><span class="p">)</span> <span class="n">Minimum</span>             <span class="o">|</span> <span class="mf">58.0</span>
 <span class="p">(</span><span class="mo">02</span><span class="p">)</span> <span class="n">Maximum</span>             <span class="o">|</span> <span class="mf">69.0</span>
 <span class="p">(</span><span class="mo">03</span><span class="p">)</span> <span class="n">Range</span>               <span class="o">|</span> <span class="mf">11.0</span>
 <span class="p">(</span><span class="mo">04</span><span class="p">)</span> <span class="n">Mean</span>                <span class="o">|</span> <span class="mf">62.85294117647059</span>
 <span class="p">(</span><span class="mo">05</span><span class="p">)</span> <span class="n">Variance</span>            <span class="o">|</span> <span class="mf">10.558630665380907</span>
 <span class="p">(</span><span class="mo">06</span><span class="p">)</span> <span class="n">Std</span> <span class="n">deviation</span>       <span class="o">|</span> <span class="mf">3.2494046632238507</span>
 <span class="p">(</span><span class="mo">07</span><span class="p">)</span> <span class="n">Std</span> <span class="n">err</span> <span class="n">of</span> <span class="n">mean</span>     <span class="o">|</span> <span class="mf">0.18575610076612029</span>
 <span class="p">(</span><span class="mi">08</span><span class="p">)</span> <span class="n">Coeff</span> <span class="n">of</span> <span class="n">variation</span>  <span class="o">|</span> <span class="mf">0.051698529971741194</span>
 <span class="p">(</span><span class="mi">09</span><span class="p">)</span> <span class="n">Skewness</span>            <span class="o">|</span> <span class="mf">0.07798443581479181</span>
 <span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="n">Kurtosis</span>            <span class="o">|</span> <span class="o">-</span><span class="mf">1.1324380182967442</span>
 <span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="n">Std</span> <span class="n">err</span> <span class="n">of</span> <span class="n">skewness</span> <span class="o">|</span> <span class="mf">0.13934809593495995</span>
 <span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="n">Std</span> <span class="n">err</span> <span class="n">of</span> <span class="n">kurtosis</span> <span class="o">|</span> <span class="mf">0.277810485320835</span>
 <span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="n">Median</span>              <span class="o">|</span> <span class="mf">63.0</span>
 <span class="p">(</span><span class="mi">14</span><span class="p">)</span> <span class="n">Interquartile</span> <span class="n">mean</span>  <span class="o">|</span> <span class="mf">62.80392156862745</span>
<span class="n">Feature</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">Scale</span>
<span class="o">-------------------------------------------------</span>
 <span class="p">(</span><span class="mo">01</span><span class="p">)</span> <span class="n">Minimum</span>             <span class="o">|</span> <span class="mf">0.0</span>
 <span class="p">(</span><span class="mo">02</span><span class="p">)</span> <span class="n">Maximum</span>             <span class="o">|</span> <span class="mf">52.0</span>
 <span class="p">(</span><span class="mo">03</span><span class="p">)</span> <span class="n">Range</span>               <span class="o">|</span> <span class="mf">52.0</span>
 <span class="p">(</span><span class="mo">04</span><span class="p">)</span> <span class="n">Mean</span>                <span class="o">|</span> <span class="mf">4.026143790849673</span>
 <span class="p">(</span><span class="mo">05</span><span class="p">)</span> <span class="n">Variance</span>            <span class="o">|</span> <span class="mf">51.691117539912135</span>
 <span class="p">(</span><span class="mo">06</span><span class="p">)</span> <span class="n">Std</span> <span class="n">deviation</span>       <span class="o">|</span> <span class="mf">7.189653506248555</span>
 <span class="p">(</span><span class="mo">07</span><span class="p">)</span> <span class="n">Std</span> <span class="n">err</span> <span class="n">of</span> <span class="n">mean</span>     <span class="o">|</span> <span class="mf">0.41100513466216837</span>
 <span class="p">(</span><span class="mi">08</span><span class="p">)</span> <span class="n">Coeff</span> <span class="n">of</span> <span class="n">variation</span>  <span class="o">|</span> <span class="mf">1.7857418611299172</span>
 <span class="p">(</span><span class="mi">09</span><span class="p">)</span> <span class="n">Skewness</span>            <span class="o">|</span> <span class="mf">2.954633471088322</span>
 <span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="n">Kurtosis</span>            <span class="o">|</span> <span class="mf">11.425776549251449</span>
 <span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="n">Std</span> <span class="n">err</span> <span class="n">of</span> <span class="n">skewness</span> <span class="o">|</span> <span class="mf">0.13934809593495995</span>
 <span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="n">Std</span> <span class="n">err</span> <span class="n">of</span> <span class="n">kurtosis</span> <span class="o">|</span> <span class="mf">0.277810485320835</span>
 <span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="n">Median</span>              <span class="o">|</span> <span class="mf">1.0</span>
 <span class="p">(</span><span class="mi">14</span><span class="p">)</span> <span class="n">Interquartile</span> <span class="n">mean</span>  <span class="o">|</span> <span class="mf">1.2483660130718954</span>
<span class="n">Feature</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">Scale</span>
<span class="o">-------------------------------------------------</span>
<span class="n">Feature</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">Categorical</span> <span class="p">(</span><span class="n">Nominal</span><span class="p">)</span>
 <span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="n">Num</span> <span class="n">of</span> <span class="n">categories</span>   <span class="o">|</span> <span class="mi">2</span>
 <span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="n">Mode</span>                <span class="o">|</span> <span class="mi">1</span>
 <span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="n">Num</span> <span class="n">of</span> <span class="n">modes</span>        <span class="o">|</span> <span class="mi">1</span>
<span class="n">SystemML</span> <span class="n">Statistics</span><span class="p">:</span>
<span class="n">Total</span> <span class="n">execution</span> <span class="n">time</span><span class="p">:</span>           <span class="mf">0.733</span> <span class="n">sec</span><span class="o">.</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">executed</span> <span class="n">Spark</span> <span class="n">inst</span><span class="p">:</span>  <span class="mf">4.</span>

<span class="n">MLResults</span>
<span class="o">&gt;&gt;&gt;</span></code></pre></div>

  </div>

</div>

<p>Alternatively, we could supply a <code>java.net.URL</code> to the Script <code>in</code> method. Note that if the URL matrix data is in IJV
format, metadata needs to be supplied for the matrix. This feature is not available in Python.</p>

<div class="codetabs">

<div data-lang="Scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">habermanUrl</span> <span class="k">=</span> <span class="s">"http://archive.ics.uci.edu/ml/machine-learning-databases/haberman/haberman.data"</span>
<span class="k">val</span> <span class="n">typesRDD</span> <span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="o">(</span><span class="nc">Array</span><span class="o">(</span><span class="s">"1.0,1.0,1.0,2.0"</span><span class="o">))</span>
<span class="k">val</span> <span class="n">scriptUrl</span> <span class="k">=</span> <span class="s">"https://raw.githubusercontent.com/apache/systemml/master/scripts/algorithms/Univar-Stats.dml"</span>
<span class="k">val</span> <span class="n">uni</span> <span class="k">=</span> <span class="n">dmlFromUrl</span><span class="o">(</span><span class="n">scriptUrl</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"A"</span><span class="o">,</span> <span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="nc">URL</span><span class="o">(</span><span class="n">habermanUrl</span><span class="o">)).</span><span class="n">in</span><span class="o">(</span><span class="s">"K"</span><span class="o">,</span> <span class="n">typesRDD</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"$CONSOLE_OUTPUT"</span><span class="o">,</span> <span class="kc">true</span><span class="o">)</span>
<span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">uni</span><span class="o">)</span></code></pre></div>

  </div>

<div data-lang="Spark Shell">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">habermanUrl</span> <span class="k">=</span> <span class="s">"http://archive.ics.uci.edu/ml/machine-learning-databases/haberman/haberman.data"</span>
<span class="n">habermanUrl</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">http</span><span class="o">://</span><span class="n">archive</span><span class="o">.</span><span class="n">ics</span><span class="o">.</span><span class="n">uci</span><span class="o">.</span><span class="n">edu</span><span class="o">/</span><span class="n">ml</span><span class="o">/</span><span class="n">machine</span><span class="o">-</span><span class="n">learning</span><span class="o">-</span><span class="n">databases</span><span class="o">/</span><span class="n">haberman</span><span class="o">/</span><span class="n">haberman</span><span class="o">.</span><span class="n">data</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">typesRDD</span> <span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="o">(</span><span class="nc">Array</span><span class="o">(</span><span class="s">"1.0,1.0,1.0,2.0"</span><span class="o">))</span>
<span class="n">typesRDD</span><span class="k">:</span> <span class="kt">org.apache.spark.rdd.RDD</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">ParallelCollectionRDD</span><span class="o">[</span><span class="err">50</span><span class="o">]</span> <span class="n">at</span> <span class="n">parallelize</span> <span class="n">at</span> <span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">33</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">scriptUrl</span> <span class="k">=</span> <span class="s">"https://raw.githubusercontent.com/apache/systemml/master/scripts/algorithms/Univar-Stats.dml"</span>
<span class="n">scriptUrl</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">https</span><span class="o">://</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">apache</span><span class="o">/</span><span class="n">systemml</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">algorithms</span><span class="o">/</span><span class="nc">Univar</span><span class="o">-</span><span class="nc">Stats</span><span class="o">.</span><span class="n">dml</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">uni</span> <span class="k">=</span> <span class="n">dmlFromUrl</span><span class="o">(</span><span class="n">scriptUrl</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"A"</span><span class="o">,</span> <span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="nc">URL</span><span class="o">(</span><span class="n">habermanUrl</span><span class="o">)).</span><span class="n">in</span><span class="o">(</span><span class="s">"K"</span><span class="o">,</span> <span class="n">typesRDD</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"$CONSOLE_OUTPUT"</span><span class="o">,</span> <span class="kc">true</span><span class="o">)</span>
<span class="n">uni</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.Script</span> <span class="o">=</span>
<span class="nc">Inputs</span><span class="k">:</span>
  <span class="err">[1]</span> <span class="o">(</span><span class="kt">URL</span><span class="o">)</span> <span class="kt">A:</span> <span class="kt">http://archive.ics.uci.edu/ml/machine-learning-databases/haberman/haberman.data</span>
  <span class="o">[</span><span class="err">2</span><span class="o">]</span> <span class="o">(</span><span class="nc">RDD</span><span class="o">)</span> <span class="n">K</span><span class="k">:</span> <span class="kt">ParallelCollectionRDD</span><span class="o">[</span><span class="err">50</span><span class="o">]</span> <span class="n">at</span> <span class="n">parallelize</span> <span class="n">at</span> <span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">33</span>
  <span class="o">[</span><span class="err">3</span><span class="o">]</span> <span class="o">(</span><span class="nc">Boolean</span><span class="o">)</span> <span class="nc">$CONSOLE_OUTPUT</span><span class="k">:</span> <span class="kt">true</span>

<span class="nc">Outputs</span><span class="k">:</span>
<span class="kt">None</span>


<span class="n">scala</span><span class="o">&gt;</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">uni</span><span class="o">)</span>
<span class="o">...</span>
<span class="o">-------------------------------------------------</span>
 <span class="o">(</span><span class="mi">01</span><span class="o">)</span> <span class="nc">Minimum</span>             <span class="o">|</span> <span class="mf">30.0</span>
 <span class="o">(</span><span class="mi">02</span><span class="o">)</span> <span class="nc">Maximum</span>             <span class="o">|</span> <span class="mf">83.0</span>
 <span class="o">(</span><span class="mi">03</span><span class="o">)</span> <span class="nc">Range</span>               <span class="o">|</span> <span class="mf">53.0</span>
 <span class="o">(</span><span class="mi">04</span><span class="o">)</span> <span class="nc">Mean</span>                <span class="o">|</span> <span class="mf">52.45751633986928</span>
 <span class="o">(</span><span class="mi">05</span><span class="o">)</span> <span class="nc">Variance</span>            <span class="o">|</span> <span class="mf">116.71458266366658</span>
 <span class="o">(</span><span class="mi">06</span><span class="o">)</span> <span class="nc">Std</span> <span class="n">deviation</span>       <span class="o">|</span> <span class="mf">10.803452349303281</span>
 <span class="o">(</span><span class="mi">07</span><span class="o">)</span> <span class="nc">Std</span> <span class="n">err</span> <span class="n">of</span> <span class="n">mean</span>     <span class="o">|</span> <span class="mf">0.6175922641866753</span>
 <span class="o">(</span><span class="mi">08</span><span class="o">)</span> <span class="nc">Coeff</span> <span class="n">of</span> <span class="n">variation</span>  <span class="o">|</span> <span class="mf">0.20594669940735139</span>
 <span class="o">(</span><span class="mi">09</span><span class="o">)</span> <span class="nc">Skewness</span>            <span class="o">|</span> <span class="mf">0.1450718616532357</span>
 <span class="o">(</span><span class="mi">10</span><span class="o">)</span> <span class="nc">Kurtosis</span>            <span class="o">|</span> <span class="o">-</span><span class="mf">0.6150152487211726</span>
 <span class="o">(</span><span class="mi">11</span><span class="o">)</span> <span class="nc">Std</span> <span class="n">err</span> <span class="n">of</span> <span class="n">skewness</span> <span class="o">|</span> <span class="mf">0.13934809593495995</span>
 <span class="o">(</span><span class="mi">12</span><span class="o">)</span> <span class="nc">Std</span> <span class="n">err</span> <span class="n">of</span> <span class="n">kurtosis</span> <span class="o">|</span> <span class="mf">0.277810485320835</span>
 <span class="o">(</span><span class="mi">13</span><span class="o">)</span> <span class="nc">Median</span>              <span class="o">|</span> <span class="mf">52.0</span>
 <span class="o">(</span><span class="mi">14</span><span class="o">)</span> <span class="nc">Interquartile</span> <span class="n">mean</span>  <span class="o">|</span> <span class="mf">52.16013071895425</span>
<span class="nc">Feature</span> <span class="o">[</span><span class="err">1</span><span class="o">]</span><span class="k">:</span> <span class="kt">Scale</span>
<span class="o">-------------------------------------------------</span>
 <span class="o">(</span><span class="mi">01</span><span class="o">)</span> <span class="nc">Minimum</span>             <span class="o">|</span> <span class="mf">58.0</span>
 <span class="o">(</span><span class="mi">02</span><span class="o">)</span> <span class="nc">Maximum</span>             <span class="o">|</span> <span class="mf">69.0</span>
 <span class="o">(</span><span class="mi">03</span><span class="o">)</span> <span class="nc">Range</span>               <span class="o">|</span> <span class="mf">11.0</span>
 <span class="o">(</span><span class="mi">04</span><span class="o">)</span> <span class="nc">Mean</span>                <span class="o">|</span> <span class="mf">62.85294117647059</span>
 <span class="o">(</span><span class="mi">05</span><span class="o">)</span> <span class="nc">Variance</span>            <span class="o">|</span> <span class="mf">10.558630665380907</span>
 <span class="o">(</span><span class="mi">06</span><span class="o">)</span> <span class="nc">Std</span> <span class="n">deviation</span>       <span class="o">|</span> <span class="mf">3.2494046632238507</span>
 <span class="o">(</span><span class="mi">07</span><span class="o">)</span> <span class="nc">Std</span> <span class="n">err</span> <span class="n">of</span> <span class="n">mean</span>     <span class="o">|</span> <span class="mf">0.18575610076612029</span>
 <span class="o">(</span><span class="mi">08</span><span class="o">)</span> <span class="nc">Coeff</span> <span class="n">of</span> <span class="n">variation</span>  <span class="o">|</span> <span class="mf">0.051698529971741194</span>
 <span class="o">(</span><span class="mi">09</span><span class="o">)</span> <span class="nc">Skewness</span>            <span class="o">|</span> <span class="mf">0.07798443581479181</span>
 <span class="o">(</span><span class="mi">10</span><span class="o">)</span> <span class="nc">Kurtosis</span>            <span class="o">|</span> <span class="o">-</span><span class="mf">1.1324380182967442</span>
 <span class="o">(</span><span class="mi">11</span><span class="o">)</span> <span class="nc">Std</span> <span class="n">err</span> <span class="n">of</span> <span class="n">skewness</span> <span class="o">|</span> <span class="mf">0.13934809593495995</span>
 <span class="o">(</span><span class="mi">12</span><span class="o">)</span> <span class="nc">Std</span> <span class="n">err</span> <span class="n">of</span> <span class="n">kurtosis</span> <span class="o">|</span> <span class="mf">0.277810485320835</span>
 <span class="o">(</span><span class="mi">13</span><span class="o">)</span> <span class="nc">Median</span>              <span class="o">|</span> <span class="mf">63.0</span>
 <span class="o">(</span><span class="mi">14</span><span class="o">)</span> <span class="nc">Interquartile</span> <span class="n">mean</span>  <span class="o">|</span> <span class="mf">62.80392156862745</span>
<span class="nc">Feature</span> <span class="o">[</span><span class="err">2</span><span class="o">]</span><span class="k">:</span> <span class="kt">Scale</span>
<span class="o">-------------------------------------------------</span>
 <span class="o">(</span><span class="mi">01</span><span class="o">)</span> <span class="nc">Minimum</span>             <span class="o">|</span> <span class="mf">0.0</span>
 <span class="o">(</span><span class="mi">02</span><span class="o">)</span> <span class="nc">Maximum</span>             <span class="o">|</span> <span class="mf">52.0</span>
 <span class="o">(</span><span class="mi">03</span><span class="o">)</span> <span class="nc">Range</span>               <span class="o">|</span> <span class="mf">52.0</span>
 <span class="o">(</span><span class="mi">04</span><span class="o">)</span> <span class="nc">Mean</span>                <span class="o">|</span> <span class="mf">4.026143790849673</span>
 <span class="o">(</span><span class="mi">05</span><span class="o">)</span> <span class="nc">Variance</span>            <span class="o">|</span> <span class="mf">51.691117539912135</span>
 <span class="o">(</span><span class="mi">06</span><span class="o">)</span> <span class="nc">Std</span> <span class="n">deviation</span>       <span class="o">|</span> <span class="mf">7.189653506248555</span>
 <span class="o">(</span><span class="mi">07</span><span class="o">)</span> <span class="nc">Std</span> <span class="n">err</span> <span class="n">of</span> <span class="n">mean</span>     <span class="o">|</span> <span class="mf">0.41100513466216837</span>
 <span class="o">(</span><span class="mi">08</span><span class="o">)</span> <span class="nc">Coeff</span> <span class="n">of</span> <span class="n">variation</span>  <span class="o">|</span> <span class="mf">1.7857418611299172</span>
 <span class="o">(</span><span class="mi">09</span><span class="o">)</span> <span class="nc">Skewness</span>            <span class="o">|</span> <span class="mf">2.954633471088322</span>
 <span class="o">(</span><span class="mi">10</span><span class="o">)</span> <span class="nc">Kurtosis</span>            <span class="o">|</span> <span class="mf">11.425776549251449</span>
 <span class="o">(</span><span class="mi">11</span><span class="o">)</span> <span class="nc">Std</span> <span class="n">err</span> <span class="n">of</span> <span class="n">skewness</span> <span class="o">|</span> <span class="mf">0.13934809593495995</span>
 <span class="o">(</span><span class="mi">12</span><span class="o">)</span> <span class="nc">Std</span> <span class="n">err</span> <span class="n">of</span> <span class="n">kurtosis</span> <span class="o">|</span> <span class="mf">0.277810485320835</span>
 <span class="o">(</span><span class="mi">13</span><span class="o">)</span> <span class="nc">Median</span>              <span class="o">|</span> <span class="mf">1.0</span>
 <span class="o">(</span><span class="mi">14</span><span class="o">)</span> <span class="nc">Interquartile</span> <span class="n">mean</span>  <span class="o">|</span> <span class="mf">1.2483660130718954</span>
<span class="nc">Feature</span> <span class="o">[</span><span class="err">3</span><span class="o">]</span><span class="k">:</span> <span class="kt">Scale</span>
<span class="o">-------------------------------------------------</span>
<span class="nc">Feature</span> <span class="o">[</span><span class="err">4</span><span class="o">]</span><span class="k">:</span> <span class="kt">Categorical</span> <span class="o">(</span><span class="kt">Nominal</span><span class="o">)</span>
 <span class="o">(</span><span class="err">15</span><span class="o">)</span> <span class="kt">Num</span> <span class="kt">of</span> <span class="kt">categories</span>   <span class="kt">|</span> <span class="err">2</span>
 <span class="o">(</span><span class="err">16</span><span class="o">)</span> <span class="kt">Mode</span>                <span class="kt">|</span> <span class="err">1</span>
 <span class="o">(</span><span class="err">17</span><span class="o">)</span> <span class="kt">Num</span> <span class="kt">of</span> <span class="kt">modes</span>        <span class="kt">|</span> <span class="err">1</span>
<span class="kt">res5:</span> <span class="kt">org.apache.sysml.api.mlcontext.MLResults</span> <span class="o">=</span>
<span class="nc">None</span></code></pre></div>

  </div>

</div>

<p>As another example, we can also conveniently obtain a Univariate Statistics DML Script object
via <code>ml.scripts.algorithms.Univar_Stats</code>, as shown below. This feature is not available in Python.</p>

<div class="codetabs">

<div data-lang="Scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">habermanUrl</span> <span class="k">=</span> <span class="s">"http://archive.ics.uci.edu/ml/machine-learning-databases/haberman/haberman.data"</span>
<span class="k">val</span> <span class="n">typesRDD</span> <span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="o">(</span><span class="nc">Array</span><span class="o">(</span><span class="s">"1.0,1.0,1.0,2.0"</span><span class="o">))</span>
<span class="k">val</span> <span class="n">scriptUrl</span> <span class="k">=</span> <span class="s">"https://raw.githubusercontent.com/apache/systemml/master/scripts/algorithms/Univar-Stats.dml"</span>
<span class="n">ml</span><span class="o">.</span><span class="n">scripts</span><span class="o">.</span><span class="n">algorithms</span><span class="o">.</span><span class="nc">Univar_Stats</span><span class="o">.</span><span class="n">in</span><span class="o">(</span><span class="s">"A"</span><span class="o">,</span> <span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="nc">URL</span><span class="o">(</span><span class="n">habermanUrl</span><span class="o">)).</span><span class="n">in</span><span class="o">(</span><span class="s">"K"</span><span class="o">,</span> <span class="n">typesRDD</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"$CONSOLE_OUTPUT"</span><span class="o">,</span> <span class="kc">true</span><span class="o">).</span><span class="n">execute</span></code></pre></div>

  </div>

<div data-lang="Spark Shell">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">habermanUrl</span> <span class="k">=</span> <span class="s">"http://archive.ics.uci.edu/ml/machine-learning-databases/haberman/haberman.data"</span>
<span class="n">habermanUrl</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">http</span><span class="o">://</span><span class="n">archive</span><span class="o">.</span><span class="n">ics</span><span class="o">.</span><span class="n">uci</span><span class="o">.</span><span class="n">edu</span><span class="o">/</span><span class="n">ml</span><span class="o">/</span><span class="n">machine</span><span class="o">-</span><span class="n">learning</span><span class="o">-</span><span class="n">databases</span><span class="o">/</span><span class="n">haberman</span><span class="o">/</span><span class="n">haberman</span><span class="o">.</span><span class="n">data</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">typesRDD</span> <span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="o">(</span><span class="nc">Array</span><span class="o">(</span><span class="s">"1.0,1.0,1.0,2.0"</span><span class="o">))</span>
<span class="n">typesRDD</span><span class="k">:</span> <span class="kt">org.apache.spark.rdd.RDD</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">ParallelCollectionRDD</span><span class="o">[</span><span class="err">21</span><span class="o">]</span> <span class="n">at</span> <span class="n">parallelize</span> <span class="n">at</span> <span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">30</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">scriptUrl</span> <span class="k">=</span> <span class="s">"https://raw.githubusercontent.com/apache/systemml/master/scripts/algorithms/Univar-Stats.dml"</span>
<span class="n">scriptUrl</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">https</span><span class="o">://</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">apache</span><span class="o">/</span><span class="n">systemml</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">algorithms</span><span class="o">/</span><span class="nc">Univar</span><span class="o">-</span><span class="nc">Stats</span><span class="o">.</span><span class="n">dml</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">ml</span><span class="o">.</span><span class="n">scripts</span><span class="o">.</span><span class="n">algorithms</span><span class="o">.</span><span class="nc">Univar_Stats</span><span class="o">.</span><span class="n">in</span><span class="o">(</span><span class="s">"A"</span><span class="o">,</span> <span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="nc">URL</span><span class="o">(</span><span class="n">habermanUrl</span><span class="o">)).</span><span class="n">in</span><span class="o">(</span><span class="s">"K"</span><span class="o">,</span> <span class="n">typesRDD</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"$CONSOLE_OUTPUT"</span><span class="o">,</span> <span class="kc">true</span><span class="o">).</span><span class="n">execute</span>
<span class="mi">17</span><span class="o">/</span><span class="mi">06</span><span class="o">/</span><span class="mi">05</span> <span class="mi">17</span><span class="k">:</span><span class="err">23</span><span class="kt">:</span><span class="err">37</span> <span class="kt">WARN</span> <span class="kt">RewriteRemovePersistentReadWrite:</span> <span class="kt">Non-registered</span> <span class="kt">persistent</span> <span class="kt">write</span> <span class="kt">of</span> <span class="kt">variable</span> <span class="kt">'baseStats'</span> <span class="o">(</span><span class="kt">line</span> <span class="err">186</span><span class="o">)</span><span class="kt">.</span>
<span class="kt">-------------------------------------------------</span>
 <span class="o">(</span><span class="err">01</span><span class="o">)</span> <span class="kt">Minimum</span>             <span class="kt">|</span> <span class="err">30</span><span class="kt">.</span><span class="err">0</span>
 <span class="o">(</span><span class="err">02</span><span class="o">)</span> <span class="kt">Maximum</span>             <span class="kt">|</span> <span class="err">83</span><span class="kt">.</span><span class="err">0</span>
 <span class="o">(</span><span class="err">03</span><span class="o">)</span> <span class="kt">Range</span>               <span class="kt">|</span> <span class="err">53</span><span class="kt">.</span><span class="err">0</span>
 <span class="o">(</span><span class="err">04</span><span class="o">)</span> <span class="kt">Mean</span>                <span class="kt">|</span> <span class="err">52</span><span class="kt">.</span><span class="err">45751633986928</span>
 <span class="o">(</span><span class="err">05</span><span class="o">)</span> <span class="kt">Variance</span>            <span class="kt">|</span> <span class="err">116</span><span class="kt">.</span><span class="err">71458266366658</span>
 <span class="o">(</span><span class="err">06</span><span class="o">)</span> <span class="kt">Std</span> <span class="kt">deviation</span>       <span class="kt">|</span> <span class="err">10</span><span class="kt">.</span><span class="err">803452349303281</span>
 <span class="o">(</span><span class="err">07</span><span class="o">)</span> <span class="kt">Std</span> <span class="kt">err</span> <span class="kt">of</span> <span class="kt">mean</span>     <span class="kt">|</span> <span class="err">0</span><span class="kt">.</span><span class="err">6175922641866753</span>
 <span class="o">(</span><span class="err">08</span><span class="o">)</span> <span class="kt">Coeff</span> <span class="kt">of</span> <span class="kt">variation</span>  <span class="kt">|</span> <span class="err">0</span><span class="kt">.</span><span class="err">20594669940735139</span>
 <span class="o">(</span><span class="err">09</span><span class="o">)</span> <span class="kt">Skewness</span>            <span class="kt">|</span> <span class="err">0</span><span class="kt">.</span><span class="err">1450718616532357</span>
 <span class="o">(</span><span class="err">10</span><span class="o">)</span> <span class="kt">Kurtosis</span>            <span class="kt">|</span> <span class="kt">-</span><span class="err">0</span><span class="kt">.</span><span class="err">6150152487211726</span>
 <span class="o">(</span><span class="err">11</span><span class="o">)</span> <span class="kt">Std</span> <span class="kt">err</span> <span class="kt">of</span> <span class="kt">skewness</span> <span class="kt">|</span> <span class="err">0</span><span class="kt">.</span><span class="err">13934809593495995</span>
 <span class="o">(</span><span class="err">12</span><span class="o">)</span> <span class="kt">Std</span> <span class="kt">err</span> <span class="kt">of</span> <span class="kt">kurtosis</span> <span class="kt">|</span> <span class="err">0</span><span class="kt">.</span><span class="err">277810485320835</span>
 <span class="o">(</span><span class="err">13</span><span class="o">)</span> <span class="kt">Median</span>              <span class="kt">|</span> <span class="err">52</span><span class="kt">.</span><span class="err">0</span>
 <span class="o">(</span><span class="err">14</span><span class="o">)</span> <span class="kt">Interquartile</span> <span class="kt">mean</span>  <span class="kt">|</span> <span class="err">52</span><span class="kt">.</span><span class="err">16013071895425</span>
<span class="kt">Feature</span> <span class="o">[</span><span class="err">1</span><span class="o">]</span><span class="k">:</span> <span class="kt">Scale</span>
<span class="o">-------------------------------------------------</span>
 <span class="o">(</span><span class="mi">01</span><span class="o">)</span> <span class="nc">Minimum</span>             <span class="o">|</span> <span class="mf">58.0</span>
 <span class="o">(</span><span class="mi">02</span><span class="o">)</span> <span class="nc">Maximum</span>             <span class="o">|</span> <span class="mf">69.0</span>
 <span class="o">(</span><span class="mi">03</span><span class="o">)</span> <span class="nc">Range</span>               <span class="o">|</span> <span class="mf">11.0</span>
 <span class="o">(</span><span class="mi">04</span><span class="o">)</span> <span class="nc">Mean</span>                <span class="o">|</span> <span class="mf">62.85294117647059</span>
 <span class="o">(</span><span class="mi">05</span><span class="o">)</span> <span class="nc">Variance</span>            <span class="o">|</span> <span class="mf">10.558630665380907</span>
 <span class="o">(</span><span class="mi">06</span><span class="o">)</span> <span class="nc">Std</span> <span class="n">deviation</span>       <span class="o">|</span> <span class="mf">3.2494046632238507</span>
 <span class="o">(</span><span class="mi">07</span><span class="o">)</span> <span class="nc">Std</span> <span class="n">err</span> <span class="n">of</span> <span class="n">mean</span>     <span class="o">|</span> <span class="mf">0.18575610076612029</span>
 <span class="o">(</span><span class="mi">08</span><span class="o">)</span> <span class="nc">Coeff</span> <span class="n">of</span> <span class="n">variation</span>  <span class="o">|</span> <span class="mf">0.051698529971741194</span>
 <span class="o">(</span><span class="mi">09</span><span class="o">)</span> <span class="nc">Skewness</span>            <span class="o">|</span> <span class="mf">0.07798443581479181</span>
 <span class="o">(</span><span class="mi">10</span><span class="o">)</span> <span class="nc">Kurtosis</span>            <span class="o">|</span> <span class="o">-</span><span class="mf">1.1324380182967442</span>
 <span class="o">(</span><span class="mi">11</span><span class="o">)</span> <span class="nc">Std</span> <span class="n">err</span> <span class="n">of</span> <span class="n">skewness</span> <span class="o">|</span> <span class="mf">0.13934809593495995</span>
 <span class="o">(</span><span class="mi">12</span><span class="o">)</span> <span class="nc">Std</span> <span class="n">err</span> <span class="n">of</span> <span class="n">kurtosis</span> <span class="o">|</span> <span class="mf">0.277810485320835</span>
 <span class="o">(</span><span class="mi">13</span><span class="o">)</span> <span class="nc">Median</span>              <span class="o">|</span> <span class="mf">63.0</span>
 <span class="o">(</span><span class="mi">14</span><span class="o">)</span> <span class="nc">Interquartile</span> <span class="n">mean</span>  <span class="o">|</span> <span class="mf">62.80392156862745</span>
<span class="nc">Feature</span> <span class="o">[</span><span class="err">2</span><span class="o">]</span><span class="k">:</span> <span class="kt">Scale</span>
<span class="o">-------------------------------------------------</span>
 <span class="o">(</span><span class="mi">01</span><span class="o">)</span> <span class="nc">Minimum</span>             <span class="o">|</span> <span class="mf">0.0</span>
 <span class="o">(</span><span class="mi">02</span><span class="o">)</span> <span class="nc">Maximum</span>             <span class="o">|</span> <span class="mf">52.0</span>
 <span class="o">(</span><span class="mi">03</span><span class="o">)</span> <span class="nc">Range</span>               <span class="o">|</span> <span class="mf">52.0</span>
 <span class="o">(</span><span class="mi">04</span><span class="o">)</span> <span class="nc">Mean</span>                <span class="o">|</span> <span class="mf">4.026143790849673</span>
 <span class="o">(</span><span class="mi">05</span><span class="o">)</span> <span class="nc">Variance</span>            <span class="o">|</span> <span class="mf">51.691117539912135</span>
 <span class="o">(</span><span class="mi">06</span><span class="o">)</span> <span class="nc">Std</span> <span class="n">deviation</span>       <span class="o">|</span> <span class="mf">7.189653506248555</span>
 <span class="o">(</span><span class="mi">07</span><span class="o">)</span> <span class="nc">Std</span> <span class="n">err</span> <span class="n">of</span> <span class="n">mean</span>     <span class="o">|</span> <span class="mf">0.41100513466216837</span>
 <span class="o">(</span><span class="mi">08</span><span class="o">)</span> <span class="nc">Coeff</span> <span class="n">of</span> <span class="n">variation</span>  <span class="o">|</span> <span class="mf">1.7857418611299172</span>
 <span class="o">(</span><span class="mi">09</span><span class="o">)</span> <span class="nc">Skewness</span>            <span class="o">|</span> <span class="mf">2.954633471088322</span>
 <span class="o">(</span><span class="mi">10</span><span class="o">)</span> <span class="nc">Kurtosis</span>            <span class="o">|</span> <span class="mf">11.425776549251449</span>
 <span class="o">(</span><span class="mi">11</span><span class="o">)</span> <span class="nc">Std</span> <span class="n">err</span> <span class="n">of</span> <span class="n">skewness</span> <span class="o">|</span> <span class="mf">0.13934809593495995</span>
 <span class="o">(</span><span class="mi">12</span><span class="o">)</span> <span class="nc">Std</span> <span class="n">err</span> <span class="n">of</span> <span class="n">kurtosis</span> <span class="o">|</span> <span class="mf">0.277810485320835</span>
 <span class="o">(</span><span class="mi">13</span><span class="o">)</span> <span class="nc">Median</span>              <span class="o">|</span> <span class="mf">1.0</span>
 <span class="o">(</span><span class="mi">14</span><span class="o">)</span> <span class="nc">Interquartile</span> <span class="n">mean</span>  <span class="o">|</span> <span class="mf">1.2483660130718954</span>
<span class="nc">Feature</span> <span class="o">[</span><span class="err">3</span><span class="o">]</span><span class="k">:</span> <span class="kt">Scale</span>
<span class="o">-------------------------------------------------</span>
<span class="nc">Feature</span> <span class="o">[</span><span class="err">4</span><span class="o">]</span><span class="k">:</span> <span class="kt">Categorical</span> <span class="o">(</span><span class="kt">Nominal</span><span class="o">)</span>
 <span class="o">(</span><span class="err">15</span><span class="o">)</span> <span class="kt">Num</span> <span class="kt">of</span> <span class="kt">categories</span>   <span class="kt">|</span> <span class="err">2</span>
 <span class="o">(</span><span class="err">16</span><span class="o">)</span> <span class="kt">Mode</span>                <span class="kt">|</span> <span class="err">1</span>
 <span class="o">(</span><span class="err">17</span><span class="o">)</span> <span class="kt">Num</span> <span class="kt">of</span> <span class="kt">modes</span>        <span class="kt">|</span> <span class="err">1</span>
<span class="kt">SystemML</span> <span class="kt">Statistics:</span>
<span class="kt">Total</span> <span class="kt">execution</span> <span class="kt">time:</span>		<span class="err">0</span><span class="kt">.</span><span class="err">211</span> <span class="kt">sec.</span>
<span class="kt">Number</span> <span class="kt">of</span> <span class="kt">executed</span> <span class="kt">Spark</span> <span class="kt">inst:</span>	<span class="err">8</span><span class="kt">.</span>

<span class="kt">res1:</span> <span class="kt">org.apache.sysml.api.mlcontext.MLResults</span> <span class="o">=</span>
<span class="nc">None</span></code></pre></div>

  </div>

</div>

<h3 id="input-variables-vs-input-parameters">Input Variables vs Input Parameters</h3>

<p>If we examine the
<a href="https://raw.githubusercontent.com/apache/systemml/master/scripts/algorithms/Univar-Stats.dml"><code>Univar-Stats.dml</code></a>
file, we see in the comments that it can take 4 input
parameters, <code>$X</code>, <code>$TYPES</code>, <code>$CONSOLE_OUTPUT</code>, and <code>$STATS</code>. Input parameters are typically useful when
executing SystemML in Standalone mode, Spark batch mode, or Hadoop batch mode. For example, <code>$X</code> specifies
the location in the file system where the input data matrix is located, <code>$TYPES</code> specifies the location in the file system
where the input types matrix is located, <code>$CONSOLE_OUTPUT</code> specifies whether or not labeled statistics should be
output to the console, and <code>$STATS</code> specifies the location in the file system where the output matrix should be written.</p>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">...</span><span class="w">
</span><span class="c1"># INPUT PARAMETERS:</span><span class="w">
</span><span class="c1"># -------------------------------------------------------------------------------------------------</span><span class="w">
</span><span class="c1"># NAME           TYPE     DEFAULT  MEANING</span><span class="w">
</span><span class="c1"># -------------------------------------------------------------------------------------------------</span><span class="w">
</span><span class="c1"># X              String   ---      Location of INPUT data matrix</span><span class="w">
</span><span class="c1"># TYPES          String   ---      Location of INPUT matrix that lists the types of the features:</span><span class="w">
</span><span class="c1">#                                     1 for scale, 2 for nominal, 3 for ordinal</span><span class="w">
</span><span class="c1"># CONSOLE_OUTPUT Boolean  FALSE    If TRUE, print summary statistics to console</span><span class="w">
</span><span class="c1"># STATS          String   ---      Location of OUTPUT matrix with summary statistics computed for</span><span class="w">
</span><span class="c1">#                                  all features (17 statistics - 14 scale, 3 categorical)</span><span class="w">
</span><span class="c1"># -------------------------------------------------------------------------------------------------</span><span class="w">
</span><span class="c1"># OUTPUT: Matrix of summary statistics</span><span class="w">
</span><span class="n">...</span><span class="w">
</span><span class="n">consoleOutput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ifdef</span><span class="p">(</span><span class="o">$</span><span class="n">CONSOLE_OUTPUT</span><span class="p">,</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">);</span><span class="w">
</span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read</span><span class="p">(</span><span class="o">$</span><span class="n">X</span><span class="p">);</span><span class="w"> </span><span class="c1"># data file</span><span class="w">
</span><span class="n">K</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read</span><span class="p">(</span><span class="o">$</span><span class="n">TYPES</span><span class="p">);</span><span class="w"> </span><span class="c1"># attribute kind file</span><span class="w">
</span><span class="n">...</span><span class="w">
</span><span class="n">write</span><span class="p">(</span><span class="n">baseStats</span><span class="p">,</span><span class="w"> </span><span class="o">$</span><span class="n">STATS</span><span class="p">);</span><span class="w">
</span><span class="n">...</span></code></pre></div>

<p>Because MLContext is a programmatic interface, it offers more flexibility. You can still use input parameters
and files in the file system, such as this example that specifies file paths to the input matrices and the output matrix:</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">script</span> <span class="k">=</span> <span class="n">dmlFromFile</span><span class="o">(</span><span class="s">"scripts/algorithms/Univar-Stats.dml"</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"$X"</span><span class="o">,</span> <span class="s">"data/haberman.data"</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"$TYPES"</span><span class="o">,</span> <span class="s">"data/types.csv"</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"$STATS"</span><span class="o">,</span> <span class="s">"data/univarOut.mtx"</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"$CONSOLE_OUTPUT"</span><span class="o">,</span> <span class="kc">true</span><span class="o">)</span>
<span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">script</span><span class="o">)</span></code></pre></div>

<p>Using the MLContext API, rather than relying solely on input parameters, we can bind to the variables associated
with the <code>read</code> and <code>write</code> statements. In the fragment of <code>Univar-Stats.dml</code> above, notice that the matrix at
path <code>$X</code> is read to variable <code>A</code>, <code>$TYPES</code> is read to variable
<code>K</code>, and <code>baseStats</code> is written to path <code>$STATS</code>. Therefore, we can bind the Haberman input data matrix to the <code>A</code> variable,
the input types matrix to the <code>K</code> variable, and the output matrix to the <code>baseStats</code> variable.</p>

<div class="codetabs">

<div data-lang="Scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">uni</span> <span class="k">=</span> <span class="n">dmlFromUrl</span><span class="o">(</span><span class="n">scriptUrl</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"A"</span><span class="o">,</span> <span class="n">habermanRDD</span><span class="o">,</span> <span class="n">habermanMetadata</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"K"</span><span class="o">,</span> <span class="n">typesRDD</span><span class="o">,</span> <span class="n">typesMetadata</span><span class="o">).</span><span class="n">out</span><span class="o">(</span><span class="s">"baseStats"</span><span class="o">)</span>
<span class="k">val</span> <span class="n">baseStats</span> <span class="k">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">uni</span><span class="o">).</span><span class="n">getMatrix</span><span class="o">(</span><span class="s">"baseStats"</span><span class="o">)</span>
<span class="n">baseStats</span><span class="o">.</span><span class="n">toRDDStringIJV</span><span class="o">.</span><span class="n">collect</span><span class="o">.</span><span class="n">slice</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span><span class="mi">9</span><span class="o">).</span><span class="n">foreach</span><span class="o">(</span><span class="n">println</span><span class="o">)</span></code></pre></div>

  </div>

<div data-lang="Spark Shell">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">uni</span> <span class="k">=</span> <span class="n">dmlFromUrl</span><span class="o">(</span><span class="n">scriptUrl</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"A"</span><span class="o">,</span> <span class="n">habermanRDD</span><span class="o">,</span> <span class="n">habermanMetadata</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"K"</span><span class="o">,</span> <span class="n">typesRDD</span><span class="o">,</span> <span class="n">typesMetadata</span><span class="o">).</span><span class="n">out</span><span class="o">(</span><span class="s">"baseStats"</span><span class="o">)</span>
<span class="n">uni</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.Script</span> <span class="o">=</span>
<span class="nc">Inputs</span><span class="k">:</span>
  <span class="err">[1]</span> <span class="o">(</span><span class="kt">RDD</span><span class="o">)</span> <span class="kt">A:</span> <span class="kt">ParallelCollectionRDD</span><span class="o">[</span><span class="err">159</span><span class="o">]</span> <span class="n">at</span> <span class="n">parallelize</span> <span class="n">at</span> <span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">43</span>
  <span class="o">[</span><span class="err">2</span><span class="o">]</span> <span class="o">(</span><span class="nc">RDD</span><span class="o">)</span> <span class="n">K</span><span class="k">:</span> <span class="kt">ParallelCollectionRDD</span><span class="o">[</span><span class="err">160</span><span class="o">]</span> <span class="n">at</span> <span class="n">parallelize</span> <span class="n">at</span> <span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">39</span>

<span class="nc">Outputs</span><span class="k">:</span>
  <span class="err">[1]</span> <span class="kt">baseStats</span>


<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">baseStats</span> <span class="k">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">uni</span><span class="o">).</span><span class="n">getMatrix</span><span class="o">(</span><span class="s">"baseStats"</span><span class="o">)</span>
<span class="o">...</span>
<span class="n">baseStats</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.Matrix</span> <span class="o">=</span> <span class="nc">Matrix</span><span class="k">:</span> <span class="kt">scratch_space/</span><span class="k">_</span><span class="kt">p12059_9.</span><span class="err">31</span><span class="kt">.</span><span class="err">117</span><span class="kt">.</span><span class="err">12</span><span class="kt">/parfor/</span><span class="err">4</span><span class="k">_</span><span class="kt">resultmerge1</span><span class="o">,</span> <span class="o">[</span><span class="err">17</span> <span class="kt">x</span> <span class="err">4</span>, <span class="kt">nnz=</span><span class="err">44</span>, <span class="kt">blocks</span> <span class="o">(</span><span class="err">1000</span> <span class="kt">x</span> <span class="err">1000</span><span class="o">)],</span> <span class="n">binaryblock</span><span class="o">,</span> <span class="n">dirty</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">baseStats</span><span class="o">.</span><span class="n">toRDDStringIJV</span><span class="o">.</span><span class="n">collect</span><span class="o">.</span><span class="n">slice</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span><span class="mi">9</span><span class="o">).</span><span class="n">foreach</span><span class="o">(</span><span class="n">println</span><span class="o">)</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mf">30.0</span>
<span class="mi">1</span> <span class="mi">2</span> <span class="mf">58.0</span>
<span class="mi">1</span> <span class="mi">3</span> <span class="mf">0.0</span>
<span class="mi">1</span> <span class="mi">4</span> <span class="mf">0.0</span>
<span class="mi">2</span> <span class="mi">1</span> <span class="mf">83.0</span>
<span class="mi">2</span> <span class="mi">2</span> <span class="mf">69.0</span>
<span class="mi">2</span> <span class="mi">3</span> <span class="mf">52.0</span>
<span class="mi">2</span> <span class="mi">4</span> <span class="mf">0.0</span>
<span class="mi">3</span> <span class="mi">1</span> <span class="mf">53.0</span></code></pre></div>

  </div>

<div data-lang="Python">

    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">uni</span> <span class="o">=</span> <span class="n">dmlFromUrl</span><span class="p">(</span><span class="n">scriptUrl</span><span class="p">)</span><span class="o">.</span><span class="nb">input</span><span class="p">(</span><span class="n">A</span><span class="o">=</span><span class="n">habermanRDD</span><span class="p">,</span> <span class="n">K</span><span class="o">=</span><span class="n">typesRDD</span><span class="p">)</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="s">"baseStats"</span><span class="p">)</span>
<span class="n">baseStats</span> <span class="o">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">uni</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"baseStats"</span><span class="p">)</span>
<span class="n">baseStats</span><span class="o">.</span><span class="n">toNumPy</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">9</span><span class="p">]</span></code></pre></div>

  </div>

<div data-lang="PySpark Shell">

    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">uni</span> <span class="o">=</span> <span class="n">dmlFromUrl</span><span class="p">(</span><span class="n">scriptUrl</span><span class="p">)</span><span class="o">.</span><span class="nb">input</span><span class="p">(</span><span class="n">A</span><span class="o">=</span><span class="n">habermanRDD</span><span class="p">,</span> <span class="n">K</span><span class="o">=</span><span class="n">typesRDD</span><span class="p">)</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="s">"baseStats"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">baseStats</span> <span class="o">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">uni</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"baseStats"</span><span class="p">)</span>
<span class="n">SystemML</span> <span class="n">Statistics</span><span class="p">:</span>
<span class="n">Total</span> <span class="n">execution</span> <span class="n">time</span><span class="p">:</span>           <span class="mf">0.690</span> <span class="n">sec</span><span class="o">.</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">executed</span> <span class="n">Spark</span> <span class="n">inst</span><span class="p">:</span>  <span class="mf">4.</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">baseStats</span><span class="o">.</span><span class="n">toNumPy</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">9</span><span class="p">]</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">30.</span><span class="p">,</span>  <span class="mf">58.</span><span class="p">,</span>   <span class="mf">0.</span><span class="p">,</span>   <span class="mf">0.</span><span class="p">,</span>  <span class="mf">83.</span><span class="p">,</span>  <span class="mf">69.</span><span class="p">,</span>  <span class="mf">52.</span><span class="p">,</span>   <span class="mf">0.</span><span class="p">,</span>  <span class="mf">53.</span><span class="p">])</span></code></pre></div>

  </div>

</div>

<h2 id="script-information">Script Information</h2>

<p>The <code>info</code> method on a Script object can provide useful information about a DML or PyDML script, such as
the inputs, output, symbol table, script string, and the script execution string that is passed to the internals of
SystemML.</p>

<div class="codetabs">

<div data-lang="Scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">minMaxMean</span> <span class="k">=</span>
<span class="s">"""
minOut = min(Xin)
maxOut = max(Xin)
meanOut = mean(Xin)
"""</span>
<span class="k">val</span> <span class="n">minMaxMeanScript</span> <span class="k">=</span> <span class="n">dml</span><span class="o">(</span><span class="n">minMaxMean</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"Xin"</span><span class="o">,</span> <span class="n">df</span><span class="o">,</span> <span class="n">mm</span><span class="o">).</span><span class="n">out</span><span class="o">(</span><span class="s">"minOut"</span><span class="o">,</span> <span class="s">"maxOut"</span><span class="o">,</span> <span class="s">"meanOut"</span><span class="o">)</span>
<span class="k">val</span> <span class="o">(</span><span class="n">min</span><span class="o">,</span> <span class="n">max</span><span class="o">,</span> <span class="n">mean</span><span class="o">)</span> <span class="k">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">minMaxMeanScript</span><span class="o">).</span><span class="n">getTuple</span><span class="o">[</span><span class="kt">Double</span>, <span class="kt">Double</span>, <span class="kt">Double</span><span class="o">](</span><span class="s">"minOut"</span><span class="o">,</span> <span class="s">"maxOut"</span><span class="o">,</span> <span class="s">"meanOut"</span><span class="o">)</span>
<span class="n">println</span><span class="o">(</span><span class="n">minMaxMeanScript</span><span class="o">.</span><span class="n">info</span><span class="o">)</span></code></pre></div>

  </div>

<div data-lang="Spark Shell">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">minMaxMean</span> <span class="k">=</span>
     <span class="o">|</span> <span class="s">"""
     | minOut = min(Xin)
     | maxOut = max(Xin)
     | meanOut = mean(Xin)
     | """</span>
<span class="n">minMaxMean</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span>
<span class="s">"
minOut = min(Xin)
maxOut = max(Xin)
meanOut = mean(Xin)
"</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">minMaxMeanScript</span> <span class="k">=</span> <span class="n">dml</span><span class="o">(</span><span class="n">minMaxMean</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"Xin"</span><span class="o">,</span> <span class="n">df</span><span class="o">,</span> <span class="n">mm</span><span class="o">).</span><span class="n">out</span><span class="o">(</span><span class="s">"minOut"</span><span class="o">,</span> <span class="s">"maxOut"</span><span class="o">,</span> <span class="s">"meanOut"</span><span class="o">)</span>
<span class="n">minMaxMeanScript</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.Script</span> <span class="o">=</span>
<span class="nc">Inputs</span><span class="k">:</span>
  <span class="err">[1]</span> <span class="o">(</span><span class="kt">DataFrame</span><span class="o">)</span> <span class="kt">Xin:</span> <span class="err">[</span><span class="kt">C0:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C1</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C2</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C3</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C4</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C5</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C6</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C7</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="o">...</span>

<span class="nc">Outputs</span><span class="k">:</span>
  <span class="err">[1]</span> <span class="kt">minOut</span>
  <span class="o">[</span><span class="err">2</span><span class="o">]</span> <span class="n">maxOut</span>
  <span class="o">[</span><span class="err">3</span><span class="o">]</span> <span class="n">meanOut</span>


<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="o">(</span><span class="n">min</span><span class="o">,</span> <span class="n">max</span><span class="o">,</span> <span class="n">mean</span><span class="o">)</span> <span class="k">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">minMaxMeanScript</span><span class="o">).</span><span class="n">getTuple</span><span class="o">[</span><span class="kt">Double</span>, <span class="kt">Double</span>, <span class="kt">Double</span><span class="o">](</span><span class="s">"minOut"</span><span class="o">,</span> <span class="s">"maxOut"</span><span class="o">,</span> <span class="s">"meanOut"</span><span class="o">)</span>
<span class="n">min</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="mf">1.4149740823476975E-7</span>
<span class="n">max</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="mf">0.9999999956646207</span>
<span class="n">mean</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="mf">0.5000954668004209</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">println</span><span class="o">(</span><span class="n">minMaxMeanScript</span><span class="o">.</span><span class="n">info</span><span class="o">)</span>
<span class="nc">Script</span> <span class="nc">Type</span><span class="k">:</span> <span class="kt">DML</span>

<span class="nc">Inputs</span><span class="k">:</span>
  <span class="err">[1]</span> <span class="o">(</span><span class="kt">DataFrame</span><span class="o">)</span> <span class="kt">Xin:</span> <span class="err">[</span><span class="kt">C0:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C1</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C2</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C3</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C4</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C5</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C6</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C7</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="o">...</span>

<span class="nc">Outputs</span><span class="k">:</span>
  <span class="err">[1]</span> <span class="o">(</span><span class="kt">Double</span><span class="o">)</span> <span class="kt">minOut:</span> <span class="err">1</span><span class="kt">.</span><span class="err">4149740823476975</span><span class="kt">E-</span><span class="err">7</span>
  <span class="err">[2]</span> <span class="o">(</span><span class="kt">Double</span><span class="o">)</span> <span class="kt">maxOut:</span> <span class="err">0</span><span class="kt">.</span><span class="err">9999999956646207</span>
  <span class="err">[3]</span> <span class="o">(</span><span class="kt">Double</span><span class="o">)</span> <span class="kt">meanOut:</span> <span class="err">0</span><span class="kt">.</span><span class="err">5000954668004209</span>

<span class="kt">Input</span> <span class="kt">Parameters:</span>
<span class="kt">None</span>

<span class="nc">Input</span> <span class="nc">Variables</span><span class="k">:</span>
  <span class="err">[1]</span> <span class="kt">Xin</span>

<span class="nc">Output</span> <span class="nc">Variables</span><span class="k">:</span>
  <span class="err">[1]</span> <span class="kt">minOut</span>
  <span class="o">[</span><span class="err">2</span><span class="o">]</span> <span class="n">maxOut</span>
  <span class="o">[</span><span class="err">3</span><span class="o">]</span> <span class="n">meanOut</span>

<span class="nc">Symbol</span> <span class="nc">Table</span><span class="k">:</span>
  <span class="err">[1]</span> <span class="o">(</span><span class="kt">Double</span><span class="o">)</span> <span class="kt">meanOut:</span> <span class="err">0</span><span class="kt">.</span><span class="err">5000954668004209</span>
  <span class="err">[2]</span> <span class="o">(</span><span class="kt">Double</span><span class="o">)</span> <span class="kt">maxOut:</span> <span class="err">0</span><span class="kt">.</span><span class="err">9999999956646207</span>
  <span class="err">[3]</span> <span class="o">(</span><span class="kt">Double</span><span class="o">)</span> <span class="kt">minOut:</span> <span class="err">1</span><span class="kt">.</span><span class="err">4149740823476975</span><span class="kt">E-</span><span class="err">7</span>
  <span class="err">[4]</span> <span class="o">(</span><span class="kt">Matrix</span><span class="o">)</span> <span class="kt">Xin:</span> <span class="kt">Matrix:</span> <span class="kt">scratch_space/temp_1166464711339222</span><span class="o">,</span> <span class="o">[</span><span class="err">10000</span> <span class="kt">x</span> <span class="err">100</span>, <span class="kt">nnz=</span><span class="err">1000000</span>, <span class="kt">blocks</span> <span class="o">(</span><span class="err">1000</span> <span class="kt">x</span> <span class="err">1000</span><span class="o">)],</span> <span class="n">binaryblock</span><span class="o">,</span> <span class="n">not</span><span class="o">-</span><span class="n">dirty</span>

<span class="nc">Script</span> <span class="nc">String</span><span class="k">:</span>

<span class="kt">minOut</span> <span class="o">=</span> <span class="n">min</span><span class="o">(</span><span class="nc">Xin</span><span class="o">)</span>
<span class="n">maxOut</span> <span class="k">=</span> <span class="n">max</span><span class="o">(</span><span class="nc">Xin</span><span class="o">)</span>
<span class="n">meanOut</span> <span class="k">=</span> <span class="n">mean</span><span class="o">(</span><span class="nc">Xin</span><span class="o">)</span>

<span class="nc">Script</span> <span class="nc">Execution</span> <span class="nc">String</span><span class="k">:</span>
<span class="kt">Xin</span> <span class="o">=</span> <span class="n">read</span><span class="o">('');</span>

<span class="n">minOut</span> <span class="k">=</span> <span class="n">min</span><span class="o">(</span><span class="nc">Xin</span><span class="o">)</span>
<span class="n">maxOut</span> <span class="k">=</span> <span class="n">max</span><span class="o">(</span><span class="nc">Xin</span><span class="o">)</span>
<span class="n">meanOut</span> <span class="k">=</span> <span class="n">mean</span><span class="o">(</span><span class="nc">Xin</span><span class="o">)</span>
<span class="n">write</span><span class="o">(</span><span class="n">minOut</span><span class="o">,</span> <span class="o">'');</span>
<span class="n">write</span><span class="o">(</span><span class="n">maxOut</span><span class="o">,</span> <span class="o">'');</span>
<span class="n">write</span><span class="o">(</span><span class="n">meanOut</span><span class="o">,</span> <span class="o">'');</span></code></pre></div>

  </div>

<div data-lang="Python">

    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">minMaxMean</span> <span class="o">=</span> <span class="s">"""
minOut = min(Xin)
maxOut = max(Xin)
meanOut = mean(Xin)
"""</span>
<span class="n">minMaxMeanScript</span> <span class="o">=</span> <span class="n">dml</span><span class="p">(</span><span class="n">minMaxMean</span><span class="p">)</span><span class="o">.</span><span class="nb">input</span><span class="p">(</span><span class="n">Xin</span> <span class="o">=</span> <span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="s">"minOut"</span><span class="p">,</span> <span class="s">"maxOut"</span><span class="p">,</span> <span class="s">"meanOut"</span><span class="p">)</span>
<span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">,</span> <span class="n">mean</span> <span class="o">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">minMaxMeanScript</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"minOut"</span><span class="p">,</span> <span class="s">"maxOut"</span><span class="p">,</span> <span class="s">"meanOut"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">minMaxMeanScript</span><span class="o">.</span><span class="n">info</span><span class="p">())</span></code></pre></div>

  </div>

<div data-lang="PySpark Shell">

    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">minMaxMean</span> <span class="o">=</span> <span class="s">"""
... minOut = min(Xin)
... maxOut = max(Xin)
... meanOut = mean(Xin)
... """</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">minMaxMeanScript</span> <span class="o">=</span> <span class="n">dml</span><span class="p">(</span><span class="n">minMaxMean</span><span class="p">)</span><span class="o">.</span><span class="nb">input</span><span class="p">(</span><span class="n">Xin</span> <span class="o">=</span> <span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="s">"minOut"</span><span class="p">,</span> <span class="s">"maxOut"</span><span class="p">,</span> <span class="s">"meanOut"</span><span class="p">)</span>
<span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">,</span> <span class="n">mean</span> <span class="o">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">minMaxMeanScript</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"minOut"</span><span class="p">,</span> <span class="s">"maxOut"</span><span class="p">,</span> <span class="s">"meanOut"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">minMaxMeanScript</span><span class="o">.</span><span class="n">info</span><span class="p">())</span><span class="o">&gt;&gt;&gt;</span> <span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">,</span> <span class="n">mean</span> <span class="o">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">minMaxMeanScript</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"minOut"</span><span class="p">,</span> <span class="s">"maxOut"</span><span class="p">,</span> <span class="s">"meanOut"</span><span class="p">)</span>

<span class="n">SystemML</span> <span class="n">Statistics</span><span class="p">:</span>
<span class="n">Total</span> <span class="n">execution</span> <span class="n">time</span><span class="p">:</span>           <span class="mf">0.521</span> <span class="n">sec</span><span class="o">.</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">executed</span> <span class="n">Spark</span> <span class="n">inst</span><span class="p">:</span>  <span class="mf">0.</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">minMaxMeanScript</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
<span class="n">Script</span> <span class="n">Type</span><span class="p">:</span> <span class="n">DML</span>

<span class="n">Inputs</span><span class="p">:</span>
  <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">(</span><span class="n">Dataset</span> <span class="k">as</span> <span class="n">Matrix</span><span class="p">)</span> <span class="n">Xin</span><span class="p">:</span> <span class="p">[</span><span class="n">C0</span><span class="p">:</span> <span class="n">double</span><span class="p">,</span> <span class="n">C1</span><span class="p">:</span> <span class="n">double</span> <span class="o">...</span> <span class="mi">98</span> <span class="n">more</span> <span class="n">fields</span><span class="p">]</span>

<span class="n">Outputs</span><span class="p">:</span>
  <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">(</span><span class="n">Double</span><span class="p">)</span> <span class="n">minOut</span><span class="p">:</span> <span class="mf">8.754858571102808E-6</span>
  <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">(</span><span class="n">Double</span><span class="p">)</span> <span class="n">maxOut</span><span class="p">:</span> <span class="mf">0.9999878908225835</span>
  <span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="p">(</span><span class="n">Double</span><span class="p">)</span> <span class="n">meanOut</span><span class="p">:</span> <span class="mf">0.49864912369337505</span>

<span class="n">Input</span> <span class="n">Parameters</span><span class="p">:</span>
<span class="bp">None</span>

<span class="n">Input</span> <span class="n">Variables</span><span class="p">:</span>
  <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">Xin</span>

<span class="n">Output</span> <span class="n">Variables</span><span class="p">:</span>
  <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">minOut</span>
  <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="n">maxOut</span>
  <span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="n">meanOut</span>

<span class="n">Symbol</span> <span class="n">Table</span><span class="p">:</span>
  <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">(</span><span class="n">Double</span><span class="p">)</span> <span class="n">meanOut</span><span class="p">:</span> <span class="mf">0.49864912369337505</span>
  <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">(</span><span class="n">Double</span><span class="p">)</span> <span class="n">maxOut</span><span class="p">:</span> <span class="mf">0.9999878908225835</span>
  <span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="p">(</span><span class="n">Double</span><span class="p">)</span> <span class="n">minOut</span><span class="p">:</span> <span class="mf">8.754858571102808E-6</span>
  <span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="p">(</span><span class="n">Matrix</span><span class="p">)</span> <span class="n">Xin</span><span class="p">:</span> <span class="n">MatrixObject</span><span class="p">:</span> <span class="n">scratch_space</span><span class="o">/</span><span class="n">_p20299_10</span><span class="o">.</span><span class="mf">168.31</span><span class="o">.</span><span class="mi">110</span><span class="o">/</span><span class="n">_t0</span><span class="o">/</span><span class="n">temp283</span><span class="p">,</span> <span class="p">[</span><span class="mi">10000</span> <span class="n">x</span> <span class="mi">100</span><span class="p">,</span> <span class="n">nnz</span><span class="o">=</span><span class="mi">1000000</span><span class="p">,</span> <span class="n">blocks</span> <span class="p">(</span><span class="mi">1000</span> <span class="n">x</span> <span class="mi">1000</span><span class="p">)],</span> <span class="n">binaryblock</span><span class="p">,</span> <span class="ow">not</span><span class="o">-</span><span class="n">dirty</span>

<span class="n">Script</span> <span class="n">String</span><span class="p">:</span>

<span class="n">minOut</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">Xin</span><span class="p">)</span>
<span class="n">maxOut</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">Xin</span><span class="p">)</span>
<span class="n">meanOut</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">Xin</span><span class="p">)</span>

<span class="n">Script</span> <span class="n">Execution</span> <span class="n">String</span><span class="p">:</span>
<span class="n">Xin</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="s">''</span><span class="p">);</span>

<span class="n">minOut</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">Xin</span><span class="p">)</span>
<span class="n">maxOut</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">Xin</span><span class="p">)</span>
<span class="n">meanOut</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">Xin</span><span class="p">)</span>
<span class="n">write</span><span class="p">(</span><span class="n">minOut</span><span class="p">,</span> <span class="s">''</span><span class="p">);</span>
<span class="n">write</span><span class="p">(</span><span class="n">maxOut</span><span class="p">,</span> <span class="s">''</span><span class="p">);</span>
<span class="n">write</span><span class="p">(</span><span class="n">meanOut</span><span class="p">,</span> <span class="s">''</span><span class="p">);</span>


<span class="o">&gt;&gt;&gt;</span></code></pre></div>

  </div>

</div>

<h2 id="clearing-scripts-and-mlcontext">Clearing Scripts and MLContext</h2>

<p>Dealing with large matrices can require a significant amount of memory. To deal help deal with this, you
can call a Script object&#8217;s <code>clearAll</code> method to clear the inputs, outputs, symbol table, and script string.
In terms of memory, the symbol table is most important because it holds references to matrices.</p>

<p>In this example, we display the symbol table of the <code>minMaxMeanScript</code>, call <code>clearAll</code> on the script, and
then display the symbol table, which is empty.</p>

<div class="codetabs">

<div data-lang="Scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">println</span><span class="o">(</span><span class="n">minMaxMeanScript</span><span class="o">.</span><span class="n">displaySymbolTable</span><span class="o">)</span>
<span class="n">minMaxMeanScript</span><span class="o">.</span><span class="n">clearAll</span>
<span class="n">println</span><span class="o">(</span><span class="n">minMaxMeanScript</span><span class="o">.</span><span class="n">displaySymbolTable</span><span class="o">)</span></code></pre></div>

  </div>

<div data-lang="Spark Shell">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="n">println</span><span class="o">(</span><span class="n">minMaxMeanScript</span><span class="o">.</span><span class="n">displaySymbolTable</span><span class="o">)</span>
<span class="nc">Symbol</span> <span class="nc">Table</span><span class="k">:</span>
  <span class="err">[1]</span> <span class="o">(</span><span class="kt">Double</span><span class="o">)</span> <span class="kt">meanOut:</span> <span class="err">0</span><span class="kt">.</span><span class="err">5000954668004209</span>
  <span class="err">[2]</span> <span class="o">(</span><span class="kt">Double</span><span class="o">)</span> <span class="kt">maxOut:</span> <span class="err">0</span><span class="kt">.</span><span class="err">9999999956646207</span>
  <span class="err">[3]</span> <span class="o">(</span><span class="kt">Double</span><span class="o">)</span> <span class="kt">minOut:</span> <span class="err">1</span><span class="kt">.</span><span class="err">4149740823476975</span><span class="kt">E-</span><span class="err">7</span>
  <span class="err">[4]</span> <span class="o">(</span><span class="kt">Matrix</span><span class="o">)</span> <span class="kt">Xin:</span> <span class="kt">Matrix:</span> <span class="kt">scratch_space/temp_1166464711339222</span><span class="o">,</span> <span class="o">[</span><span class="err">10000</span> <span class="kt">x</span> <span class="err">100</span>, <span class="kt">nnz=</span><span class="err">1000000</span>, <span class="kt">blocks</span> <span class="o">(</span><span class="err">1000</span> <span class="kt">x</span> <span class="err">1000</span><span class="o">)],</span> <span class="n">binaryblock</span><span class="o">,</span> <span class="n">not</span><span class="o">-</span><span class="n">dirty</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">minMaxMeanScript</span><span class="o">.</span><span class="n">clearAll</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">println</span><span class="o">(</span><span class="n">minMaxMeanScript</span><span class="o">.</span><span class="n">displaySymbolTable</span><span class="o">)</span>
<span class="nc">Symbol</span> <span class="nc">Table</span><span class="k">:</span>
<span class="kt">None</span></code></pre></div>

  </div>

<div data-lang="Python">

    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">print</span><span class="p">(</span><span class="n">minMaxMeanScript</span><span class="o">.</span><span class="n">displaySymbolTable</span><span class="p">())</span>
<span class="n">minMaxMeanScript</span><span class="o">.</span><span class="n">clearAll</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">minMaxMeanScript</span><span class="o">.</span><span class="n">displaySymbolTable</span><span class="p">())</span></code></pre></div>

  </div>

<div data-lang="PySpark Shell">

    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">minMaxMeanScript</span><span class="o">.</span><span class="n">displaySymbolTable</span><span class="p">())</span>
<span class="n">Symbol</span> <span class="n">Table</span><span class="p">:</span>
  <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">(</span><span class="n">Double</span><span class="p">)</span> <span class="n">meanOut</span><span class="p">:</span> <span class="mf">0.49825964615525964</span>
  <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">(</span><span class="n">Double</span><span class="p">)</span> <span class="n">maxOut</span><span class="p">:</span> <span class="mf">0.9999420388455621</span>
  <span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="p">(</span><span class="n">Double</span><span class="p">)</span> <span class="n">minOut</span><span class="p">:</span> <span class="mf">2.177681068027404E-5</span>
  <span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="p">(</span><span class="n">Matrix</span><span class="p">)</span> <span class="n">Xin</span><span class="p">:</span> <span class="n">MatrixObject</span><span class="p">:</span> <span class="n">scratch_space</span><span class="o">/</span><span class="n">_p30346_10</span><span class="o">.</span><span class="mf">168.31</span><span class="o">.</span><span class="mi">110</span><span class="o">/</span><span class="n">_t0</span><span class="o">/</span><span class="n">temp0</span><span class="p">,</span> <span class="p">[</span><span class="mi">10000</span> <span class="n">x</span> <span class="mi">100</span><span class="p">,</span> <span class="n">nnz</span><span class="o">=</span><span class="mi">1000000</span><span class="p">,</span> <span class="n">blocks</span> <span class="p">(</span><span class="mi">1000</span> <span class="n">x</span> <span class="mi">1000</span><span class="p">)],</span> <span class="n">binaryblock</span><span class="p">,</span> <span class="ow">not</span><span class="o">-</span><span class="n">dirty</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">minMaxMeanScript</span><span class="o">.</span><span class="n">clearAll</span><span class="p">()</span>
<span class="n">Script</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">minMaxMeanScript</span><span class="o">.</span><span class="n">displaySymbolTable</span><span class="p">())</span>
<span class="n">Symbol</span> <span class="n">Table</span><span class="p">:</span>
<span class="bp">None</span>

<span class="o">&gt;&gt;&gt;</span></code></pre></div>

  </div>
</div>

<p>The MLContext object holds references to the scripts that have been executed. Calling <code>clear</code> on
the MLContext clears all scripts that it has references to and then removes the references to these
scripts.</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">ml</span><span class="o">.</span><span class="n">clear</span></code></pre></div>

<h2 id="statistics">Statistics</h2>

<p>Statistics about script executions can be output to the console by calling MLContext&#8217;s <code>setStatistics</code>
method with a value of <code>true</code>.</p>

<div class="codetabs">

<div data-lang="Scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">ml</span><span class="o">.</span><span class="n">setStatistics</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>
<span class="k">val</span> <span class="n">minMaxMean</span> <span class="k">=</span>
<span class="s">"""
minOut = min(Xin)
maxOut = max(Xin)
meanOut = mean(Xin)
"""</span>
<span class="k">val</span> <span class="n">minMaxMeanScript</span> <span class="k">=</span> <span class="n">dml</span><span class="o">(</span><span class="n">minMaxMean</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"Xin"</span><span class="o">,</span> <span class="n">df</span><span class="o">,</span> <span class="n">mm</span><span class="o">).</span><span class="n">out</span><span class="o">(</span><span class="s">"minOut"</span><span class="o">,</span> <span class="s">"maxOut"</span><span class="o">,</span> <span class="s">"meanOut"</span><span class="o">)</span>
<span class="k">val</span> <span class="o">(</span><span class="n">min</span><span class="o">,</span> <span class="n">max</span><span class="o">,</span> <span class="n">mean</span><span class="o">)</span> <span class="k">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">minMaxMeanScript</span><span class="o">).</span><span class="n">getTuple</span><span class="o">[</span><span class="kt">Double</span>, <span class="kt">Double</span>, <span class="kt">Double</span><span class="o">](</span><span class="s">"minOut"</span><span class="o">,</span> <span class="s">"maxOut"</span><span class="o">,</span> <span class="s">"meanOut"</span><span class="o">)</span></code></pre></div>

  </div>

<div data-lang="Spark Shell">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="n">ml</span><span class="o">.</span><span class="n">setStatistics</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">minMaxMean</span> <span class="k">=</span>
     <span class="o">|</span> <span class="s">"""
     | minOut = min(Xin)
     | maxOut = max(Xin)
     | meanOut = mean(Xin)
     | """</span>
<span class="n">minMaxMean</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span>
<span class="s">"
minOut = min(Xin)
maxOut = max(Xin)
meanOut = mean(Xin)
"</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">minMaxMeanScript</span> <span class="k">=</span> <span class="n">dml</span><span class="o">(</span><span class="n">minMaxMean</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"Xin"</span><span class="o">,</span> <span class="n">df</span><span class="o">,</span> <span class="n">mm</span><span class="o">).</span><span class="n">out</span><span class="o">(</span><span class="s">"minOut"</span><span class="o">,</span> <span class="s">"maxOut"</span><span class="o">,</span> <span class="s">"meanOut"</span><span class="o">)</span>
<span class="n">minMaxMeanScript</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.Script</span> <span class="o">=</span>
<span class="nc">Inputs</span><span class="k">:</span>
  <span class="err">[1]</span> <span class="o">(</span><span class="kt">DataFrame</span><span class="o">)</span> <span class="kt">Xin:</span> <span class="err">[</span><span class="kt">C0:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C1</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C2</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C3</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C4</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C5</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C6</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C7</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="o">...</span>

<span class="nc">Outputs</span><span class="k">:</span>
  <span class="err">[1]</span> <span class="kt">minOut</span>
  <span class="o">[</span><span class="err">2</span><span class="o">]</span> <span class="n">maxOut</span>
  <span class="o">[</span><span class="err">3</span><span class="o">]</span> <span class="n">meanOut</span>


<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="o">(</span><span class="n">min</span><span class="o">,</span> <span class="n">max</span><span class="o">,</span> <span class="n">mean</span><span class="o">)</span> <span class="k">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">minMaxMeanScript</span><span class="o">).</span><span class="n">getTuple</span><span class="o">[</span><span class="kt">Double</span>, <span class="kt">Double</span>, <span class="kt">Double</span><span class="o">](</span><span class="s">"minOut"</span><span class="o">,</span> <span class="s">"maxOut"</span><span class="o">,</span> <span class="s">"meanOut"</span><span class="o">)</span>
<span class="nc">SystemML</span> <span class="nc">Statistics</span><span class="k">:</span>
<span class="kt">Total</span> <span class="kt">elapsed</span> <span class="kt">time:</span>		<span class="err">0</span><span class="kt">.</span><span class="err">000</span> <span class="kt">sec.</span>
<span class="kt">Total</span> <span class="kt">compilation</span> <span class="kt">time:</span>		<span class="err">0</span><span class="kt">.</span><span class="err">000</span> <span class="kt">sec.</span>
<span class="kt">Total</span> <span class="kt">execution</span> <span class="kt">time:</span>		<span class="err">0</span><span class="kt">.</span><span class="err">000</span> <span class="kt">sec.</span>
<span class="kt">Number</span> <span class="kt">of</span> <span class="kt">compiled</span> <span class="kt">Spark</span> <span class="kt">inst:</span>	<span class="err">0</span><span class="kt">.</span>
<span class="kt">Number</span> <span class="kt">of</span> <span class="kt">executed</span> <span class="kt">Spark</span> <span class="kt">inst:</span>	<span class="err">0</span><span class="kt">.</span>
<span class="kt">Cache</span> <span class="kt">hits</span> <span class="o">(</span><span class="kt">Mem</span><span class="o">,</span> <span class="kt">WB</span><span class="o">,</span> <span class="nc">FS</span><span class="o">,</span> <span class="nc">HDFS</span><span class="o">)</span><span class="k">:</span>	<span class="err">2</span><span class="kt">/</span><span class="err">0</span><span class="kt">/</span><span class="err">0</span><span class="kt">/</span><span class="err">1</span><span class="kt">.</span>
<span class="kt">Cache</span> <span class="kt">writes</span> <span class="o">(</span><span class="kt">WB</span><span class="o">,</span> <span class="kt">FS</span><span class="o">,</span> <span class="nc">HDFS</span><span class="o">)</span><span class="k">:</span>	<span class="err">1</span><span class="kt">/</span><span class="err">0</span><span class="kt">/</span><span class="err">0</span><span class="kt">.</span>
<span class="kt">Cache</span> <span class="kt">times</span> <span class="o">(</span><span class="kt">ACQr/m</span><span class="o">,</span> <span class="kt">RLS</span><span class="o">,</span> <span class="nc">EXP</span><span class="o">)</span><span class="k">:</span>	<span class="err">3</span><span class="kt">.</span><span class="err">137</span><span class="kt">/</span><span class="err">0</span><span class="kt">.</span><span class="err">000</span><span class="kt">/</span><span class="err">0</span><span class="kt">.</span><span class="err">001</span><span class="kt">/</span><span class="err">0</span><span class="kt">.</span><span class="err">000</span> <span class="kt">sec.</span>
<span class="kt">HOP</span> <span class="kt">DAGs</span> <span class="kt">recompiled</span> <span class="o">(</span><span class="kt">PRED</span><span class="o">,</span> <span class="kt">SB</span><span class="o">)</span><span class="k">:</span>	<span class="err">0</span><span class="kt">/</span><span class="err">0</span><span class="kt">.</span>
<span class="kt">HOP</span> <span class="kt">DAGs</span> <span class="kt">recompile</span> <span class="kt">time:</span>	<span class="err">0</span><span class="kt">.</span><span class="err">000</span> <span class="kt">sec.</span>
<span class="kt">Spark</span> <span class="kt">ctx</span> <span class="kt">create</span> <span class="kt">time</span> <span class="o">(</span><span class="kt">lazy</span><span class="o">)</span><span class="kt">:</span>	<span class="err">0</span><span class="kt">.</span><span class="err">000</span> <span class="kt">sec.</span>
<span class="kt">Spark</span> <span class="kt">trans</span> <span class="kt">counts</span> <span class="o">(</span><span class="kt">par</span><span class="o">,</span><span class="kt">bc</span><span class="o">,</span><span class="n">col</span><span class="o">)</span><span class="k">:</span><span class="err">0</span><span class="kt">/</span><span class="err">0</span><span class="kt">/</span><span class="err">2</span><span class="kt">.</span>
<span class="kt">Spark</span> <span class="kt">trans</span> <span class="kt">times</span> <span class="o">(</span><span class="kt">par</span><span class="o">,</span><span class="kt">bc</span><span class="o">,</span><span class="n">col</span><span class="o">)</span><span class="k">:</span>	<span class="err">0</span><span class="kt">.</span><span class="err">000</span><span class="kt">/</span><span class="err">0</span><span class="kt">.</span><span class="err">000</span><span class="kt">/</span><span class="err">6</span><span class="kt">.</span><span class="err">434</span> <span class="kt">secs.</span>
<span class="kt">Total</span> <span class="kt">JIT</span> <span class="kt">compile</span> <span class="kt">time:</span>		<span class="err">112</span><span class="kt">.</span><span class="err">372</span> <span class="kt">sec.</span>
<span class="kt">Total</span> <span class="kt">JVM</span> <span class="kt">GC</span> <span class="kt">count:</span>		<span class="err">54</span><span class="kt">.</span>
<span class="kt">Total</span> <span class="kt">JVM</span> <span class="kt">GC</span> <span class="kt">time:</span>		<span class="err">9</span><span class="kt">.</span><span class="err">664</span> <span class="kt">sec.</span>
<span class="kt">Heavy</span> <span class="kt">hitter</span> <span class="kt">instructions</span> <span class="o">(</span><span class="kt">name</span><span class="o">,</span> <span class="kt">time</span><span class="o">,</span> <span class="n">count</span><span class="o">)</span><span class="k">:</span>
<span class="kt">--</span> <span class="err">1</span><span class="o">)</span> 	<span class="n">uamin</span> 	<span class="mf">3.150</span> <span class="n">sec</span> 	<span class="mi">1</span>
<span class="o">--</span> <span class="mi">2</span><span class="o">)</span> 	<span class="n">uamean</span> 	<span class="mf">0.021</span> <span class="n">sec</span> 	<span class="mi">1</span>
<span class="o">--</span> <span class="mi">3</span><span class="o">)</span> 	<span class="n">uamax</span> 	<span class="mf">0.017</span> <span class="n">sec</span> 	<span class="mi">1</span>
<span class="o">--</span> <span class="mi">4</span><span class="o">)</span> 	<span class="n">rmvar</span> 	<span class="mf">0.000</span> <span class="n">sec</span> 	<span class="mi">3</span>
<span class="o">--</span> <span class="mi">5</span><span class="o">)</span> 	<span class="n">assignvar</span> 	<span class="mf">0.000</span> <span class="n">sec</span> 	<span class="mi">3</span>

<span class="n">min</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="mf">2.4982850344024143E-8</span>
<span class="n">max</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="mf">0.9999997007231808</span>
<span class="n">mean</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="mf">0.5002109404821844</span></code></pre></div>

  </div>

<div data-lang="Python">

    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">ml</span><span class="o">.</span><span class="n">setStatistics</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">minMaxMean</span> <span class="o">=</span> <span class="s">"""
minOut = min(Xin)
maxOut = max(Xin)
meanOut = mean(Xin)
"""</span>
<span class="n">minMaxMeanScript</span> <span class="o">=</span> <span class="n">dml</span><span class="p">(</span><span class="n">minMaxMean</span><span class="p">)</span><span class="o">.</span><span class="nb">input</span><span class="p">(</span><span class="n">Xin</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="s">"minOut"</span><span class="p">,</span> <span class="s">"maxOut"</span><span class="p">,</span> <span class="s">"meanOut"</span><span class="p">)</span>
<span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">,</span> <span class="n">mean</span> <span class="o">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">minMaxMeanScript</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"minOut"</span><span class="p">,</span> <span class="s">"maxOut"</span><span class="p">,</span> <span class="s">"meanOut"</span><span class="p">)</span></code></pre></div>

  </div>

<div data-lang="PySpark Shell">

    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">ml</span><span class="o">.</span><span class="n">setStatistics</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">MLContext</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">minMaxMean</span> <span class="o">=</span> <span class="s">"""
... minOut = min(Xin)
... maxOut = max(Xin)
... meanOut = mean(Xin)
... """</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">minMaxMeanScript</span> <span class="o">=</span> <span class="n">dml</span><span class="p">(</span><span class="n">minMaxMean</span><span class="p">)</span><span class="o">.</span><span class="nb">input</span><span class="p">(</span><span class="n">Xin</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="s">"minOut"</span><span class="p">,</span> <span class="s">"maxOut"</span><span class="p">,</span> <span class="s">"meanOut"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">,</span> <span class="n">mean</span> <span class="o">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">minMaxMeanScript</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"minOut"</span><span class="p">,</span> <span class="s">"maxOut"</span><span class="p">,</span> <span class="s">"meanOut"</span><span class="p">)</span>
<span class="n">SystemML</span> <span class="n">Statistics</span><span class="p">:</span>
<span class="n">Total</span> <span class="n">elapsed</span> <span class="n">time</span><span class="p">:</span>             <span class="mf">0.608</span> <span class="n">sec</span><span class="o">.</span>
<span class="n">Total</span> <span class="n">compilation</span> <span class="n">time</span><span class="p">:</span>         <span class="mf">0.000</span> <span class="n">sec</span><span class="o">.</span>
<span class="n">Total</span> <span class="n">execution</span> <span class="n">time</span><span class="p">:</span>           <span class="mf">0.608</span> <span class="n">sec</span><span class="o">.</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">compiled</span> <span class="n">Spark</span> <span class="n">inst</span><span class="p">:</span>  <span class="mf">0.</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">executed</span> <span class="n">Spark</span> <span class="n">inst</span><span class="p">:</span>  <span class="mf">0.</span>
<span class="n">Cache</span> <span class="n">hits</span> <span class="p">(</span><span class="n">Mem</span><span class="p">,</span> <span class="n">WB</span><span class="p">,</span> <span class="n">FS</span><span class="p">,</span> <span class="n">HDFS</span><span class="p">):</span> <span class="mi">2</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mf">1.</span>
<span class="n">Cache</span> <span class="n">writes</span> <span class="p">(</span><span class="n">WB</span><span class="p">,</span> <span class="n">FS</span><span class="p">,</span> <span class="n">HDFS</span><span class="p">):</span>    <span class="mi">1</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mf">0.</span>
<span class="n">Cache</span> <span class="n">times</span> <span class="p">(</span><span class="n">ACQr</span><span class="o">/</span><span class="n">m</span><span class="p">,</span> <span class="n">RLS</span><span class="p">,</span> <span class="n">EXP</span><span class="p">):</span> <span class="mf">0.586</span><span class="o">/</span><span class="mf">0.000</span><span class="o">/</span><span class="mf">0.000</span><span class="o">/</span><span class="mf">0.000</span> <span class="n">sec</span><span class="o">.</span>
<span class="n">HOP</span> <span class="n">DAGs</span> <span class="n">recompiled</span> <span class="p">(</span><span class="n">PRED</span><span class="p">,</span> <span class="n">SB</span><span class="p">):</span> <span class="mi">0</span><span class="o">/</span><span class="mf">0.</span>
<span class="n">HOP</span> <span class="n">DAGs</span> <span class="n">recompile</span> <span class="n">time</span><span class="p">:</span>        <span class="mf">0.000</span> <span class="n">sec</span><span class="o">.</span>
<span class="n">Spark</span> <span class="n">ctx</span> <span class="n">create</span> <span class="n">time</span> <span class="p">(</span><span class="n">lazy</span><span class="p">):</span>   <span class="mf">0.000</span> <span class="n">sec</span><span class="o">.</span>
<span class="n">Spark</span> <span class="n">trans</span> <span class="n">counts</span> <span class="p">(</span><span class="n">par</span><span class="p">,</span><span class="n">bc</span><span class="p">,</span><span class="n">col</span><span class="p">):</span><span class="mi">0</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mf">1.</span>
<span class="n">Spark</span> <span class="n">trans</span> <span class="n">times</span> <span class="p">(</span><span class="n">par</span><span class="p">,</span><span class="n">bc</span><span class="p">,</span><span class="n">col</span><span class="p">):</span> <span class="mf">0.000</span><span class="o">/</span><span class="mf">0.000</span><span class="o">/</span><span class="mf">0.586</span> <span class="n">secs</span><span class="o">.</span>
<span class="n">Total</span> <span class="n">JIT</span> <span class="nb">compile</span> <span class="n">time</span><span class="p">:</span>         <span class="mf">1.289</span> <span class="n">sec</span><span class="o">.</span>
<span class="n">Total</span> <span class="n">JVM</span> <span class="n">GC</span> <span class="n">count</span><span class="p">:</span>             <span class="mf">17.</span>
<span class="n">Total</span> <span class="n">JVM</span> <span class="n">GC</span> <span class="n">time</span><span class="p">:</span>              <span class="mf">0.4</span> <span class="n">sec</span><span class="o">.</span>
<span class="n">Heavy</span> <span class="n">hitter</span> <span class="n">instructions</span><span class="p">:</span>
 <span class="c">#  Instruction  Time(s)  Count</span>
 <span class="mi">1</span>  <span class="n">uamin</span>          <span class="mf">0.588</span>      <span class="mi">1</span>
 <span class="mi">2</span>  <span class="n">uamean</span>         <span class="mf">0.018</span>      <span class="mi">1</span>
 <span class="mi">3</span>  <span class="n">uamax</span>          <span class="mf">0.002</span>      <span class="mi">1</span>
 <span class="mi">4</span>  <span class="n">assignvar</span>      <span class="mf">0.000</span>      <span class="mi">3</span>
 <span class="mi">5</span>  <span class="n">rmvar</span>          <span class="mf">0.000</span>      <span class="mi">1</span>

<span class="o">&gt;&gt;&gt;</span></code></pre></div>

  </div>

</div>

<h2 id="gpu">GPU</h2>

<p>If the driver node has a GPU, SystemML may be able to utilize it, subject to memory constraints and what instructions are used in the dml script</p>

<div class="codetabs">

<div data-lang="Scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">ml</span><span class="o">.</span><span class="n">setGPU</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>
<span class="n">ml</span><span class="o">.</span><span class="n">setStatistics</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>
<span class="k">val</span> <span class="n">matMultScript</span> <span class="k">=</span> <span class="n">dml</span><span class="o">(</span><span class="s">"""
A = rand(rows=10, cols=1000)
B = rand(rows=1000, cols=10)
C = A %*% B
print(toString(C))
"""</span><span class="o">)</span>
<span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">matMultScript</span><span class="o">)</span></code></pre></div>

  </div>

<div data-lang="Spark Shell">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="n">ml</span><span class="o">.</span><span class="n">setGPU</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">ml</span><span class="o">.</span><span class="n">setStatistics</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">matMultScript</span> <span class="k">=</span> <span class="n">dml</span><span class="o">(</span><span class="s">"""
     | A = rand(rows=10, cols=1000)
     | B = rand(rows=1000, cols=10)
     | C = A %*% B
     | print(toString(C))
     | """</span><span class="o">)</span>
<span class="n">matMultScript</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.Script</span> <span class="o">=</span>
<span class="nc">Inputs</span><span class="k">:</span>
<span class="kt">None</span>

<span class="nc">Outputs</span><span class="k">:</span>
<span class="kt">None</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">matMultScript</span><span class="o">)</span>
<span class="mf">249.977</span> <span class="mf">238.545</span> <span class="mf">233.700</span> <span class="mf">234.489</span> <span class="mf">248.556</span> <span class="mf">244.423</span> <span class="mf">249.051</span> <span class="mf">255.043</span> <span class="mf">249.117</span> <span class="mf">251.605</span>
<span class="mf">249.226</span> <span class="mf">248.680</span> <span class="mf">245.532</span> <span class="mf">238.258</span> <span class="mf">254.451</span> <span class="mf">249.827</span> <span class="mf">260.957</span> <span class="mf">251.273</span> <span class="mf">250.577</span> <span class="mf">257.571</span>
<span class="mf">258.703</span> <span class="mf">246.969</span> <span class="mf">243.463</span> <span class="mf">246.547</span> <span class="mf">250.784</span> <span class="mf">251.758</span> <span class="mf">251.654</span> <span class="mf">258.318</span> <span class="mf">251.817</span> <span class="mf">254.097</span>
<span class="mf">248.788</span> <span class="mf">242.960</span> <span class="mf">230.920</span> <span class="mf">244.026</span> <span class="mf">249.159</span> <span class="mf">247.998</span> <span class="mf">251.330</span> <span class="mf">254.718</span> <span class="mf">248.013</span> <span class="mf">255.706</span>
<span class="mf">253.251</span> <span class="mf">248.788</span> <span class="mf">235.785</span> <span class="mf">242.941</span> <span class="mf">252.096</span> <span class="mf">248.675</span> <span class="mf">256.865</span> <span class="mf">251.677</span> <span class="mf">252.872</span> <span class="mf">250.490</span>
<span class="mf">256.087</span> <span class="mf">245.035</span> <span class="mf">234.124</span> <span class="mf">238.307</span> <span class="mf">248.630</span> <span class="mf">252.522</span> <span class="mf">251.122</span> <span class="mf">251.577</span> <span class="mf">249.171</span> <span class="mf">247.974</span>
<span class="mf">245.419</span> <span class="mf">243.114</span> <span class="mf">232.262</span> <span class="mf">239.776</span> <span class="mf">249.583</span> <span class="mf">242.351</span> <span class="mf">250.972</span> <span class="mf">249.244</span> <span class="mf">246.729</span> <span class="mf">251.807</span>
<span class="mf">250.081</span> <span class="mf">242.367</span> <span class="mf">230.334</span> <span class="mf">240.955</span> <span class="mf">248.332</span> <span class="mf">240.730</span> <span class="mf">246.940</span> <span class="mf">250.396</span> <span class="mf">244.107</span> <span class="mf">249.729</span>
<span class="mf">247.368</span> <span class="mf">239.882</span> <span class="mf">234.353</span> <span class="mf">237.087</span> <span class="mf">252.337</span> <span class="mf">248.801</span> <span class="mf">246.627</span> <span class="mf">249.077</span> <span class="mf">244.305</span> <span class="mf">245.621</span>
<span class="mf">252.827</span> <span class="mf">257.352</span> <span class="mf">239.546</span> <span class="mf">246.529</span> <span class="mf">258.916</span> <span class="mf">255.612</span> <span class="mf">260.480</span> <span class="mf">254.805</span> <span class="mf">252.695</span> <span class="mf">257.531</span>

<span class="nc">SystemML</span> <span class="nc">Statistics</span><span class="k">:</span>
<span class="kt">Total</span> <span class="kt">elapsed</span> <span class="kt">time:</span>		<span class="err">0</span><span class="kt">.</span><span class="err">000</span> <span class="kt">sec.</span>
<span class="kt">Total</span> <span class="kt">compilation</span> <span class="kt">time:</span>		<span class="err">0</span><span class="kt">.</span><span class="err">000</span> <span class="kt">sec.</span>
<span class="kt">Total</span> <span class="kt">execution</span> <span class="kt">time:</span>		<span class="err">0</span><span class="kt">.</span><span class="err">000</span> <span class="kt">sec.</span>
<span class="kt">Number</span> <span class="kt">of</span> <span class="kt">compiled</span> <span class="kt">Spark</span> <span class="kt">inst:</span>	<span class="err">0</span><span class="kt">.</span>
<span class="kt">Number</span> <span class="kt">of</span> <span class="kt">executed</span> <span class="kt">Spark</span> <span class="kt">inst:</span>	<span class="err">0</span><span class="kt">.</span>
<span class="kt">CUDA/CuLibraries</span> <span class="kt">init</span> <span class="kt">time:</span>	<span class="err">0</span><span class="kt">.</span><span class="err">000</span><span class="kt">/</span><span class="err">0</span><span class="kt">.</span><span class="err">003</span> <span class="kt">sec.</span>
<span class="kt">Number</span> <span class="kt">of</span> <span class="kt">executed</span> <span class="kt">GPU</span> <span class="kt">inst:</span>	<span class="err">8</span><span class="kt">.</span>
<span class="kt">GPU</span> <span class="kt">mem</span> <span class="kt">tx</span> <span class="kt">time</span>  <span class="o">(</span><span class="kt">alloc/dealloc/toDev/fromDev</span><span class="o">)</span><span class="kt">:</span>	<span class="err">0</span><span class="kt">.</span><span class="err">003</span><span class="kt">/</span><span class="err">0</span><span class="kt">.</span><span class="err">002</span><span class="kt">/</span><span class="err">0</span><span class="kt">.</span><span class="err">010</span><span class="kt">/</span><span class="err">0</span><span class="kt">.</span><span class="err">002</span> <span class="kt">sec.</span>
<span class="kt">GPU</span> <span class="kt">mem</span> <span class="kt">tx</span> <span class="kt">count</span> <span class="o">(</span><span class="kt">alloc/dealloc/toDev/fromDev/evict</span><span class="o">)</span><span class="kt">:</span>	<span class="err">24</span><span class="kt">/</span><span class="err">24</span><span class="kt">/</span><span class="err">0</span><span class="kt">/</span><span class="err">16</span><span class="kt">/</span><span class="err">8</span><span class="kt">/</span><span class="err">0</span><span class="kt">.</span>
<span class="kt">GPU</span> <span class="kt">conversion</span> <span class="kt">time</span>  <span class="o">(</span><span class="kt">sparseConv/sp2dense/dense2sp</span><span class="o">)</span><span class="kt">:</span>	<span class="err">0</span><span class="kt">.</span><span class="err">000</span><span class="kt">/</span><span class="err">0</span><span class="kt">.</span><span class="err">000</span><span class="kt">/</span><span class="err">0</span><span class="kt">.</span><span class="err">000</span> <span class="kt">sec.</span>
<span class="kt">GPU</span> <span class="kt">conversion</span> <span class="kt">count</span> <span class="o">(</span><span class="kt">sparseConv/sp2dense/dense2sp</span><span class="o">)</span><span class="kt">:</span>	<span class="err">0</span><span class="kt">/</span><span class="err">0</span><span class="kt">/</span><span class="err">0</span><span class="kt">.</span>
<span class="kt">Cache</span> <span class="kt">hits</span> <span class="o">(</span><span class="kt">Mem</span><span class="o">,</span> <span class="kt">WB</span><span class="o">,</span> <span class="nc">FS</span><span class="o">,</span> <span class="nc">HDFS</span><span class="o">)</span><span class="k">:</span>	<span class="err">40</span><span class="kt">/</span><span class="err">0</span><span class="kt">/</span><span class="err">0</span><span class="kt">/</span><span class="err">0</span><span class="kt">.</span>
<span class="kt">Cache</span> <span class="kt">writes</span> <span class="o">(</span><span class="kt">WB</span><span class="o">,</span> <span class="kt">FS</span><span class="o">,</span> <span class="nc">HDFS</span><span class="o">)</span><span class="k">:</span>	<span class="err">21</span><span class="kt">/</span><span class="err">0</span><span class="kt">/</span><span class="err">0</span><span class="kt">.</span>
<span class="kt">Cache</span> <span class="kt">times</span> <span class="o">(</span><span class="kt">ACQr/m</span><span class="o">,</span> <span class="kt">RLS</span><span class="o">,</span> <span class="nc">EXP</span><span class="o">)</span><span class="k">:</span>	<span class="err">0</span><span class="kt">.</span><span class="err">002</span><span class="kt">/</span><span class="err">0</span><span class="kt">.</span><span class="err">002</span><span class="kt">/</span><span class="err">0</span><span class="kt">.</span><span class="err">003</span><span class="kt">/</span><span class="err">0</span><span class="kt">.</span><span class="err">000</span> <span class="kt">sec.</span>
<span class="kt">HOP</span> <span class="kt">DAGs</span> <span class="kt">recompiled</span> <span class="o">(</span><span class="kt">PRED</span><span class="o">,</span> <span class="kt">SB</span><span class="o">)</span><span class="k">:</span>	<span class="err">0</span><span class="kt">/</span><span class="err">0</span><span class="kt">.</span>
<span class="kt">HOP</span> <span class="kt">DAGs</span> <span class="kt">recompile</span> <span class="kt">time:</span>	<span class="err">0</span><span class="kt">.</span><span class="err">000</span> <span class="kt">sec.</span>
<span class="kt">Spark</span> <span class="kt">ctx</span> <span class="kt">create</span> <span class="kt">time</span> <span class="o">(</span><span class="kt">lazy</span><span class="o">)</span><span class="kt">:</span>	<span class="err">0</span><span class="kt">.</span><span class="err">000</span> <span class="kt">sec.</span>
<span class="kt">Spark</span> <span class="kt">trans</span> <span class="kt">counts</span> <span class="o">(</span><span class="kt">par</span><span class="o">,</span><span class="kt">bc</span><span class="o">,</span><span class="n">col</span><span class="o">)</span><span class="k">:</span><span class="err">0</span><span class="kt">/</span><span class="err">0</span><span class="kt">/</span><span class="err">0</span><span class="kt">.</span>
<span class="kt">Spark</span> <span class="kt">trans</span> <span class="kt">times</span> <span class="o">(</span><span class="kt">par</span><span class="o">,</span><span class="kt">bc</span><span class="o">,</span><span class="n">col</span><span class="o">)</span><span class="k">:</span>	<span class="err">0</span><span class="kt">.</span><span class="err">000</span><span class="kt">/</span><span class="err">0</span><span class="kt">.</span><span class="err">000</span><span class="kt">/</span><span class="err">0</span><span class="kt">.</span><span class="err">000</span> <span class="kt">secs.</span>
<span class="kt">Total</span> <span class="kt">JIT</span> <span class="kt">compile</span> <span class="kt">time:</span>		<span class="err">11</span><span class="kt">.</span><span class="err">426</span> <span class="kt">sec.</span>
<span class="kt">Total</span> <span class="kt">JVM</span> <span class="kt">GC</span> <span class="kt">count:</span>		<span class="err">20</span><span class="kt">.</span>
<span class="kt">Total</span> <span class="kt">JVM</span> <span class="kt">GC</span> <span class="kt">time:</span>		<span class="err">1</span><span class="kt">.</span><span class="err">078</span> <span class="kt">sec.</span>
<span class="kt">Heavy</span> <span class="kt">hitter</span> <span class="kt">instructions</span> <span class="o">(</span><span class="kt">name</span><span class="o">,</span> <span class="kt">time</span><span class="o">,</span> <span class="n">count</span><span class="o">)</span><span class="k">:</span>
<span class="kt">--</span> <span class="err">1</span><span class="o">)</span> 	<span class="n">toString</span> 	<span class="mf">0.085</span> <span class="n">sec</span> 	<span class="mi">8</span>
<span class="o">--</span> <span class="mi">2</span><span class="o">)</span> 	<span class="n">rand</span> 	<span class="mf">0.027</span> <span class="n">sec</span> 	<span class="mi">16</span>
<span class="o">--</span> <span class="mi">3</span><span class="o">)</span> 	<span class="n">gpu_ba</span><span class="o">+*</span> 	<span class="mf">0.018</span> <span class="n">sec</span> 	<span class="mi">8</span>
<span class="o">--</span> <span class="mi">4</span><span class="o">)</span> 	<span class="n">print</span> 	<span class="mf">0.006</span> <span class="n">sec</span> 	<span class="mi">8</span>
<span class="o">--</span> <span class="mi">5</span><span class="o">)</span> 	<span class="n">createvar</span> 	<span class="mf">0.003</span> <span class="n">sec</span> 	<span class="mi">24</span>
<span class="o">--</span> <span class="mi">6</span><span class="o">)</span> 	<span class="n">rmvar</span> 	<span class="mf">0.003</span> <span class="n">sec</span> 	<span class="mi">40</span>

<span class="n">res20</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.MLResults</span> <span class="o">=</span>
<span class="nc">None</span></code></pre></div>

  </div>

<div data-lang="Python">

    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">ml</span><span class="o">.</span><span class="n">setGPU</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">ml</span><span class="o">.</span><span class="n">setStatistics</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">matMultScript</span> <span class="o">=</span> <span class="n">dml</span><span class="p">(</span><span class="s">"""
A = rand(rows=10, cols=1000)
B = rand(rows=1000, cols=10)
C = A </span><span class="si">%*% </span><span class="s">B
print(toString(C))
"""</span><span class="p">)</span>
<span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">matMultScript</span><span class="p">)</span></code></pre></div>

  </div>

<div data-lang="PySpark Shell">

    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">ml</span><span class="o">.</span><span class="n">setGPU</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">MLContext</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ml</span><span class="o">.</span><span class="n">setStatistics</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">MLContext</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">matMultScript</span> <span class="o">=</span> <span class="n">dml</span><span class="p">(</span><span class="s">"""
... A = rand(rows=10, cols=1000)
... B = rand(rows=1000, cols=10)
... C = A </span><span class="si">%*% </span><span class="s">B
... print(toString(C))
... """</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">matMultScript</span><span class="p">)</span>
<span class="mf">260.861</span> <span class="mf">262.732</span> <span class="mf">256.630</span> <span class="mf">255.152</span> <span class="mf">254.806</span> <span class="mf">264.448</span> <span class="mf">256.020</span> <span class="mf">250.240</span> <span class="mf">257.520</span> <span class="mf">261.278</span>
<span class="mf">257.171</span> <span class="mf">254.891</span> <span class="mf">251.777</span> <span class="mf">246.858</span> <span class="mf">248.947</span> <span class="mf">255.528</span> <span class="mf">247.446</span> <span class="mf">244.370</span> <span class="mf">252.597</span> <span class="mf">253.466</span>
<span class="mf">259.844</span> <span class="mf">255.613</span> <span class="mf">257.720</span> <span class="mf">253.652</span> <span class="mf">249.693</span> <span class="mf">261.110</span> <span class="mf">252.608</span> <span class="mf">250.833</span> <span class="mf">251.968</span> <span class="mf">259.176</span>
<span class="mf">254.491</span> <span class="mf">247.792</span> <span class="mf">252.551</span> <span class="mf">246.869</span> <span class="mf">244.682</span> <span class="mf">254.734</span> <span class="mf">247.387</span> <span class="mf">244.323</span> <span class="mf">245.981</span> <span class="mf">255.621</span>
<span class="mf">259.835</span> <span class="mf">258.062</span> <span class="mf">255.868</span> <span class="mf">252.217</span> <span class="mf">246.304</span> <span class="mf">263.997</span> <span class="mf">255.831</span> <span class="mf">249.846</span> <span class="mf">248.409</span> <span class="mf">260.124</span>
<span class="mf">251.598</span> <span class="mf">259.335</span> <span class="mf">255.662</span> <span class="mf">249.818</span> <span class="mf">247.639</span> <span class="mf">257.279</span> <span class="mf">253.946</span> <span class="mf">253.513</span> <span class="mf">251.245</span> <span class="mf">255.922</span>
<span class="mf">258.898</span> <span class="mf">258.961</span> <span class="mf">264.036</span> <span class="mf">249.118</span> <span class="mf">250.780</span> <span class="mf">259.547</span> <span class="mf">249.149</span> <span class="mf">258.040</span> <span class="mf">249.100</span> <span class="mf">258.516</span>
<span class="mf">250.412</span> <span class="mf">248.424</span> <span class="mf">250.732</span> <span class="mf">243.129</span> <span class="mf">241.684</span> <span class="mf">248.771</span> <span class="mf">237.941</span> <span class="mf">244.719</span> <span class="mf">247.409</span> <span class="mf">247.445</span>
<span class="mf">252.990</span> <span class="mf">244.238</span> <span class="mf">248.096</span> <span class="mf">241.145</span> <span class="mf">242.065</span> <span class="mf">253.795</span> <span class="mf">245.352</span> <span class="mf">246.056</span> <span class="mf">251.132</span> <span class="mf">253.063</span>
<span class="mf">253.216</span> <span class="mf">249.008</span> <span class="mf">247.910</span> <span class="mf">246.579</span> <span class="mf">242.657</span> <span class="mf">251.078</span> <span class="mf">245.954</span> <span class="mf">244.681</span> <span class="mf">241.878</span> <span class="mf">248.555</span>

<span class="n">SystemML</span> <span class="n">Statistics</span><span class="p">:</span>
<span class="n">Total</span> <span class="n">elapsed</span> <span class="n">time</span><span class="p">:</span>             <span class="mf">0.042</span> <span class="n">sec</span><span class="o">.</span>
<span class="n">Total</span> <span class="n">compilation</span> <span class="n">time</span><span class="p">:</span>         <span class="mf">0.000</span> <span class="n">sec</span><span class="o">.</span>
<span class="n">Total</span> <span class="n">execution</span> <span class="n">time</span><span class="p">:</span>           <span class="mf">0.042</span> <span class="n">sec</span><span class="o">.</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">compiled</span> <span class="n">Spark</span> <span class="n">inst</span><span class="p">:</span>  <span class="mf">0.</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">executed</span> <span class="n">Spark</span> <span class="n">inst</span><span class="p">:</span>  <span class="mf">0.</span>
<span class="n">CUDA</span><span class="o">/</span><span class="n">CuLibraries</span> <span class="n">init</span> <span class="n">time</span><span class="p">:</span>     <span class="mf">7.058</span><span class="o">/</span><span class="mf">0.749</span> <span class="n">sec</span><span class="o">.</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">executed</span> <span class="n">GPU</span> <span class="n">inst</span><span class="p">:</span>    <span class="mf">1.</span>
<span class="n">GPU</span> <span class="n">mem</span> <span class="n">tx</span> <span class="n">time</span>  <span class="p">(</span><span class="n">alloc</span><span class="o">/</span><span class="n">dealloc</span><span class="o">/</span><span class="n">set0</span><span class="o">/</span><span class="n">toDev</span><span class="o">/</span><span class="n">fromDev</span><span class="p">):</span>    <span class="mf">0.002</span><span class="o">/</span><span class="mf">0.000</span><span class="o">/</span><span class="mf">0.000</span><span class="o">/</span><span class="mf">0.002</span><span class="o">/</span><span class="mf">0.000</span> <span class="n">sec</span><span class="o">.</span>
<span class="n">GPU</span> <span class="n">mem</span> <span class="n">tx</span> <span class="n">count</span> <span class="p">(</span><span class="n">alloc</span><span class="o">/</span><span class="n">dealloc</span><span class="o">/</span><span class="n">set0</span><span class="o">/</span><span class="n">toDev</span><span class="o">/</span><span class="n">fromDev</span><span class="o">/</span><span class="n">evict</span><span class="p">):</span>      <span class="mi">3</span><span class="o">/</span><span class="mi">3</span><span class="o">/</span><span class="mi">3</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="mf">0.</span>
<span class="n">GPU</span> <span class="n">conversion</span> <span class="n">time</span>  <span class="p">(</span><span class="n">sparseConv</span><span class="o">/</span><span class="n">sp2dense</span><span class="o">/</span><span class="n">dense2sp</span><span class="p">):</span>    <span class="mf">0.000</span><span class="o">/</span><span class="mf">0.000</span><span class="o">/</span><span class="mf">0.000</span> <span class="n">sec</span><span class="o">.</span>
<span class="n">GPU</span> <span class="n">conversion</span> <span class="n">count</span> <span class="p">(</span><span class="n">sparseConv</span><span class="o">/</span><span class="n">sp2dense</span><span class="o">/</span><span class="n">dense2sp</span><span class="p">):</span>    <span class="mi">0</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mf">0.</span>
<span class="n">Cache</span> <span class="n">hits</span> <span class="p">(</span><span class="n">Mem</span><span class="p">,</span> <span class="n">WB</span><span class="p">,</span> <span class="n">FS</span><span class="p">,</span> <span class="n">HDFS</span><span class="p">):</span> <span class="mi">3</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mf">0.</span>
<span class="n">Cache</span> <span class="n">writes</span> <span class="p">(</span><span class="n">WB</span><span class="p">,</span> <span class="n">FS</span><span class="p">,</span> <span class="n">HDFS</span><span class="p">):</span>    <span class="mi">2</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mf">0.</span>
<span class="n">Cache</span> <span class="n">times</span> <span class="p">(</span><span class="n">ACQr</span><span class="o">/</span><span class="n">m</span><span class="p">,</span> <span class="n">RLS</span><span class="p">,</span> <span class="n">EXP</span><span class="p">):</span> <span class="mf">0.000</span><span class="o">/</span><span class="mf">0.000</span><span class="o">/</span><span class="mf">0.000</span><span class="o">/</span><span class="mf">0.000</span> <span class="n">sec</span><span class="o">.</span>
<span class="n">HOP</span> <span class="n">DAGs</span> <span class="n">recompiled</span> <span class="p">(</span><span class="n">PRED</span><span class="p">,</span> <span class="n">SB</span><span class="p">):</span> <span class="mi">0</span><span class="o">/</span><span class="mf">0.</span>
<span class="n">HOP</span> <span class="n">DAGs</span> <span class="n">recompile</span> <span class="n">time</span><span class="p">:</span>        <span class="mf">0.000</span> <span class="n">sec</span><span class="o">.</span>
<span class="n">Spark</span> <span class="n">ctx</span> <span class="n">create</span> <span class="n">time</span> <span class="p">(</span><span class="n">lazy</span><span class="p">):</span>   <span class="mf">0.000</span> <span class="n">sec</span><span class="o">.</span>
<span class="n">Spark</span> <span class="n">trans</span> <span class="n">counts</span> <span class="p">(</span><span class="n">par</span><span class="p">,</span><span class="n">bc</span><span class="p">,</span><span class="n">col</span><span class="p">):</span><span class="mi">0</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mf">0.</span>
<span class="n">Spark</span> <span class="n">trans</span> <span class="n">times</span> <span class="p">(</span><span class="n">par</span><span class="p">,</span><span class="n">bc</span><span class="p">,</span><span class="n">col</span><span class="p">):</span> <span class="mf">0.000</span><span class="o">/</span><span class="mf">0.000</span><span class="o">/</span><span class="mf">0.000</span> <span class="n">secs</span><span class="o">.</span>
<span class="n">Total</span> <span class="n">JIT</span> <span class="nb">compile</span> <span class="n">time</span><span class="p">:</span>         <span class="mf">1.348</span> <span class="n">sec</span><span class="o">.</span>
<span class="n">Total</span> <span class="n">JVM</span> <span class="n">GC</span> <span class="n">count</span><span class="p">:</span>             <span class="mf">9.</span>
<span class="n">Total</span> <span class="n">JVM</span> <span class="n">GC</span> <span class="n">time</span><span class="p">:</span>              <span class="mf">0.264</span> <span class="n">sec</span><span class="o">.</span>
<span class="n">Heavy</span> <span class="n">hitter</span> <span class="n">instructions</span><span class="p">:</span>
 <span class="c">#  Instruction  Time(s)  Count</span>
 <span class="mi">1</span>  <span class="n">rand</span>           <span class="mf">0.023</span>      <span class="mi">2</span>
 <span class="mi">2</span>  <span class="n">gpu_ba</span><span class="o">+*</span>       <span class="mf">0.012</span>      <span class="mi">1</span>
 <span class="mi">3</span>  <span class="n">toString</span>       <span class="mf">0.004</span>      <span class="mi">1</span>
 <span class="mi">4</span>  <span class="n">createvar</span>      <span class="mf">0.000</span>      <span class="mi">3</span>
 <span class="mi">5</span>  <span class="n">rmvar</span>          <span class="mf">0.000</span>      <span class="mi">3</span>
 <span class="mi">6</span>  <span class="k">print</span>          <span class="mf">0.000</span>      <span class="mi">1</span>

<span class="mi">18</span>
<span class="n">MLResults</span>
<span class="o">&gt;&gt;&gt;</span></code></pre></div>

  </div>

</div>

<p>Note that GPU instructions show up prepended with a &#8220;gpu&#8221; in the statistics.</p>

<h2 id="explain">Explain</h2>

<p>A DML or PyDML script is converted into a SystemML program during script execution. Information
about this program can be displayed by calling MLContext&#8217;s <code>setExplain</code> method with a value
of <code>true</code>.</p>

<div class="codetabs">

<div data-lang="Scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">ml</span><span class="o">.</span><span class="n">setExplain</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>
<span class="k">val</span> <span class="n">minMaxMean</span> <span class="k">=</span>
<span class="s">"""
minOut = min(Xin)
maxOut = max(Xin)
meanOut = mean(Xin)
"""</span>
<span class="k">val</span> <span class="n">mm</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MatrixMetadata</span><span class="o">(</span><span class="n">numRows</span><span class="o">,</span> <span class="n">numCols</span><span class="o">)</span>
<span class="k">val</span> <span class="n">minMaxMeanScript</span> <span class="k">=</span> <span class="n">dml</span><span class="o">(</span><span class="n">minMaxMean</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"Xin"</span><span class="o">,</span> <span class="n">df</span><span class="o">,</span> <span class="n">mm</span><span class="o">).</span><span class="n">out</span><span class="o">(</span><span class="s">"minOut"</span><span class="o">,</span> <span class="s">"maxOut"</span><span class="o">,</span> <span class="s">"meanOut"</span><span class="o">)</span>
<span class="k">val</span> <span class="o">(</span><span class="n">min</span><span class="o">,</span> <span class="n">max</span><span class="o">,</span> <span class="n">mean</span><span class="o">)</span> <span class="k">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">minMaxMeanScript</span><span class="o">).</span><span class="n">getTuple</span><span class="o">[</span><span class="kt">Double</span>, <span class="kt">Double</span>, <span class="kt">Double</span><span class="o">](</span><span class="s">"minOut"</span><span class="o">,</span> <span class="s">"maxOut"</span><span class="o">,</span> <span class="s">"meanOut"</span><span class="o">)</span></code></pre></div>

  </div>

<div data-lang="Spark Shell">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="n">ml</span><span class="o">.</span><span class="n">setExplain</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">minMaxMean</span> <span class="k">=</span>
     <span class="o">|</span> <span class="s">"""
     | minOut = min(Xin)
     | maxOut = max(Xin)
     | meanOut = mean(Xin)
     | """</span>
<span class="n">minMaxMean</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span>
<span class="s">"
minOut = min(Xin)
maxOut = max(Xin)
meanOut = mean(Xin)
"</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">mm</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MatrixMetadata</span><span class="o">(</span><span class="n">numRows</span><span class="o">,</span> <span class="n">numCols</span><span class="o">)</span>
<span class="n">mm</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.MatrixMetadata</span> <span class="o">=</span> <span class="n">rows</span><span class="k">:</span> <span class="err">10000</span><span class="o">,</span> <span class="n">columns</span><span class="k">:</span> <span class="err">100</span><span class="o">,</span> <span class="n">non</span><span class="o">-</span><span class="n">zeros</span><span class="k">:</span> <span class="kt">None</span><span class="o">,</span> <span class="n">rows</span> <span class="n">per</span> <span class="n">block</span><span class="k">:</span> <span class="kt">None</span><span class="o">,</span> <span class="n">columns</span> <span class="n">per</span> <span class="n">block</span><span class="k">:</span> <span class="kt">None</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">minMaxMeanScript</span> <span class="k">=</span> <span class="n">dml</span><span class="o">(</span><span class="n">minMaxMean</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"Xin"</span><span class="o">,</span> <span class="n">df</span><span class="o">,</span> <span class="n">mm</span><span class="o">).</span><span class="n">out</span><span class="o">(</span><span class="s">"minOut"</span><span class="o">,</span> <span class="s">"maxOut"</span><span class="o">,</span> <span class="s">"meanOut"</span><span class="o">)</span>
<span class="n">minMaxMeanScript</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.Script</span> <span class="o">=</span>
<span class="nc">Inputs</span><span class="k">:</span>
  <span class="err">[1]</span> <span class="o">(</span><span class="kt">DataFrame</span><span class="o">)</span> <span class="kt">Xin:</span> <span class="err">[</span><span class="kt">C0:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C1</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C2</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C3</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C4</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C5</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C6</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="n">C7</span><span class="k">:</span> <span class="kt">double</span><span class="o">,</span> <span class="o">...</span>

<span class="nc">Outputs</span><span class="k">:</span>
  <span class="err">[1]</span> <span class="kt">minOut</span>
  <span class="o">[</span><span class="err">2</span><span class="o">]</span> <span class="n">maxOut</span>
  <span class="o">[</span><span class="err">3</span><span class="o">]</span> <span class="n">meanOut</span>


<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="o">(</span><span class="n">min</span><span class="o">,</span> <span class="n">max</span><span class="o">,</span> <span class="n">mean</span><span class="o">)</span> <span class="k">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">minMaxMeanScript</span><span class="o">).</span><span class="n">getTuple</span><span class="o">[</span><span class="kt">Double</span>, <span class="kt">Double</span>, <span class="kt">Double</span><span class="o">](</span><span class="s">"minOut"</span><span class="o">,</span> <span class="s">"maxOut"</span><span class="o">,</span> <span class="s">"meanOut"</span><span class="o">)</span>

<span class="nc">PROGRAM</span>
<span class="o">--</span><span class="nc">MAIN</span> <span class="nc">PROGRAM</span>
<span class="o">----</span><span class="nc">GENERIC</span> <span class="o">(</span><span class="n">lines</span> <span class="mi">1</span><span class="o">-</span><span class="mi">8</span><span class="o">)</span> <span class="o">[</span><span class="kt">recompile=false</span><span class="o">]</span>
<span class="o">------(</span><span class="mi">12</span><span class="o">)</span> <span class="nc">TRead</span> <span class="nc">Xin</span> <span class="o">[</span><span class="err">10000</span>,<span class="err">100</span>,<span class="err">1000</span>,<span class="err">1000</span>,<span class="err">1000000</span><span class="o">]</span> <span class="o">{</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">76</span> <span class="o">-&gt;</span> <span class="mi">76</span><span class="nc">MB</span><span class="o">}</span> <span class="o">[</span><span class="kt">chkpt</span><span class="o">],</span> <span class="nc">CP</span>
<span class="o">------(</span><span class="mi">13</span><span class="o">)</span> <span class="n">ua</span><span class="o">(</span><span class="n">minRC</span><span class="o">)</span> <span class="o">(</span><span class="mi">12</span><span class="o">)</span> <span class="o">[</span><span class="err">0</span>,<span class="err">0</span>,<span class="kt">-</span><span class="err">1</span>,<span class="kt">-</span><span class="err">1</span>,<span class="kt">-</span><span class="err">1</span><span class="o">]</span> <span class="o">{</span><span class="mi">76</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span> <span class="o">-&gt;</span> <span class="mi">76</span><span class="nc">MB</span><span class="o">},</span> <span class="nc">CP</span>
<span class="o">------(</span><span class="mi">21</span><span class="o">)</span> <span class="nc">TWrite</span> <span class="n">minOut</span> <span class="o">(</span><span class="mi">13</span><span class="o">)</span> <span class="o">[</span><span class="err">0</span>,<span class="err">0</span>,<span class="kt">-</span><span class="err">1</span>,<span class="kt">-</span><span class="err">1</span>,<span class="kt">-</span><span class="err">1</span><span class="o">]</span> <span class="o">{</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span> <span class="o">-&gt;</span> <span class="mi">0</span><span class="nc">MB</span><span class="o">},</span> <span class="nc">CP</span>
<span class="o">------(</span><span class="mi">14</span><span class="o">)</span> <span class="n">ua</span><span class="o">(</span><span class="n">maxRC</span><span class="o">)</span> <span class="o">(</span><span class="mi">12</span><span class="o">)</span> <span class="o">[</span><span class="err">0</span>,<span class="err">0</span>,<span class="kt">-</span><span class="err">1</span>,<span class="kt">-</span><span class="err">1</span>,<span class="kt">-</span><span class="err">1</span><span class="o">]</span> <span class="o">{</span><span class="mi">76</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span> <span class="o">-&gt;</span> <span class="mi">76</span><span class="nc">MB</span><span class="o">},</span> <span class="nc">CP</span>
<span class="o">------(</span><span class="mi">27</span><span class="o">)</span> <span class="nc">TWrite</span> <span class="n">maxOut</span> <span class="o">(</span><span class="mi">14</span><span class="o">)</span> <span class="o">[</span><span class="err">0</span>,<span class="err">0</span>,<span class="kt">-</span><span class="err">1</span>,<span class="kt">-</span><span class="err">1</span>,<span class="kt">-</span><span class="err">1</span><span class="o">]</span> <span class="o">{</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span> <span class="o">-&gt;</span> <span class="mi">0</span><span class="nc">MB</span><span class="o">},</span> <span class="nc">CP</span>
<span class="o">------(</span><span class="mi">15</span><span class="o">)</span> <span class="n">ua</span><span class="o">(</span><span class="n">meanRC</span><span class="o">)</span> <span class="o">(</span><span class="mi">12</span><span class="o">)</span> <span class="o">[</span><span class="err">0</span>,<span class="err">0</span>,<span class="kt">-</span><span class="err">1</span>,<span class="kt">-</span><span class="err">1</span>,<span class="kt">-</span><span class="err">1</span><span class="o">]</span> <span class="o">{</span><span class="mi">76</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span> <span class="o">-&gt;</span> <span class="mi">76</span><span class="nc">MB</span><span class="o">},</span> <span class="nc">CP</span>
<span class="o">------(</span><span class="mi">33</span><span class="o">)</span> <span class="nc">TWrite</span> <span class="n">meanOut</span> <span class="o">(</span><span class="mi">15</span><span class="o">)</span> <span class="o">[</span><span class="err">0</span>,<span class="err">0</span>,<span class="kt">-</span><span class="err">1</span>,<span class="kt">-</span><span class="err">1</span>,<span class="kt">-</span><span class="err">1</span><span class="o">]</span> <span class="o">{</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span> <span class="o">-&gt;</span> <span class="mi">0</span><span class="nc">MB</span><span class="o">},</span> <span class="nc">CP</span>

<span class="n">min</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="mf">5.16651366133658E-9</span>
<span class="n">max</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="mf">0.9999999368927975</span>
<span class="n">mean</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="mf">0.5001096515241128</span></code></pre></div>

  </div>

<div data-lang="Python">

    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">ml</span><span class="o">.</span><span class="n">setExplain</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">minMaxMean</span> <span class="o">=</span> <span class="s">"""
minOut = min(Xin)
maxOut = max(Xin)
meanOut = mean(Xin)
"""</span>
<span class="n">minMaxMeanScript</span> <span class="o">=</span> <span class="n">dml</span><span class="p">(</span><span class="n">minMaxMean</span><span class="p">)</span><span class="o">.</span><span class="nb">input</span><span class="p">(</span><span class="n">Xin</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="s">"minOut"</span><span class="p">,</span> <span class="s">"maxOut"</span><span class="p">,</span> <span class="s">"meanOut"</span><span class="p">)</span>
<span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">,</span> <span class="n">mean</span> <span class="o">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">minMaxMeanScript</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"minOut"</span><span class="p">,</span> <span class="s">"maxOut"</span><span class="p">,</span> <span class="s">"meanOut"</span><span class="p">)</span></code></pre></div>

  </div>

<div data-lang="PySpark Shell">

    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">ml</span><span class="o">.</span><span class="n">setExplain</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">MLContext</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">minMaxMean</span> <span class="o">=</span> <span class="s">"""
... minOut = min(Xin)
... maxOut = max(Xin)
... meanOut = mean(Xin)
... """</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">minMaxMeanScript</span> <span class="o">=</span> <span class="n">dml</span><span class="p">(</span><span class="n">minMaxMean</span><span class="p">)</span><span class="o">.</span><span class="nb">input</span><span class="p">(</span><span class="n">Xin</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="s">"minOut"</span><span class="p">,</span> <span class="s">"maxOut"</span><span class="p">,</span> <span class="s">"meanOut"</span><span class="p">)</span>
<span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">,</span> <span class="n">mean</span> <span class="o">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">minMaxMeanScript</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"minOut"</span><span class="p">,</span> <span class="s">"maxOut"</span><span class="p">,</span> <span class="s">"meanOut"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">,</span> <span class="n">mean</span> <span class="o">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">minMaxMeanScript</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"minOut"</span><span class="p">,</span> <span class="s">"maxOut"</span><span class="p">,</span> <span class="s">"meanOut"</span><span class="p">)</span>
<span class="c"># EXPLAIN (RUNTIME):</span>
<span class="c"># Memory Budget local/remote = 687MB/?MB/?MB/?MB</span>
<span class="c"># Degree of Parallelism (vcores) local/remote = 24/?</span>
<span class="n">PROGRAM</span> <span class="p">(</span> <span class="n">size</span> <span class="n">CP</span><span class="o">/</span><span class="n">SP</span> <span class="o">=</span> <span class="mi">7</span><span class="o">/</span><span class="mi">0</span> <span class="p">)</span>
<span class="o">--</span><span class="n">MAIN</span> <span class="n">PROGRAM</span>
<span class="o">----</span><span class="n">GENERIC</span> <span class="p">(</span><span class="n">lines</span> <span class="mi">1</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span> <span class="p">[</span><span class="n">recompile</span><span class="o">=</span><span class="n">false</span><span class="p">]</span>
<span class="o">------</span><span class="n">CP</span> <span class="n">uamin</span> <span class="n">Xin</span><span class="o">.</span><span class="n">MATRIX</span><span class="o">.</span><span class="n">DOUBLE</span> <span class="n">_Var1</span><span class="o">.</span><span class="n">SCALAR</span><span class="o">.</span><span class="n">DOUBLE</span> <span class="mi">24</span>
<span class="o">------</span><span class="n">CP</span> <span class="n">uamax</span> <span class="n">Xin</span><span class="o">.</span><span class="n">MATRIX</span><span class="o">.</span><span class="n">DOUBLE</span> <span class="n">_Var2</span><span class="o">.</span><span class="n">SCALAR</span><span class="o">.</span><span class="n">DOUBLE</span> <span class="mi">24</span>
<span class="o">------</span><span class="n">CP</span> <span class="n">uamean</span> <span class="n">Xin</span><span class="o">.</span><span class="n">MATRIX</span><span class="o">.</span><span class="n">DOUBLE</span> <span class="n">_Var3</span><span class="o">.</span><span class="n">SCALAR</span><span class="o">.</span><span class="n">DOUBLE</span> <span class="mi">24</span>
<span class="o">------</span><span class="n">CP</span> <span class="n">assignvar</span> <span class="n">_Var1</span><span class="o">.</span><span class="n">SCALAR</span><span class="o">.</span><span class="n">DOUBLE</span><span class="o">.</span><span class="n">false</span> <span class="n">minOut</span><span class="o">.</span><span class="n">SCALAR</span><span class="o">.</span><span class="n">DOUBLE</span>
<span class="o">------</span><span class="n">CP</span> <span class="n">assignvar</span> <span class="n">_Var2</span><span class="o">.</span><span class="n">SCALAR</span><span class="o">.</span><span class="n">DOUBLE</span><span class="o">.</span><span class="n">false</span> <span class="n">maxOut</span><span class="o">.</span><span class="n">SCALAR</span><span class="o">.</span><span class="n">DOUBLE</span>
<span class="o">------</span><span class="n">CP</span> <span class="n">assignvar</span> <span class="n">_Var3</span><span class="o">.</span><span class="n">SCALAR</span><span class="o">.</span><span class="n">DOUBLE</span><span class="o">.</span><span class="n">false</span> <span class="n">meanOut</span><span class="o">.</span><span class="n">SCALAR</span><span class="o">.</span><span class="n">DOUBLE</span>
<span class="o">------</span><span class="n">CP</span> <span class="n">rmvar</span> <span class="n">_Var1</span> <span class="n">_Var2</span> <span class="n">_Var3</span>

<span class="n">SystemML</span> <span class="n">Statistics</span><span class="p">:</span>
<span class="n">Total</span> <span class="n">execution</span> <span class="n">time</span><span class="p">:</span>           <span class="mf">0.952</span> <span class="n">sec</span><span class="o">.</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">executed</span> <span class="n">Spark</span> <span class="n">inst</span><span class="p">:</span>  <span class="mf">0.</span>

<span class="o">&gt;&gt;&gt;</span></code></pre></div>

  </div>

</div>

<p>Different explain levels can be set. The explain levels are NONE, HOPS, RUNTIME, RECOMPILE_HOPS, and RECOMPILE_RUNTIME.</p>

<div class="codetabs">

<div data-lang="Scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">ml</span><span class="o">.</span><span class="n">setExplainLevel</span><span class="o">(</span><span class="nc">MLContext</span><span class="o">.</span><span class="nc">ExplainLevel</span><span class="o">.</span><span class="nc">RUNTIME</span><span class="o">)</span>
<span class="k">val</span> <span class="o">(</span><span class="n">min</span><span class="o">,</span> <span class="n">max</span><span class="o">,</span> <span class="n">mean</span><span class="o">)</span> <span class="k">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">minMaxMeanScript</span><span class="o">).</span><span class="n">getTuple</span><span class="o">[</span><span class="kt">Double</span>, <span class="kt">Double</span>, <span class="kt">Double</span><span class="o">](</span><span class="s">"minOut"</span><span class="o">,</span> <span class="s">"maxOut"</span><span class="o">,</span> <span class="s">"meanOut"</span><span class="o">)</span></code></pre></div>

  </div>

<div data-lang="Spark Shell">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="n">ml</span><span class="o">.</span><span class="n">setExplainLevel</span><span class="o">(</span><span class="nc">MLContext</span><span class="o">.</span><span class="nc">ExplainLevel</span><span class="o">.</span><span class="nc">RUNTIME</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="o">(</span><span class="n">min</span><span class="o">,</span> <span class="n">max</span><span class="o">,</span> <span class="n">mean</span><span class="o">)</span> <span class="k">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">minMaxMeanScript</span><span class="o">).</span><span class="n">getTuple</span><span class="o">[</span><span class="kt">Double</span>, <span class="kt">Double</span>, <span class="kt">Double</span><span class="o">](</span><span class="s">"minOut"</span><span class="o">,</span> <span class="s">"maxOut"</span><span class="o">,</span> <span class="s">"meanOut"</span><span class="o">)</span>

<span class="nc">PROGRAM</span> <span class="o">(</span> <span class="n">size</span> <span class="nc">CP</span><span class="o">/</span><span class="nc">SP</span> <span class="k">=</span> <span class="mi">9</span><span class="o">/</span><span class="mi">0</span> <span class="o">)</span>
<span class="o">--</span><span class="nc">MAIN</span> <span class="nc">PROGRAM</span>
<span class="o">----</span><span class="nc">GENERIC</span> <span class="o">(</span><span class="n">lines</span> <span class="mi">1</span><span class="o">-</span><span class="mi">8</span><span class="o">)</span> <span class="o">[</span><span class="kt">recompile=false</span><span class="o">]</span>
<span class="o">------</span><span class="nc">CP</span> <span class="n">uamin</span> <span class="nc">Xin</span><span class="o">.</span><span class="nc">MATRIX</span><span class="o">.</span><span class="nc">DOUBLE</span> <span class="nc">_Var8</span><span class="o">.</span><span class="nc">SCALAR</span><span class="o">.</span><span class="nc">DOUBLE</span> <span class="mi">8</span>
<span class="o">------</span><span class="nc">CP</span> <span class="n">uamax</span> <span class="nc">Xin</span><span class="o">.</span><span class="nc">MATRIX</span><span class="o">.</span><span class="nc">DOUBLE</span> <span class="nc">_Var9</span><span class="o">.</span><span class="nc">SCALAR</span><span class="o">.</span><span class="nc">DOUBLE</span> <span class="mi">8</span>
<span class="o">------</span><span class="nc">CP</span> <span class="n">uamean</span> <span class="nc">Xin</span><span class="o">.</span><span class="nc">MATRIX</span><span class="o">.</span><span class="nc">DOUBLE</span> <span class="nc">_Var10</span><span class="o">.</span><span class="nc">SCALAR</span><span class="o">.</span><span class="nc">DOUBLE</span> <span class="mi">8</span>
<span class="o">------</span><span class="nc">CP</span> <span class="n">assignvar</span> <span class="nc">_Var8</span><span class="o">.</span><span class="nc">SCALAR</span><span class="o">.</span><span class="nc">DOUBLE</span><span class="o">.</span><span class="kc">false</span> <span class="n">minOut</span><span class="o">.</span><span class="nc">SCALAR</span><span class="o">.</span><span class="nc">DOUBLE</span>
<span class="o">------</span><span class="nc">CP</span> <span class="n">assignvar</span> <span class="nc">_Var9</span><span class="o">.</span><span class="nc">SCALAR</span><span class="o">.</span><span class="nc">DOUBLE</span><span class="o">.</span><span class="kc">false</span> <span class="n">maxOut</span><span class="o">.</span><span class="nc">SCALAR</span><span class="o">.</span><span class="nc">DOUBLE</span>
<span class="o">------</span><span class="nc">CP</span> <span class="n">assignvar</span> <span class="nc">_Var10</span><span class="o">.</span><span class="nc">SCALAR</span><span class="o">.</span><span class="nc">DOUBLE</span><span class="o">.</span><span class="kc">false</span> <span class="n">meanOut</span><span class="o">.</span><span class="nc">SCALAR</span><span class="o">.</span><span class="nc">DOUBLE</span>
<span class="o">------</span><span class="nc">CP</span> <span class="n">rmvar</span> <span class="nc">_Var8</span>
<span class="o">------</span><span class="nc">CP</span> <span class="n">rmvar</span> <span class="nc">_Var9</span>
<span class="o">------</span><span class="nc">CP</span> <span class="n">rmvar</span> <span class="nc">_Var10</span>

<span class="n">min</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="mf">5.16651366133658E-9</span>
<span class="n">max</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="mf">0.9999999368927975</span>
<span class="n">mean</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=</span> <span class="mf">0.5001096515241128</span></code></pre></div>

  </div>

<div data-lang="Python">

    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">ml</span><span class="o">.</span><span class="n">setExplainLevel</span><span class="p">(</span><span class="s">"runtime"</span><span class="p">)</span>
<span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">,</span> <span class="n">mean</span> <span class="o">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">minMaxMeanScript</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"minOut"</span><span class="p">,</span> <span class="s">"maxOut"</span><span class="p">,</span> <span class="s">"meanOut"</span><span class="p">)</span></code></pre></div>

  </div>

<div data-lang="PySpark Shell">

    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">ml</span><span class="o">.</span><span class="n">setExplainLevel</span><span class="p">(</span><span class="s">"runtime"</span><span class="p">)</span>
<span class="n">MLContext</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">,</span> <span class="n">mean</span> <span class="o">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">minMaxMeanScript</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"minOut"</span><span class="p">,</span> <span class="s">"maxOut"</span><span class="p">,</span> <span class="s">"meanOut"</span><span class="p">)</span>
<span class="c"># EXPLAIN (RUNTIME):</span>
<span class="c"># Memory Budget local/remote = 687MB/?MB/?MB/?MB</span>
<span class="c"># Degree of Parallelism (vcores) local/remote = 24/?</span>
<span class="n">PROGRAM</span> <span class="p">(</span> <span class="n">size</span> <span class="n">CP</span><span class="o">/</span><span class="n">SP</span> <span class="o">=</span> <span class="mi">7</span><span class="o">/</span><span class="mi">0</span> <span class="p">)</span>
<span class="o">--</span><span class="n">MAIN</span> <span class="n">PROGRAM</span>
<span class="o">----</span><span class="n">GENERIC</span> <span class="p">(</span><span class="n">lines</span> <span class="mi">1</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span> <span class="p">[</span><span class="n">recompile</span><span class="o">=</span><span class="n">false</span><span class="p">]</span>
<span class="o">------</span><span class="n">CP</span> <span class="n">uamin</span> <span class="n">Xin</span><span class="o">.</span><span class="n">MATRIX</span><span class="o">.</span><span class="n">DOUBLE</span> <span class="n">_Var4</span><span class="o">.</span><span class="n">SCALAR</span><span class="o">.</span><span class="n">DOUBLE</span> <span class="mi">24</span>
<span class="o">------</span><span class="n">CP</span> <span class="n">uamax</span> <span class="n">Xin</span><span class="o">.</span><span class="n">MATRIX</span><span class="o">.</span><span class="n">DOUBLE</span> <span class="n">_Var5</span><span class="o">.</span><span class="n">SCALAR</span><span class="o">.</span><span class="n">DOUBLE</span> <span class="mi">24</span>
<span class="o">------</span><span class="n">CP</span> <span class="n">uamean</span> <span class="n">Xin</span><span class="o">.</span><span class="n">MATRIX</span><span class="o">.</span><span class="n">DOUBLE</span> <span class="n">_Var6</span><span class="o">.</span><span class="n">SCALAR</span><span class="o">.</span><span class="n">DOUBLE</span> <span class="mi">24</span>
<span class="o">------</span><span class="n">CP</span> <span class="n">assignvar</span> <span class="n">_Var4</span><span class="o">.</span><span class="n">SCALAR</span><span class="o">.</span><span class="n">DOUBLE</span><span class="o">.</span><span class="n">false</span> <span class="n">minOut</span><span class="o">.</span><span class="n">SCALAR</span><span class="o">.</span><span class="n">DOUBLE</span>
<span class="o">------</span><span class="n">CP</span> <span class="n">assignvar</span> <span class="n">_Var5</span><span class="o">.</span><span class="n">SCALAR</span><span class="o">.</span><span class="n">DOUBLE</span><span class="o">.</span><span class="n">false</span> <span class="n">maxOut</span><span class="o">.</span><span class="n">SCALAR</span><span class="o">.</span><span class="n">DOUBLE</span>
<span class="o">------</span><span class="n">CP</span> <span class="n">assignvar</span> <span class="n">_Var6</span><span class="o">.</span><span class="n">SCALAR</span><span class="o">.</span><span class="n">DOUBLE</span><span class="o">.</span><span class="n">false</span> <span class="n">meanOut</span><span class="o">.</span><span class="n">SCALAR</span><span class="o">.</span><span class="n">DOUBLE</span>
<span class="o">------</span><span class="n">CP</span> <span class="n">rmvar</span> <span class="n">_Var4</span> <span class="n">_Var5</span> <span class="n">_Var6</span>

<span class="n">SystemML</span> <span class="n">Statistics</span><span class="p">:</span>
<span class="n">Total</span> <span class="n">execution</span> <span class="n">time</span><span class="p">:</span>           <span class="mf">0.022</span> <span class="n">sec</span><span class="o">.</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">executed</span> <span class="n">Spark</span> <span class="n">inst</span><span class="p">:</span>  <span class="mf">0.</span>

<span class="o">&gt;&gt;&gt;</span></code></pre></div>

  </div>

</div>

<h2 id="script-creation-and-scriptfactory">Script Creation and ScriptFactory</h2>

<p>Script objects can be created using standard Script constructors. A Script can be
of two types: DML (R-based syntax) and PYDML (Python-based syntax). If no ScriptType
is specified, the default Script type is DML.</p>

<div class="codetabs">

<div data-lang="Scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">script</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Script</span><span class="o">()</span>
<span class="n">println</span><span class="o">(</span><span class="n">script</span><span class="o">.</span><span class="n">getScriptType</span><span class="o">)</span>
<span class="k">val</span> <span class="n">script</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Script</span><span class="o">(</span><span class="nc">ScriptType</span><span class="o">.</span><span class="nc">PYDML</span><span class="o">)</span>
<span class="n">println</span><span class="o">(</span><span class="n">script</span><span class="o">.</span><span class="n">getScriptType</span><span class="o">)</span></code></pre></div>

  </div>

<div data-lang="Spark Shell">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">script</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Script</span><span class="o">();</span>
<span class="o">...</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="n">println</span><span class="o">(</span><span class="n">script</span><span class="o">.</span><span class="n">getScriptType</span><span class="o">)</span>
<span class="nc">DML</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">script</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Script</span><span class="o">(</span><span class="nc">ScriptType</span><span class="o">.</span><span class="nc">PYDML</span><span class="o">);</span>
<span class="o">...</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="n">println</span><span class="o">(</span><span class="n">script</span><span class="o">.</span><span class="n">getScriptType</span><span class="o">)</span>
<span class="nc">PYDML</span></code></pre></div>

  </div>

</div>

<p>The ScriptFactory class offers convenient methods for creating DML and PYDML scripts from a variety of sources.
ScriptFactory can create a script object from a String, File, URL, or InputStream.</p>

<p><strong>Script from URL:</strong></p>

<p>Here we create Script object <code>s1</code> by reading <code>Univar-Stats.dml</code> from a URL.</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">uniUrl</span> <span class="k">=</span> <span class="s">"https://raw.githubusercontent.com/apache/systemml/master/scripts/algorithms/Univar-Stats.dml"</span>
<span class="k">val</span> <span class="n">s1</span> <span class="k">=</span> <span class="nc">ScriptFactory</span><span class="o">.</span><span class="n">dmlFromUrl</span><span class="o">(</span><span class="n">scriptUrl</span><span class="o">)</span></code></pre></div>

<p><strong>Script from String:</strong></p>

<p>We create Script objects <code>s2</code> and <code>s3</code> from Strings using ScriptFactory&#8217;s <code>dml</code> and <code>dmlFromString</code> methods.
Both methods perform the same action. This example reads an algorithm at a URL to String <code>uniString</code> and then
creates two script objects based on this String.</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">uniUrl</span> <span class="k">=</span> <span class="s">"https://raw.githubusercontent.com/apache/systemml/master/scripts/algorithms/Univar-Stats.dml"</span>
<span class="k">val</span> <span class="n">uniString</span> <span class="k">=</span> <span class="n">scala</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="nc">Source</span><span class="o">.</span><span class="n">fromURL</span><span class="o">(</span><span class="n">uniUrl</span><span class="o">).</span><span class="n">mkString</span>
<span class="k">val</span> <span class="n">s2</span> <span class="k">=</span> <span class="nc">ScriptFactory</span><span class="o">.</span><span class="n">dml</span><span class="o">(</span><span class="n">uniString</span><span class="o">)</span>
<span class="k">val</span> <span class="n">s3</span> <span class="k">=</span> <span class="nc">ScriptFactory</span><span class="o">.</span><span class="n">dmlFromString</span><span class="o">(</span><span class="n">uniString</span><span class="o">)</span></code></pre></div>

<p><strong>Script from File:</strong></p>

<p>We create Script object <code>s4</code> based on a path to a file using ScriptFactory&#8217;s <code>dmlFromFile</code> method. This example
reads a URL to a String, writes this String to a file, and then uses the path to the file to create a Script object.</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">uniUrl</span> <span class="k">=</span> <span class="s">"https://raw.githubusercontent.com/apache/systemml/master/scripts/algorithms/Univar-Stats.dml"</span>
<span class="k">val</span> <span class="n">uniString</span> <span class="k">=</span> <span class="n">scala</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="nc">Source</span><span class="o">.</span><span class="n">fromURL</span><span class="o">(</span><span class="n">uniUrl</span><span class="o">).</span><span class="n">mkString</span>
<span class="n">scala</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">nsc</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="nc">File</span><span class="o">(</span><span class="s">"uni.dml"</span><span class="o">).</span><span class="n">writeAll</span><span class="o">(</span><span class="n">uniString</span><span class="o">)</span>
<span class="k">val</span> <span class="n">s4</span> <span class="k">=</span> <span class="nc">ScriptFactory</span><span class="o">.</span><span class="n">dmlFromFile</span><span class="o">(</span><span class="s">"uni.dml"</span><span class="o">)</span></code></pre></div>

<p><strong>Script from InputStream:</strong></p>

<p>The SystemML jar file contains all the primary algorithm scripts. We can read one of these scripts as an InputStream
and use this to create a Script object.</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">inputStream</span> <span class="k">=</span> <span class="n">getClass</span><span class="o">.</span><span class="n">getResourceAsStream</span><span class="o">(</span><span class="s">"/scripts/algorithms/Univar-Stats.dml"</span><span class="o">)</span>
<span class="k">val</span> <span class="n">s5</span> <span class="k">=</span> <span class="nc">ScriptFactory</span><span class="o">.</span><span class="n">dmlFromInputStream</span><span class="o">(</span><span class="n">inputStream</span><span class="o">)</span></code></pre></div>

<p><strong>Script from Resource:</strong></p>

<p>As mentioned, the SystemML jar file contains all the primary algorithm script files. For convenience, we can
read these script files or other script files on the classpath using ScriptFactory&#8217;s <code>dmlFromResource</code> and <code>pydmlFromResource</code>
methods.</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">s6</span> <span class="k">=</span> <span class="nc">ScriptFactory</span><span class="o">.</span><span class="n">dmlFromResource</span><span class="o">(</span><span class="s">"/scripts/algorithms/Univar-Stats.dml"</span><span class="o">);</span></code></pre></div>

<h2 id="scriptexecutor">ScriptExecutor</h2>

<p>A Script is executed by a ScriptExecutor. If no ScriptExecutor is specified, a default ScriptExecutor will
be created to execute a Script. Script execution consists of several steps, as detailed in
<a href="http://sites.computer.org/debull/A14sept/p52.pdf">SystemML&#8217;s Optimizer: Plan Generation for Large-Scale Machine Learning Programs</a>.
Additional information can be found in the Javadocs for ScriptExecutor.</p>

<p>Advanced users may find it useful to be able to specify their own execution or to override ScriptExecutor methods by
subclassing ScriptExecutor.</p>

<p>In this example, we override the <code>parseScript</code> and <code>validateScript</code> methods to display messages to the console
during these execution steps.</p>

<div class="codetabs">

<div data-lang="Scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">class</span> <span class="nc">MyScriptExecutor</span> <span class="k">extends</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">sysml</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">mlcontext</span><span class="o">.</span><span class="nc">ScriptExecutor</span> <span class="o">{</span>
  <span class="k">override</span> <span class="k">def</span> <span class="n">parseScript</span><span class="o">{</span> <span class="n">println</span><span class="o">(</span><span class="s">"Parsing script"</span><span class="o">);</span> <span class="k">super</span><span class="o">.</span><span class="n">parseScript</span><span class="o">();</span> <span class="o">}</span>
  <span class="k">override</span> <span class="k">def</span> <span class="n">validateScript</span><span class="o">{</span> <span class="n">println</span><span class="o">(</span><span class="s">"Validating script"</span><span class="o">);</span> <span class="k">super</span><span class="o">.</span><span class="n">validateScript</span><span class="o">();</span> <span class="o">}</span>
<span class="o">}</span>
<span class="k">val</span> <span class="n">helloScript</span> <span class="k">=</span> <span class="n">dml</span><span class="o">(</span><span class="s">"print('hello world')"</span><span class="o">)</span>
<span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">helloScript</span><span class="o">,</span> <span class="k">new</span> <span class="nc">MyScriptExecutor</span><span class="o">)</span></code></pre></div>

  </div>

<div data-lang="Spark Shell">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">class</span> <span class="nc">MyScriptExecutor</span> <span class="k">extends</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">sysml</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">mlcontext</span><span class="o">.</span><span class="nc">ScriptExecutor</span> <span class="o">{</span>
     <span class="o">|</span>   <span class="k">override</span> <span class="k">def</span> <span class="n">parseScript</span><span class="o">{</span> <span class="n">println</span><span class="o">(</span><span class="s">"Parsing script"</span><span class="o">);</span> <span class="k">super</span><span class="o">.</span><span class="n">parseScript</span><span class="o">();</span> <span class="o">}</span>
     <span class="o">|</span>   <span class="k">override</span> <span class="k">def</span> <span class="n">validateScript</span><span class="o">{</span> <span class="n">println</span><span class="o">(</span><span class="s">"Validating script"</span><span class="o">);</span> <span class="k">super</span><span class="o">.</span><span class="n">validateScript</span><span class="o">();</span> <span class="o">}</span>
     <span class="o">|</span> <span class="o">}</span>
<span class="n">defined</span> <span class="k">class</span> <span class="nc">MyScriptExecutor</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">helloScript</span> <span class="k">=</span> <span class="n">dml</span><span class="o">(</span><span class="s">"print('hello world')"</span><span class="o">)</span>
<span class="n">helloScript</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.Script</span> <span class="o">=</span>
<span class="nc">Inputs</span><span class="k">:</span>
<span class="kt">None</span>

<span class="nc">Outputs</span><span class="k">:</span>
<span class="kt">None</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">helloScript</span><span class="o">,</span> <span class="k">new</span> <span class="nc">MyScriptExecutor</span><span class="o">)</span>
<span class="nc">Parsing</span> <span class="n">script</span>
<span class="nc">Validating</span> <span class="n">script</span>
<span class="n">hello</span> <span class="n">world</span>
<span class="n">res63</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.MLResults</span> <span class="o">=</span>
<span class="nc">None</span></code></pre></div>

  </div>

</div>

<h2 id="matrixmetadata">MatrixMetadata</h2>

<p>When supplying matrix data to Apache SystemML using the MLContext API, matrix metadata can be
supplied using a <code>MatrixMetadata</code> object. Supplying characteristics about a matrix can significantly
improve performance. For some types of input matrices, supplying metadata is mandatory.
Metadata at a minimum typically consists of the number of rows and columns in
a matrix. The number of non-zeros can also be supplied.</p>

<p>Additionally, the number of rows and columns per block can be supplied, although in typical usage
it&#8217;s probably fine to use the default values used by SystemML (1,000 rows and 1,000 columns per block).
SystemML handles a matrix internally by splitting the matrix into chunks, or <em>blocks</em>.
The number of rows and columns per block refers to the size of these matrix blocks.</p>

<p><strong>CSV RDD with No Metadata:</strong></p>

<p>Here we see an example of inputting an RDD of Strings in CSV format with no metadata. Note that in general
it is recommended that metadata is supplied. We output the sum and mean of the cells in the matrix.</p>

<div class="codetabs">

<div data-lang="Scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">rddCSV</span> <span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="o">(</span><span class="nc">Array</span><span class="o">(</span><span class="s">"1.0,2.0"</span><span class="o">,</span> <span class="s">"3.0,4.0"</span><span class="o">))</span>
<span class="k">val</span> <span class="n">sumAndMean</span> <span class="k">=</span> <span class="n">dml</span><span class="o">(</span><span class="s">"sum = sum(m); mean = mean(m)"</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"m"</span><span class="o">,</span> <span class="n">rddCSV</span><span class="o">).</span><span class="n">out</span><span class="o">(</span><span class="s">"sum"</span><span class="o">,</span> <span class="s">"mean"</span><span class="o">)</span>
<span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">sumAndMean</span><span class="o">)</span></code></pre></div>

  </div>

<div data-lang="Spark Shell">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">rddCSV</span> <span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="o">(</span><span class="nc">Array</span><span class="o">(</span><span class="s">"1.0,2.0"</span><span class="o">,</span> <span class="s">"3.0,4.0"</span><span class="o">))</span>
<span class="n">rddCSV</span><span class="k">:</span> <span class="kt">org.apache.spark.rdd.RDD</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">ParallelCollectionRDD</span><span class="o">[</span><span class="err">190</span><span class="o">]</span> <span class="n">at</span> <span class="n">parallelize</span> <span class="n">at</span> <span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">38</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">sumAndMean</span> <span class="k">=</span> <span class="n">dml</span><span class="o">(</span><span class="s">"sum = sum(m); mean = mean(m)"</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"m"</span><span class="o">,</span> <span class="n">rddCSV</span><span class="o">).</span><span class="n">out</span><span class="o">(</span><span class="s">"sum"</span><span class="o">,</span> <span class="s">"mean"</span><span class="o">)</span>
<span class="n">sumAndMean</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.Script</span> <span class="o">=</span>
<span class="nc">Inputs</span><span class="k">:</span>
  <span class="err">[1]</span> <span class="o">(</span><span class="kt">RDD</span><span class="o">)</span> <span class="kt">m:</span> <span class="kt">ParallelCollectionRDD</span><span class="o">[</span><span class="err">190</span><span class="o">]</span> <span class="n">at</span> <span class="n">parallelize</span> <span class="n">at</span> <span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">38</span>

<span class="nc">Outputs</span><span class="k">:</span>
  <span class="err">[1]</span> <span class="kt">sum</span>
  <span class="o">[</span><span class="err">2</span><span class="o">]</span> <span class="n">mean</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">sumAndMean</span><span class="o">)</span>
<span class="n">res20</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.MLResults</span> <span class="o">=</span>
  <span class="o">[</span><span class="err">1</span><span class="o">]</span> <span class="o">(</span><span class="nc">Double</span><span class="o">)</span> <span class="n">sum</span><span class="k">:</span> <span class="err">10</span><span class="kt">.</span><span class="err">0</span>
  <span class="err">[2]</span> <span class="o">(</span><span class="kt">Double</span><span class="o">)</span> <span class="kt">mean:</span> <span class="err">2</span><span class="kt">.</span><span class="err">5</span></code></pre></div>

  </div>

</div>

<p><strong>IJV RDD with Metadata:</strong></p>

<p>Next, we&#8217;ll supply an RDD in IJV format. IJV is a sparse format where each line has three space-separated values.
The first value indicates the row number, the second value indicates the column number, and the
third value indicates the cell value. Since the total numbers of rows and columns can&#8217;t be determined
from these IJV rows, we need to supply metadata describing the matrix size.</p>

<p>Here, we specify that our matrix has 3 rows and 3 columns.</p>

<div class="codetabs">

<div data-lang="Scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">rddIJV</span> <span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="o">(</span><span class="nc">Array</span><span class="o">(</span><span class="s">"1 1 1"</span><span class="o">,</span> <span class="s">"2 1 2"</span><span class="o">,</span> <span class="s">"1 2 3"</span><span class="o">,</span> <span class="s">"3 3 4"</span><span class="o">))</span>
<span class="k">val</span> <span class="n">mm3x3</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MatrixMetadata</span><span class="o">(</span><span class="nc">MatrixFormat</span><span class="o">.</span><span class="nc">IJV</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">3</span><span class="o">)</span>
<span class="k">val</span> <span class="n">sumAndMean</span> <span class="k">=</span> <span class="n">dml</span><span class="o">(</span><span class="s">"sum = sum(m); mean = mean(m)"</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"m"</span><span class="o">,</span> <span class="n">rddIJV</span><span class="o">,</span> <span class="n">mm3x3</span><span class="o">).</span><span class="n">out</span><span class="o">(</span><span class="s">"sum"</span><span class="o">,</span> <span class="s">"mean"</span><span class="o">)</span>
<span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">sumAndMean</span><span class="o">)</span></code></pre></div>

  </div>

<div data-lang="Spark Shell">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">rddIJV</span> <span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="o">(</span><span class="nc">Array</span><span class="o">(</span><span class="s">"1 1 1"</span><span class="o">,</span> <span class="s">"2 1 2"</span><span class="o">,</span> <span class="s">"1 2 3"</span><span class="o">,</span> <span class="s">"3 3 4"</span><span class="o">))</span>
<span class="n">rddIJV</span><span class="k">:</span> <span class="kt">org.apache.spark.rdd.RDD</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">ParallelCollectionRDD</span><span class="o">[</span><span class="err">202</span><span class="o">]</span> <span class="n">at</span> <span class="n">parallelize</span> <span class="n">at</span> <span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">38</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">mm3x3</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MatrixMetadata</span><span class="o">(</span><span class="nc">MatrixFormat</span><span class="o">.</span><span class="nc">IJV</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">3</span><span class="o">)</span>
<span class="n">mm3x3</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.MatrixMetadata</span> <span class="o">=</span> <span class="n">rows</span><span class="k">:</span> <span class="err">3</span><span class="o">,</span> <span class="n">columns</span><span class="k">:</span> <span class="err">3</span><span class="o">,</span> <span class="n">non</span><span class="o">-</span><span class="n">zeros</span><span class="k">:</span> <span class="kt">None</span><span class="o">,</span> <span class="n">rows</span> <span class="n">per</span> <span class="n">block</span><span class="k">:</span> <span class="kt">None</span><span class="o">,</span> <span class="n">columns</span> <span class="n">per</span> <span class="n">block</span><span class="k">:</span> <span class="kt">None</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">sumAndMean</span> <span class="k">=</span> <span class="n">dml</span><span class="o">(</span><span class="s">"sum = sum(m); mean = mean(m)"</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"m"</span><span class="o">,</span> <span class="n">rddIJV</span><span class="o">,</span> <span class="n">mm3x3</span><span class="o">).</span><span class="n">out</span><span class="o">(</span><span class="s">"sum"</span><span class="o">,</span> <span class="s">"mean"</span><span class="o">)</span>
<span class="n">sumAndMean</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.Script</span> <span class="o">=</span>
<span class="nc">Inputs</span><span class="k">:</span>
  <span class="err">[1]</span> <span class="o">(</span><span class="kt">RDD</span><span class="o">)</span> <span class="kt">m:</span> <span class="kt">ParallelCollectionRDD</span><span class="o">[</span><span class="err">202</span><span class="o">]</span> <span class="n">at</span> <span class="n">parallelize</span> <span class="n">at</span> <span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">38</span>

<span class="nc">Outputs</span><span class="k">:</span>
  <span class="err">[1]</span> <span class="kt">sum</span>
  <span class="o">[</span><span class="err">2</span><span class="o">]</span> <span class="n">mean</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">sumAndMean</span><span class="o">)</span>
<span class="n">res21</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.MLResults</span> <span class="o">=</span>
  <span class="o">[</span><span class="err">1</span><span class="o">]</span> <span class="o">(</span><span class="nc">Double</span><span class="o">)</span> <span class="n">sum</span><span class="k">:</span> <span class="err">10</span><span class="kt">.</span><span class="err">0</span>
  <span class="err">[2]</span> <span class="o">(</span><span class="kt">Double</span><span class="o">)</span> <span class="kt">mean:</span> <span class="err">1</span><span class="kt">.</span><span class="err">1111111111111112</span></code></pre></div>

  </div>

</div>

<p>Next, we&#8217;ll run the same DML, but this time we&#8217;ll specify that the input matrix is 4x4 instead of 3x3.</p>

<div class="codetabs">

<div data-lang="Scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">rddIJV</span> <span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="o">(</span><span class="nc">Array</span><span class="o">(</span><span class="s">"1 1 1"</span><span class="o">,</span> <span class="s">"2 1 2"</span><span class="o">,</span> <span class="s">"1 2 3"</span><span class="o">,</span> <span class="s">"3 3 4"</span><span class="o">))</span>
<span class="k">val</span> <span class="n">mm4x4</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MatrixMetadata</span><span class="o">(</span><span class="nc">MatrixFormat</span><span class="o">.</span><span class="nc">IJV</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">4</span><span class="o">)</span>
<span class="k">val</span> <span class="n">sumAndMean</span> <span class="k">=</span> <span class="n">dml</span><span class="o">(</span><span class="s">"sum = sum(m); mean = mean(m)"</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"m"</span><span class="o">,</span> <span class="n">rddIJV</span><span class="o">,</span> <span class="n">mm4x4</span><span class="o">).</span><span class="n">out</span><span class="o">(</span><span class="s">"sum"</span><span class="o">,</span> <span class="s">"mean"</span><span class="o">)</span>
<span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">sumAndMean</span><span class="o">)</span></code></pre></div>

  </div>

<div data-lang="Spark Shell">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">rddIJV</span> <span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="o">(</span><span class="nc">Array</span><span class="o">(</span><span class="s">"1 1 1"</span><span class="o">,</span> <span class="s">"2 1 2"</span><span class="o">,</span> <span class="s">"1 2 3"</span><span class="o">,</span> <span class="s">"3 3 4"</span><span class="o">))</span>
<span class="n">rddIJV</span><span class="k">:</span> <span class="kt">org.apache.spark.rdd.RDD</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">ParallelCollectionRDD</span><span class="o">[</span><span class="err">210</span><span class="o">]</span> <span class="n">at</span> <span class="n">parallelize</span> <span class="n">at</span> <span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">38</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">mm4x4</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MatrixMetadata</span><span class="o">(</span><span class="nc">MatrixFormat</span><span class="o">.</span><span class="nc">IJV</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">4</span><span class="o">)</span>
<span class="n">mm4x4</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.MatrixMetadata</span> <span class="o">=</span> <span class="n">rows</span><span class="k">:</span> <span class="err">4</span><span class="o">,</span> <span class="n">columns</span><span class="k">:</span> <span class="err">4</span><span class="o">,</span> <span class="n">non</span><span class="o">-</span><span class="n">zeros</span><span class="k">:</span> <span class="kt">None</span><span class="o">,</span> <span class="n">rows</span> <span class="n">per</span> <span class="n">block</span><span class="k">:</span> <span class="kt">None</span><span class="o">,</span> <span class="n">columns</span> <span class="n">per</span> <span class="n">block</span><span class="k">:</span> <span class="kt">None</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">sumAndMean</span> <span class="k">=</span> <span class="n">dml</span><span class="o">(</span><span class="s">"sum = sum(m); mean = mean(m)"</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"m"</span><span class="o">,</span> <span class="n">rddIJV</span><span class="o">,</span> <span class="n">mm4x4</span><span class="o">).</span><span class="n">out</span><span class="o">(</span><span class="s">"sum"</span><span class="o">,</span> <span class="s">"mean"</span><span class="o">)</span>
<span class="n">sumAndMean</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.Script</span> <span class="o">=</span>
<span class="nc">Inputs</span><span class="k">:</span>
  <span class="err">[1]</span> <span class="o">(</span><span class="kt">RDD</span><span class="o">)</span> <span class="kt">m:</span> <span class="kt">ParallelCollectionRDD</span><span class="o">[</span><span class="err">210</span><span class="o">]</span> <span class="n">at</span> <span class="n">parallelize</span> <span class="n">at</span> <span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">38</span>

<span class="nc">Outputs</span><span class="k">:</span>
  <span class="err">[1]</span> <span class="kt">sum</span>
  <span class="o">[</span><span class="err">2</span><span class="o">]</span> <span class="n">mean</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">sumAndMean</span><span class="o">)</span>
<span class="n">res22</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.MLResults</span> <span class="o">=</span>
  <span class="o">[</span><span class="err">1</span><span class="o">]</span> <span class="o">(</span><span class="nc">Double</span><span class="o">)</span> <span class="n">sum</span><span class="k">:</span> <span class="err">10</span><span class="kt">.</span><span class="err">0</span>
  <span class="err">[2]</span> <span class="o">(</span><span class="kt">Double</span><span class="o">)</span> <span class="kt">mean:</span> <span class="err">0</span><span class="kt">.</span><span class="err">625</span></code></pre></div>

  </div>

</div>

<h2 id="matrix-data-conversions-and-performance">Matrix Data Conversions and Performance</h2>

<p>Internally, Apache SystemML uses a binary-block matrix representation, where a matrix is
represented as a grouping of blocks. Each block is equal in size to the other blocks in the matrix and
consists of a number of rows and columns. The default block size is 1,000 rows by 1,000
columns.</p>

<p>Conversion of a large set of data to a SystemML matrix representation can potentially be time-consuming.
Therefore, if you use a set of data multiple times, one way to potentially improve performance is
to convert it to a SystemML matrix representation and then use this representation rather than performing
the data conversion each time.</p>

<p>If you have an input DataFrame, it can be converted to a Matrix, and this Matrix
can be passed as an input rather than passing in the DataFrame as an input.</p>

<p>For example, suppose we had a 10000x100 matrix represented as a DataFrame, as we saw in an earlier example.
Now suppose we create two Script objects with the DataFrame as an input, as shown below. In the Spark Shell,
when executing this code, you can see that each of the two Script object creations requires the
time-consuming data conversion step.</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">import</span> <span class="nn">org.apache.spark.sql._</span>
<span class="k">import</span> <span class="nn">org.apache.spark.sql.types.</span><span class="o">{</span><span class="nc">StructType</span><span class="o">,</span><span class="nc">StructField</span><span class="o">,</span><span class="nc">DoubleType</span><span class="o">}</span>
<span class="k">import</span> <span class="nn">scala.util.Random</span>
<span class="k">val</span> <span class="n">numRows</span> <span class="k">=</span> <span class="mi">10000</span>
<span class="k">val</span> <span class="n">numCols</span> <span class="k">=</span> <span class="mi">100</span>
<span class="k">val</span> <span class="n">data</span> <span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="o">(</span><span class="mi">0</span> <span class="n">to</span> <span class="n">numRows</span><span class="o">-</span><span class="mi">1</span><span class="o">).</span><span class="n">map</span> <span class="o">{</span> <span class="k">_</span> <span class="k">=&gt;</span> <span class="nc">Row</span><span class="o">.</span><span class="n">fromSeq</span><span class="o">(</span><span class="nc">Seq</span><span class="o">.</span><span class="n">fill</span><span class="o">(</span><span class="n">numCols</span><span class="o">)(</span><span class="nc">Random</span><span class="o">.</span><span class="n">nextDouble</span><span class="o">))</span> <span class="o">}</span>
<span class="k">val</span> <span class="n">schema</span> <span class="k">=</span> <span class="nc">StructType</span><span class="o">((</span><span class="mi">0</span> <span class="n">to</span> <span class="n">numCols</span><span class="o">-</span><span class="mi">1</span><span class="o">).</span><span class="n">map</span> <span class="o">{</span> <span class="n">i</span> <span class="k">=&gt;</span> <span class="nc">StructField</span><span class="o">(</span><span class="s">"C"</span> <span class="o">+</span> <span class="n">i</span><span class="o">,</span> <span class="nc">DoubleType</span><span class="o">,</span> <span class="kc">true</span><span class="o">)</span> <span class="o">}</span> <span class="o">)</span>
<span class="k">val</span> <span class="n">df</span> <span class="k">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="o">(</span><span class="n">data</span><span class="o">,</span> <span class="n">schema</span><span class="o">)</span>
<span class="k">val</span> <span class="n">mm</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MatrixMetadata</span><span class="o">(</span><span class="n">numRows</span><span class="o">,</span> <span class="n">numCols</span><span class="o">)</span>
<span class="k">val</span> <span class="n">minMaxMeanScript</span> <span class="k">=</span> <span class="n">dml</span><span class="o">(</span><span class="n">minMaxMean</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"Xin"</span><span class="o">,</span> <span class="n">df</span><span class="o">,</span> <span class="n">mm</span><span class="o">).</span><span class="n">out</span><span class="o">(</span><span class="s">"minOut"</span><span class="o">,</span> <span class="s">"maxOut"</span><span class="o">,</span> <span class="s">"meanOut"</span><span class="o">)</span>
<span class="k">val</span> <span class="n">minMaxMeanScript</span> <span class="k">=</span> <span class="n">dml</span><span class="o">(</span><span class="n">minMaxMean</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"Xin"</span><span class="o">,</span> <span class="n">df</span><span class="o">,</span> <span class="n">mm</span><span class="o">).</span><span class="n">out</span><span class="o">(</span><span class="s">"minOut"</span><span class="o">,</span> <span class="s">"maxOut"</span><span class="o">,</span> <span class="s">"meanOut"</span><span class="o">)</span></code></pre></div>

<p>Rather than passing in a DataFrame each time to the Script object creation, let&#8217;s instead create a
Matrix object based on the DataFrame and pass this Matrix to the Script object
creation. If we run the code below in the Spark Shell, we see that the data conversion step occurs
when the Matrix object is created. However, when we create a Script object twice, we see
that no conversion penalty occurs, since this conversion occurred when the Matrix was
created.</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">import</span> <span class="nn">org.apache.spark.sql._</span>
<span class="k">import</span> <span class="nn">org.apache.spark.sql.types.</span><span class="o">{</span><span class="nc">StructType</span><span class="o">,</span><span class="nc">StructField</span><span class="o">,</span><span class="nc">DoubleType</span><span class="o">}</span>
<span class="k">import</span> <span class="nn">scala.util.Random</span>
<span class="k">val</span> <span class="n">numRows</span> <span class="k">=</span> <span class="mi">10000</span>
<span class="k">val</span> <span class="n">numCols</span> <span class="k">=</span> <span class="mi">100</span>
<span class="k">val</span> <span class="n">data</span> <span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="o">(</span><span class="mi">0</span> <span class="n">to</span> <span class="n">numRows</span><span class="o">-</span><span class="mi">1</span><span class="o">).</span><span class="n">map</span> <span class="o">{</span> <span class="k">_</span> <span class="k">=&gt;</span> <span class="nc">Row</span><span class="o">.</span><span class="n">fromSeq</span><span class="o">(</span><span class="nc">Seq</span><span class="o">.</span><span class="n">fill</span><span class="o">(</span><span class="n">numCols</span><span class="o">)(</span><span class="nc">Random</span><span class="o">.</span><span class="n">nextDouble</span><span class="o">))</span> <span class="o">}</span>
<span class="k">val</span> <span class="n">schema</span> <span class="k">=</span> <span class="nc">StructType</span><span class="o">((</span><span class="mi">0</span> <span class="n">to</span> <span class="n">numCols</span><span class="o">-</span><span class="mi">1</span><span class="o">).</span><span class="n">map</span> <span class="o">{</span> <span class="n">i</span> <span class="k">=&gt;</span> <span class="nc">StructField</span><span class="o">(</span><span class="s">"C"</span> <span class="o">+</span> <span class="n">i</span><span class="o">,</span> <span class="nc">DoubleType</span><span class="o">,</span> <span class="kc">true</span><span class="o">)</span> <span class="o">}</span> <span class="o">)</span>
<span class="k">val</span> <span class="n">df</span> <span class="k">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="o">(</span><span class="n">data</span><span class="o">,</span> <span class="n">schema</span><span class="o">)</span>
<span class="k">val</span> <span class="n">mm</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MatrixMetadata</span><span class="o">(</span><span class="n">numRows</span><span class="o">,</span> <span class="n">numCols</span><span class="o">)</span>
<span class="k">val</span> <span class="n">matrix</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Matrix</span><span class="o">(</span><span class="n">df</span><span class="o">,</span> <span class="n">mm</span><span class="o">)</span>
<span class="k">val</span> <span class="n">minMaxMeanScript</span> <span class="k">=</span> <span class="n">dml</span><span class="o">(</span><span class="n">minMaxMean</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"Xin"</span><span class="o">,</span> <span class="n">matrix</span><span class="o">).</span><span class="n">out</span><span class="o">(</span><span class="s">"minOut"</span><span class="o">,</span> <span class="s">"maxOut"</span><span class="o">,</span> <span class="s">"meanOut"</span><span class="o">)</span>
<span class="k">val</span> <span class="n">minMaxMeanScript</span> <span class="k">=</span> <span class="n">dml</span><span class="o">(</span><span class="n">minMaxMean</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"Xin"</span><span class="o">,</span> <span class="n">matrix</span><span class="o">).</span><span class="n">out</span><span class="o">(</span><span class="s">"minOut"</span><span class="o">,</span> <span class="s">"maxOut"</span><span class="o">,</span> <span class="s">"meanOut"</span><span class="o">)</span></code></pre></div>

<p>When a matrix is returned as an output, it is returned as a Matrix object, which is a wrapper around
a SystemML MatrixObject. As a result, an output Matrix is already in a SystemML representation,
meaning that it can be passed as an input with no data conversion penalty.</p>

<p>As an example, here we read in matrix <code>x</code> as an RDD in CSV format. We create a Script that adds one to all
values in the matrix. We obtain the resulting matrix <code>y</code> as a Matrix. We execute the
script five times, feeding the output matrix as the input matrix for the next script execution.</p>

<div class="codetabs">

<div data-lang="Scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">rddCSV</span> <span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="o">(</span><span class="nc">Array</span><span class="o">(</span><span class="s">"1.0,2.0"</span><span class="o">,</span> <span class="s">"3.0,4.0"</span><span class="o">))</span>
<span class="k">val</span> <span class="n">add</span> <span class="k">=</span> <span class="n">dml</span><span class="o">(</span><span class="s">"y = x + 1"</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"x"</span><span class="o">,</span> <span class="n">rddCSV</span><span class="o">).</span><span class="n">out</span><span class="o">(</span><span class="s">"y"</span><span class="o">)</span>
<span class="k">for</span> <span class="o">(</span><span class="n">i</span> <span class="k">&lt;-</span> <span class="mi">1</span> <span class="n">to</span> <span class="mi">5</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">println</span><span class="o">(</span><span class="s">"#"</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="s">":"</span><span class="o">);</span>
  <span class="k">val</span> <span class="n">m</span> <span class="k">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">add</span><span class="o">).</span><span class="n">getMatrix</span><span class="o">(</span><span class="s">"y"</span><span class="o">)</span>
  <span class="n">m</span><span class="o">.</span><span class="n">toRDDStringCSV</span><span class="o">.</span><span class="n">collect</span><span class="o">.</span><span class="n">foreach</span><span class="o">(</span><span class="n">println</span><span class="o">)</span>
  <span class="n">add</span><span class="o">.</span><span class="n">in</span><span class="o">(</span><span class="s">"x"</span><span class="o">,</span> <span class="n">m</span><span class="o">)</span>
<span class="o">}</span></code></pre></div>

  </div>

<div data-lang="Spark Shell">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">rddCSV</span> <span class="k">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="o">(</span><span class="nc">Array</span><span class="o">(</span><span class="s">"1.0,2.0"</span><span class="o">,</span> <span class="s">"3.0,4.0"</span><span class="o">))</span>
<span class="n">rddCSV</span><span class="k">:</span> <span class="kt">org.apache.spark.rdd.RDD</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">ParallelCollectionRDD</span><span class="o">[</span><span class="err">341</span><span class="o">]</span> <span class="n">at</span> <span class="n">parallelize</span> <span class="n">at</span> <span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">53</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">add</span> <span class="k">=</span> <span class="n">dml</span><span class="o">(</span><span class="s">"y = x + 1"</span><span class="o">).</span><span class="n">in</span><span class="o">(</span><span class="s">"x"</span><span class="o">,</span> <span class="n">rddCSV</span><span class="o">).</span><span class="n">out</span><span class="o">(</span><span class="s">"y"</span><span class="o">)</span>
<span class="n">add</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.mlcontext.Script</span> <span class="o">=</span>
<span class="nc">Inputs</span><span class="k">:</span>
  <span class="err">[1]</span> <span class="o">(</span><span class="kt">RDD</span><span class="o">)</span> <span class="kt">x:</span> <span class="kt">ParallelCollectionRDD</span><span class="o">[</span><span class="err">341</span><span class="o">]</span> <span class="n">at</span> <span class="n">parallelize</span> <span class="n">at</span> <span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">53</span>

<span class="nc">Outputs</span><span class="k">:</span>
  <span class="err">[1]</span> <span class="kt">y</span>


<span class="n">scala</span><span class="o">&gt;</span> <span class="k">for</span> <span class="o">(</span><span class="n">i</span> <span class="k">&lt;-</span> <span class="mi">1</span> <span class="n">to</span> <span class="mi">5</span><span class="o">)</span> <span class="o">{</span>
     <span class="o">|</span>   <span class="n">println</span><span class="o">(</span><span class="s">"#"</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="s">":"</span><span class="o">);</span>
     <span class="o">|</span>   <span class="k">val</span> <span class="n">m</span> <span class="k">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="o">(</span><span class="n">add</span><span class="o">).</span><span class="n">getMatrix</span><span class="o">(</span><span class="s">"y"</span><span class="o">)</span>
     <span class="o">|</span>   <span class="n">m</span><span class="o">.</span><span class="n">toRDDStringCSV</span><span class="o">.</span><span class="n">collect</span><span class="o">.</span><span class="n">foreach</span><span class="o">(</span><span class="n">println</span><span class="o">)</span>
     <span class="o">|</span>   <span class="n">add</span><span class="o">.</span><span class="n">in</span><span class="o">(</span><span class="s">"x"</span><span class="o">,</span> <span class="n">m</span><span class="o">)</span>
     <span class="o">|</span> <span class="o">}</span>
<span class="k">#</span><span class="mi">1</span><span class="k">:</span>
<span class="err">2</span><span class="kt">.</span><span class="err">0</span><span class="o">,</span><span class="mf">3.0</span>
<span class="mf">4.0</span><span class="o">,</span><span class="mf">5.0</span>
<span class="k">#</span><span class="mi">2</span><span class="k">:</span>
<span class="err">3</span><span class="kt">.</span><span class="err">0</span><span class="o">,</span><span class="mf">4.0</span>
<span class="mf">5.0</span><span class="o">,</span><span class="mf">6.0</span>
<span class="k">#</span><span class="mi">3</span><span class="k">:</span>
<span class="err">4</span><span class="kt">.</span><span class="err">0</span><span class="o">,</span><span class="mf">5.0</span>
<span class="mf">6.0</span><span class="o">,</span><span class="mf">7.0</span>
<span class="k">#</span><span class="mi">4</span><span class="k">:</span>
<span class="err">5</span><span class="kt">.</span><span class="err">0</span><span class="o">,</span><span class="mf">6.0</span>
<span class="mf">7.0</span><span class="o">,</span><span class="mf">8.0</span>
<span class="k">#</span><span class="mi">5</span><span class="k">:</span>
<span class="err">6</span><span class="kt">.</span><span class="err">0</span><span class="o">,</span><span class="mf">7.0</span>
<span class="mf">8.0</span><span class="o">,</span><span class="mf">9.0</span></code></pre></div>

  </div>

</div>

<h2 id="project-information">Project Information</h2>

<p>SystemML project information such as version and build time can be obtained through the
MLContext API. The project version can be obtained by <code>ml.version</code>. The build time can
be obtained by <code>ml.buildTime</code>. The contents of the project manifest can be displayed
using <code>ml.info</code>. Individual properties can be obtained using the <code>ml.info.property</code>
method, as shown below.</p>

<div class="codetabs">

<div data-lang="Scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">print</span><span class="o">(</span><span class="n">ml</span><span class="o">.</span><span class="n">version</span><span class="o">)</span>
<span class="n">print</span><span class="o">(</span><span class="n">ml</span><span class="o">.</span><span class="n">buildTime</span><span class="o">)</span>
<span class="n">print</span><span class="o">(</span><span class="n">ml</span><span class="o">.</span><span class="n">info</span><span class="o">)</span>
<span class="n">print</span><span class="o">(</span><span class="n">ml</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">property</span><span class="o">(</span><span class="s">"Main-Class"</span><span class="o">))</span></code></pre></div>

  </div>

<div data-lang="Spark Shell">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scala</span><span class="o">&gt;</span> <span class="n">print</span><span class="o">(</span><span class="n">ml</span><span class="o">.</span><span class="n">version</span><span class="o">)</span>
<span class="mf">1.0</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="nc">SNAPSHOT</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="n">print</span><span class="o">(</span><span class="n">ml</span><span class="o">.</span><span class="n">buildTime</span><span class="o">)</span>
<span class="mi">2017</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">08</span> <span class="mi">17</span><span class="k">:</span><span class="err">51</span><span class="kt">:</span><span class="err">11</span> <span class="kt">UTC</span>
<span class="n">scala</span><span class="o">&gt;</span> <span class="n">print</span><span class="o">(</span><span class="n">ml</span><span class="o">.</span><span class="n">info</span><span class="o">)</span>
<span class="nc">Archiver</span><span class="o">-</span><span class="nc">Version</span><span class="k">:</span> <span class="kt">Plexus</span> <span class="kt">Archiver</span>
<span class="nc">Artifact</span><span class="o">-</span><span class="nc">Id</span><span class="k">:</span> <span class="kt">systemml</span>
<span class="nc">Build</span><span class="o">-</span><span class="nc">Jdk</span><span class="k">:</span> <span class="err">1</span><span class="kt">.</span><span class="err">8</span><span class="kt">.</span><span class="err">0</span><span class="k">_</span><span class="err">60</span>
<span class="kt">Build-Time:</span> <span class="err">2017</span><span class="kt">-</span><span class="err">06</span><span class="kt">-</span><span class="err">08</span> <span class="err">17</span><span class="kt">:</span><span class="err">51</span><span class="kt">:</span><span class="err">11</span> <span class="kt">UTC</span>
<span class="nc">Built</span><span class="o">-</span><span class="nc">By</span><span class="k">:</span> <span class="kt">sparkuser</span>
<span class="nc">Created</span><span class="o">-</span><span class="nc">By</span><span class="k">:</span> <span class="kt">Apache</span> <span class="kt">Maven</span> <span class="err">3</span><span class="kt">.</span><span class="err">3</span><span class="kt">.</span><span class="err">9</span>
<span class="kt">Group-Id:</span> <span class="kt">org.apache.systemml</span>
<span class="nc">Main</span><span class="o">-</span><span class="nc">Class</span><span class="k">:</span> <span class="kt">org.apache.sysml.api.DMLScript</span>
<span class="nc">Manifest</span><span class="o">-</span><span class="nc">Version</span><span class="k">:</span> <span class="err">1</span><span class="kt">.</span><span class="err">0</span>
<span class="kt">Minimum-Recommended-Spark-Version:</span> <span class="err">2</span><span class="kt">.</span><span class="err">1</span><span class="kt">.</span><span class="err">0</span>
<span class="kt">Version:</span> <span class="err">1</span><span class="kt">.</span><span class="err">0</span><span class="kt">.</span><span class="err">0</span><span class="kt">-SNAPSHOT</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">print</span><span class="o">(</span><span class="n">ml</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">property</span><span class="o">(</span><span class="s">"Main-Class"</span><span class="o">))</span>
<span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">sysml</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="nc">DMLScript</span></code></pre></div>

  </div>

<div data-lang="Python">

    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">print</span><span class="p">(</span><span class="n">ml</span><span class="o">.</span><span class="n">version</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">ml</span><span class="o">.</span><span class="n">buildTime</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">ml</span><span class="o">.</span><span class="n">info</span><span class="p">())</span></code></pre></div>

  </div>

<div data-lang="PySpark Shell">

    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">ml</span><span class="o">.</span><span class="n">version</span><span class="p">())</span>
<span class="mf">1.0</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">SNAPSHOT</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">ml</span><span class="o">.</span><span class="n">buildTime</span><span class="p">())</span>
<span class="mi">2017</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">21</span> <span class="mi">12</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">27</span> <span class="n">CDT</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="n">ml</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
<span class="n">Archiver</span><span class="o">-</span><span class="n">Version</span><span class="p">:</span> <span class="n">Plexus</span> <span class="n">Archiver</span>
<span class="n">Artifact</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="n">systemml</span>
<span class="n">Build</span><span class="o">-</span><span class="n">Jdk</span><span class="p">:</span> <span class="mf">1.8</span><span class="o">.</span><span class="mi">0</span><span class="n">_111</span>
<span class="n">Build</span><span class="o">-</span><span class="n">Time</span><span class="p">:</span> <span class="mi">2017</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">21</span> <span class="mi">12</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">27</span> <span class="n">CDT</span>
<span class="n">Built</span><span class="o">-</span><span class="n">By</span><span class="p">:</span> <span class="n">biuser</span>
<span class="n">Created</span><span class="o">-</span><span class="n">By</span><span class="p">:</span> <span class="n">Apache</span> <span class="n">Maven</span> <span class="mf">3.0</span><span class="o">.</span><span class="mi">5</span>
<span class="n">Group</span><span class="o">-</span><span class="n">Id</span><span class="p">:</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">systemml</span>
<span class="n">Main</span><span class="o">-</span><span class="n">Class</span><span class="p">:</span> <span class="n">org</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">sysml</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">DMLScript</span>
<span class="n">Manifest</span><span class="o">-</span><span class="n">Version</span><span class="p">:</span> <span class="mf">1.0</span>
<span class="n">Minimum</span><span class="o">-</span><span class="n">Recommended</span><span class="o">-</span><span class="n">Spark</span><span class="o">-</span><span class="n">Version</span><span class="p">:</span> <span class="mf">2.1</span><span class="o">.</span><span class="mi">0</span>
<span class="n">Version</span><span class="p">:</span> <span class="mf">1.0</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">SNAPSHOT</span>

<span class="o">&gt;&gt;&gt;</span></code></pre></div>

  </div>

</div>

<hr />

<h1 id="jupyter-pyspark-notebook-example---poisson-nonnegative-matrix-factorization">Jupyter (PySpark) Notebook Example - Poisson Nonnegative Matrix Factorization</h1>

<p>Similar to the Scala API, SystemML also provides a Python MLContext API.  Before usage, you&#8217;ll need
<strong><a href="beginners-guide-python#download--setup">to install it first</a></strong>.</p>

<p>Here, we&#8217;ll explore the use of SystemML via PySpark in a <a href="http://jupyter.org/">Jupyter notebook</a>.
This Jupyter notebook example can be nicely viewed in a rendered state
<a href="https://github.com/apache/systemml/blob/master/samples/jupyter-notebooks/SystemML-PySpark-Recommendation-Demo.ipynb">on GitHub</a>,
and can be <a href="https://raw.githubusercontent.com/apache/systemml/master/samples/jupyter-notebooks/SystemML-PySpark-Recommendation-Demo.ipynb">downloaded here</a> to a directory of your choice.</p>

<p>From the directory with the downloaded notebook, start Jupyter with PySpark:</p>

<div class="codetabs">
<div data-lang="Python 2">
    <p><code>bash
PYSPARK_DRIVER_PYTHON=jupyter PYSPARK_DRIVER_PYTHON_OPTS="notebook" pyspark
</code></p>
  </div>
<div data-lang="Python 3">
    <p><code>bash
PYSPARK_PYTHON=python3 PYSPARK_DRIVER_PYTHON=jupyter PYSPARK_DRIVER_PYTHON_OPTS="notebook" pyspark
</code></p>
  </div>
</div>

<p>This will open Jupyter in a browser:</p>

<p><img src="img/spark-mlcontext-programming-guide/jupyter1.png" alt="Jupyter Notebook" title="Jupyter Notebook" /></p>

<p>We can then open up the <code>SystemML-PySpark-Recommendation-Demo</code> notebook.</p>

<h2 id="set-up-the-notebook-and-download-the-data">Set up the notebook and download the data</h2>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="o">%</span><span class="n">load_ext</span> <span class="n">autoreload</span>
<span class="o">%</span><span class="n">autoreload</span> <span class="mi">2</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">systemml</span> <span class="kn">import</span> <span class="n">MLContext</span><span class="p">,</span> <span class="n">dml</span>  <span class="c"># pip install systeml</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">'figure.figsize'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span></code></pre></div>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="o">%%</span><span class="n">sh</span>
<span class="c"># Download dataset</span>
<span class="n">curl</span> <span class="o">-</span><span class="n">O</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">snap</span><span class="o">.</span><span class="n">stanford</span><span class="o">.</span><span class="n">edu</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">amazon0601</span><span class="o">.</span><span class="n">txt</span><span class="o">.</span><span class="n">gz</span>
<span class="n">gunzip</span> <span class="n">amazon0601</span><span class="o">.</span><span class="n">txt</span><span class="o">.</span><span class="n">gz</span></code></pre></div>

<h2 id="use-pyspark-to-load-the-data-in-as-a-spark-dataframe">Use PySpark to load the data in as a Spark DataFrame</h2>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># Load data</span>
<span class="kn">import</span> <span class="nn">pyspark.sql.functions</span> <span class="k">as</span> <span class="n">F</span>
<span class="n">dataPath</span> <span class="o">=</span> <span class="s">"amazon0601.txt"</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">textFile</span><span class="p">(</span><span class="n">dataPath</span><span class="p">)</span>
    <span class="o">.</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">l</span><span class="p">:</span> <span class="ow">not</span> <span class="n">l</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">"#"</span><span class="p">))</span>
    <span class="o">.</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">l</span><span class="p">:</span> <span class="n">l</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="p">))</span>
    <span class="o">.</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">prods</span><span class="p">:</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">prods</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">prods</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mf">1.0</span><span class="p">))</span>
    <span class="o">.</span><span class="n">toDF</span><span class="p">((</span><span class="s">"prod_i"</span><span class="p">,</span> <span class="s">"prod_j"</span><span class="p">,</span> <span class="s">"x_ij"</span><span class="p">))</span>
    <span class="o">.</span><span class="nb">filter</span><span class="p">(</span><span class="s">"prod_i &lt; 500 AND prod_j &lt; 500"</span><span class="p">)</span> <span class="c"># Filter for memory constraints</span>
    <span class="o">.</span><span class="n">cache</span><span class="p">())</span>

<span class="n">max_prod_i</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="nb">max</span><span class="p">(</span><span class="s">"prod_i"</span><span class="p">))</span><span class="o">.</span><span class="n">first</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">max_prod_j</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="nb">max</span><span class="p">(</span><span class="s">"prod_j"</span><span class="p">))</span><span class="o">.</span><span class="n">first</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">numProducts</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_prod_i</span><span class="p">,</span> <span class="n">max_prod_j</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="c"># 0-based indexing</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Total number of products: {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">numProducts</span><span class="p">))</span></code></pre></div>

<h2 id="create-a-systemml-mlcontext-object">Create a SystemML MLContext object</h2>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># Create SystemML MLContext</span>
<span class="n">ml</span> <span class="o">=</span> <span class="n">MLContext</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span></code></pre></div>

<h2 id="define-a-kernel-for-poisson-nonnegative-matrix-factorization-pnmf-in-dml">Define a kernel for Poisson nonnegative matrix factorization (PNMF) in DML</h2>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># Define PNMF kernel in SystemML's DSL using the R-like syntax for PNMF</span>
<span class="n">pnmf</span> <span class="o">=</span> <span class="s">"""
# data &amp; args
X = X+1 # change product IDs to be 1-based, rather than 0-based
V = table(X[,1], X[,2])
size = ifdef($size, -1)
if(size &gt; -1) {
    V = V[1:size,1:size]
}

n = nrow(V)
m = ncol(V)
range = 0.01
W = Rand(rows=n, cols=rank, min=0, max=range, pdf="uniform")
H = Rand(rows=rank, cols=m, min=0, max=range, pdf="uniform")
losses = matrix(0, rows=max_iter, cols=1)

# run PNMF
i=1
while(i &lt;= max_iter) {
  # update params
  H = (H * (t(W) </span><span class="si">%*% </span><span class="s">(V/(W</span><span class="si">%*%</span><span class="s">H))))/t(colSums(W))
  W = (W * ((V/(W</span><span class="si">%*%</span><span class="s">H)) </span><span class="si">%*% </span><span class="s">t(H)))/t(rowSums(H))

  # compute loss
  losses[i,] = -1 * (sum(V*log(W</span><span class="si">%*%</span><span class="s">H)) - as.scalar(colSums(W)</span><span class="si">%*%</span><span class="s">rowSums(H)))
  i = i + 1;
}
"""</span></code></pre></div>

<h2 id="execute-the-algorithm">Execute the algorithm</h2>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># Run the PNMF script on SystemML with Spark</span>
<span class="n">script</span> <span class="o">=</span> <span class="n">dml</span><span class="p">(</span><span class="n">pnmf</span><span class="p">)</span><span class="o">.</span><span class="nb">input</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">rank</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="s">"W"</span><span class="p">,</span> <span class="s">"H"</span><span class="p">,</span> <span class="s">"losses"</span><span class="p">)</span>
<span class="n">W</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">losses</span> <span class="o">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">script</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"W"</span><span class="p">,</span> <span class="s">"H"</span><span class="p">,</span> <span class="s">"losses"</span><span class="p">)</span></code></pre></div>

<h2 id="retrieve-the-losses-during-training-and-plot-them">Retrieve the losses during training and plot them</h2>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># Plot training loss over time</span>
<span class="n">xy</span> <span class="o">=</span> <span class="n">losses</span><span class="o">.</span><span class="n">toDF</span><span class="p">()</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s">"__INDEX"</span><span class="p">)</span><span class="o">.</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">xy</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Iteration'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Loss'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'PNMF Training Loss'</span><span class="p">)</span></code></pre></div>

<p><img src="img/spark-mlcontext-programming-guide/jupyter_loss_graph.png" alt="Jupyter Loss Graph" title="Jupyter Loss Graph" /></p>

<hr />

<h1 id="recommended-spark-configuration-settings">Recommended Spark Configuration Settings</h1>

<p>For best performance, we recommend setting the following configuration value when running SystemML with Spark:
<code>--conf spark.driver.maxResultSize=0</code>.</p>


        </div> <!-- /container -->

        

        <script src="js/vendor/jquery-1.12.0.min.js"></script>
        <script src="js/vendor/bootstrap.min.js"></script>
        <script src="js/vendor/anchor.min.js"></script>
        <script src="js/main.js"></script>
        




        <!-- Analytics -->
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
            ga('create', 'UA-71553733-1', 'auto');
            ga('send', 'pageview');
        </script>



        <!-- MathJax Section -->
        <script type="text/x-mathjax-config">
            MathJax.Hub.Config({
                TeX: { equationNumbers: { autoNumber: "AMS" } }
            });
        </script>
        <script>
            // Note that we load MathJax this way to work with local file (file://), HTTP and HTTPS.
            // We could use "//cdn.mathjax...", but that won't support "file://".
            (function(d, script) {
                script = d.createElement('script');
                script.type = 'text/javascript';
                script.async = true;
                script.onload = function(){
                    MathJax.Hub.Config({
                        tex2jax: {
                            inlineMath: [ ["$", "$"], ["\\\\(","\\\\)"] ],
                            displayMath: [ ["$$","$$"], ["\\[", "\\]"] ],
                            processEscapes: true,
                            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
                        }
                    });
                };
                script.src = ('https:' == document.location.protocol ? 'https://' : 'http://') +
                    'cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
                d.getElementsByTagName('head')[0].appendChild(script);
            }(document));
        </script>
    </body>
</html>
