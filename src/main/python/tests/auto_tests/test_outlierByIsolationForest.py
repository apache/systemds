# -------------------------------------------------------------
#
# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at
#
#   http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.
#
# -------------------------------------------------------------

# Autogenerated By   : src/main/python/generator/generator.py
import unittest, contextlib, io


class TestOUTLIERBYISOLATIONFOREST(unittest.TestCase):
    def test_outlierByIsolationForest(self):
        # Example test case provided in python the code block
        buf = io.StringIO()
        with contextlib.redirect_stdout(buf):
            import numpy as np
            from systemds.context import SystemDSContext
            from systemds.operator.algorithm import outlierByIsolationForest, outlierByIsolationForestApply
            with SystemDSContext() as sds:
                # Create training data: 20 points clustered near origin
                X_train = sds.from_numpy(np.array([
                    [0.0, 0.0], [0.1, 0.1], [0.2, 0.2], [0.3, 0.3], [0.4, 0.4],
                    [0.5, 0.5], [0.6, 0.6], [0.7, 0.7], [0.8, 0.8], [0.9, 0.9],
                    [1.0, 1.0], [1.1, 1.1], [1.2, 1.2], [1.3, 1.3], [1.4, 1.4],
                    [1.5, 1.5], [1.6, 1.6], [1.7, 1.7], [1.8, 1.8], [1.9, 1.9]
                ]))
                model = outlierByIsolationForest(X_train, n_trees=100, subsampling_size=10, seed=42)
                X_test = sds.from_numpy(np.array([[1.0, 1.0], [100.0, 100.0]]))
                scores = outlierByIsolationForestApply(model, X_test).compute()
                print(scores.shape)
                print(scores[1, 0] > scores[0, 0])
                print(scores[1, 0] > 0.5)

            expected = """(2, 1)
True
True"""
        self.assertEqual(buf.getvalue().strip(), expected)


if __name__ == '__main__':
    unittest.main()
