#-------------------------------------------------------------
#
# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at
#
#   http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.
#
#-------------------------------------------------------------

addedX = read($1);
oldX = read($2);
totalX = rbind(oldX, addedX);
oldE = read($3);
addedE = read($4);
totalE = rbind(oldE, addedE);

# call slice finding
[TK, TKC, D, L, meta, Stats, Xout, eOut, foffb, foffe, params] = incSliceLine(addedX=oldX, addedE=oldE, k=$5,
  alpha=0.95, minSup=4, tpEval=$6, selFeat=$7, encodeLat=$8, verbose=$9);

[TK1, TKC1, D1, L1, meta1, Stats1, Xout1, eOut1, foffb2, foffe2, params] = incSliceLine(addedX=addedX, oldX = oldX, oldE = oldE, addedE=addedE, prevLattice = L, metaPrevLattice=meta, prevStats = Stats, prevTK = TK, prevTKC = TKC, k=$5,
  alpha=0.95, minSup=4, tpEval=$6, selFeat=$7, encodeLat=$8, verbose=$9, params=params, prevFoffb = foffb, prevFoffe = foffe);

[TK2, TKC2, D2, L2, meta2, Stats2, Xout2, eOut2, foffb3, foffe3, params] = incSliceLine(addedX=totalX, addedE=totalE, k=$5,
  alpha=0.95, minSup=4, tpEval=$6, selFeat=$7, encodeLat=$8, verbose=$9);



write(TKC1, $10)
write(TKC2, $11)

