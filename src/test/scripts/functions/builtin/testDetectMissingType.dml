source("src/test/scripts/functions/builtin/create_dataset.dml") as gen;

# four different tests
for (t in 1:4) {
    print("=========================================================");
    
    n_rows = 5000;
    test_name = "";
    
    if (t == 1) { 
        test_name = "9 column MIX (Default)";
        gt_test = matrix("0 0 0 1 1 2 2 3 3", rows=9, cols=1); 
    } 
    else if (t == 2) { 
        test_name = "4 Easy column";
        gt_test = matrix("0 1 2 3", rows=4, cols=1); 
    }
    else if (t == 3) { 
        test_name = "10 unbalanced columns (MAR)";
        gt_test = matrix("0 0 2 2 2 2 2 2 2 2", rows=10, cols=1); 
    }
    else { 
        test_name = "small number of rows (N=150)";
        gt_test = matrix("0 1 2 3", rows=4, cols=1);
        n_rows = 150; 
    }

    print("Execute TEST " + t + ": " + test_name);

    # gen dataset
    [data, truth] = gen::get_dataset(n=n_rows, GroundTruth=gt_test);

    # analyze dataset
    results = detectMissingType(data, 0.05, 0.60);

    # check the results
    match_matrix = (results == truth);
    correct_count = sum(match_matrix);
    accuracy = (correct_count / nrow(truth)) * 100;
    
    print("---------------------------------------------------------");
    print("Accuracy: " + toString(accuracy) + "%");
}

print("=========================================================");
print("Test suite completed");