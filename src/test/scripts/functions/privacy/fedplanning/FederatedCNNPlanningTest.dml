# CNN Training with federated input matrices X1, X2 and labels Y
X = rbind($X1, $X2);
Y = read($Y);

# Source CNN training utilities from builtin scripts
source("scripts/nn/examples/mnist_lenet.dml") as mnist_lenet;

# Train CNN model with federated data
model = mnist_lenet::train(X, Y, X, Y, C=1, Hin=28, Win=28, epochs=as.integer($epochs));

# Write trained model
write(model, $model);